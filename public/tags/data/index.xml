<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>data on Justin&#39;s Data Blog</title>
    <link>https://blog.jnapolitano.io/tags/data/</link>
    <description>Justin&#39;s Data Blog (data)</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Sat, 21 May 2022 08:30:32 +0000</lastBuildDate>
    
    <atom:link href="https://blog.jnapolitano.io/tags/data/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Rice Paddy Methane Emissions Estimation: Part 1</title>
      <link>https://blog.jnapolitano.io/posts/rice-paddy-emissions-1/</link>
      <pubDate>Sat, 21 May 2022 08:30:32 +0000</pubDate>
      
      <guid>https://blog.jnapolitano.io/posts/rice-paddy-emissions-1/</guid>
      <description>&lt;h1 id=&#34;methane-emissions-estimation-data-part-1-a-comparison-between-faostat-and-university-of-malaysia-estimates&#34; &gt;Methane Emissions Estimation Data Part 1: A Comparison between FAOSTAT and University of Malaysia Estimates
&lt;span&gt;
    &lt;a href=&#34;#methane-emissions-estimation-data-part-1-a-comparison-between-faostat-and-university-of-malaysia-estimates&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;&lt;p&gt;This post documents the data exploration phase of a project that determines whether global methane emissions produced by rice paddies are undercounted.&lt;/p&gt;
&lt;p&gt;It is fairly code python and pandas heavy.&lt;/p&gt;
&lt;p&gt;The code and data exploration follows the summary below.&lt;/p&gt;
&lt;h2 id=&#34;inspiration-for-this-work&#34; &gt;Inspiration for this work
&lt;span&gt;
    &lt;a href=&#34;#inspiration-for-this-work&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;p&gt;The University of Malaysia in partnership with Climate TRACE release a paper stating that the UN undercounts rice paddy methane emissions by about 16%.  Upon review of their claims, I decided to test the data myself across a 5 year distribution to verify that the claims hold up across multiple distributions.&lt;/p&gt;
&lt;h3 id=&#34;university-of-malaysia-methodological-deficiencies&#34; &gt;University of Malaysia Methodological Deficiencies
&lt;span&gt;
    &lt;a href=&#34;#university-of-malaysia-methodological-deficiencies&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Comparing a 2019 distribution FAOSTAT to a 2020 distribution.&lt;/li&gt;
&lt;li&gt;Rounding to 4 signficant figures.&lt;/li&gt;
&lt;li&gt;Testing only one year of emissions data.&lt;/li&gt;
&lt;li&gt;Did not publish data to hypothesis testing to determine if emission distributions significantly vary annually and between states.&lt;/li&gt;
&lt;li&gt;Relying only on satellite data may undercount hectares in cultivation at higher altitudes.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;faostat-methodological-deficiencies&#34; &gt;FaoStat Methodological Deficiencies
&lt;span&gt;
    &lt;a href=&#34;#faostat-methodological-deficiencies&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Relies upon official government statistics which can be manipulated at any point along the bureaucratic paper chain.&lt;/li&gt;
&lt;li&gt;There is an incentive for certain nations to reduce their counts in order to receive international aid and to meet emissions standards.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;university-of-malaysia-acknowledging-deficiencies-like-all-good-papers-should&#34; &gt;University of Malaysia acknowledging deficiencies (like all good papers should)
&lt;span&gt;
    &lt;a href=&#34;#university-of-malaysia-acknowledging-deficiencies-like-all-good-papers-should&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;p&gt;&amp;ldquo;The difference between harvested rice cultivation area from statistical data and remote-sensing estimates can be due to two factors: (i) MODIS data which have moderate spatial resolution lead to mixed pixels, where rice fields and non-rice fields are combined. This can overestimate area, especially in lowland regions and have a low ability to detect small rice field patches in upland regions (Frolking et al 1999, Seto et al 2000); and (ii) political and policy factors (Yan et al., 2019) such as determination of the amount of subsidies for fertilizers and evaluation of achievement of government programs in the agricultural sector. Other factors that contribute to discrepancy in CH4 emission are from different emission and scale factors that are related to water regime and organic amendment. These values give high uncertainty since the availability of these data are limited and quite variable.&amp;rdquo;&lt;/p&gt;
&lt;h2 id=&#34;my-initial-impressions-and-findings&#34; &gt;My Initial Impressions and findings
&lt;span&gt;
    &lt;a href=&#34;#my-initial-impressions-and-findings&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;h3 id=&#34;initial&#34; &gt;Initial
&lt;span&gt;
    &lt;a href=&#34;#initial&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;p&gt;The percent difference and the tonnage difference do not support each other.  I need to recalculate the totals section to ensure that we are doing things correctly.&lt;/p&gt;
&lt;p&gt;I need to confirm the values, but I&amp;rsquo;m initially impressed by the fact that the FAOSTAT data reports higher values than the Malaysia data on average.  According to the included paper this should not be the case.&lt;/p&gt;
&lt;h3 id=&#34;verified&#34; &gt;Verified
&lt;span&gt;
    &lt;a href=&#34;#verified&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;p&gt;I calculated differences totals and means per DataFrame to ensure accuracy prior to the join.  I also dropped pre-calcuated values when joining to ensure that the aggregation algorithms to not modify the results.&lt;/p&gt;
&lt;p&gt;The data is now consistent and supports the findings of the University of Malaysia Paper.  With that said it is important to note that the differences recorded are far smaller than suggested.&lt;/p&gt;
&lt;h2 id=&#34;import-dependencies&#34; &gt;Import Dependencies
&lt;span&gt;
    &lt;a href=&#34;#import-dependencies&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; pandas &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; pd
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; plt
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; geopandas &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; gpd
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; folium
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; contextily &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; cx
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; shapely.geometry &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; Point, LineString, Polygon
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; numpy &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; np
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; scipy.spatial &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; cKDTree
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; geopy.distance &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; distance
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; scipy.stats &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; stats

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;dependencies&#34; &gt;Dependencies
&lt;span&gt;
    &lt;a href=&#34;#dependencies&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Geopandas&lt;/li&gt;
&lt;li&gt;pandas&lt;/li&gt;
&lt;li&gt;openpyxl&lt;/li&gt;
&lt;li&gt;Shapely&lt;/li&gt;
&lt;li&gt;geopy Distance&lt;/li&gt;
&lt;li&gt;numpy&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;exploration-plan&#34; &gt;Exploration Plan
&lt;span&gt;
    &lt;a href=&#34;#exploration-plan&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;h3 id=&#34;data-imports&#34; &gt;Data Imports
&lt;span&gt;
    &lt;a href=&#34;#data-imports&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;/Users/jnapolitano/Projects/wattime-takehome/data/ch4_2015-2021.xlsx&lt;/li&gt;
&lt;li&gt;/Users/jnapolitano/Projects/wattime-takehome/data/emissions_csv_fao_emiss_csv_ch4_fao_2015_2019_tonnes.xlsx&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;import-data-frames&#34; &gt;Import Data Frames
&lt;span&gt;
    &lt;a href=&#34;#import-data-frames&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;p&gt;Since jupyter caches the data to the notebook json I can import the dataframes that I will be using together.&lt;/p&gt;
&lt;p&gt;If I were to build automated scripts to perform the analysis I would only load the data necessary to perform a process.&lt;/p&gt;
&lt;h3 id=&#34;experiment-with-plots-for-each-set&#34; &gt;Experiment with Plots for each Set
&lt;span&gt;
    &lt;a href=&#34;#experiment-with-plots-for-each-set&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;p&gt;I don&amp;rsquo;t know exactly which plots I want to include in the final report.&lt;/p&gt;
&lt;p&gt;I &amp;rsquo;ll plot a few for each data set&lt;/p&gt;
&lt;h3 id=&#34;calculate-differences-between-the-datasets&#34; &gt;Calculate differences between the datasets
&lt;span&gt;
    &lt;a href=&#34;#calculate-differences-between-the-datasets&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;create a differences data frame&lt;/li&gt;
&lt;li&gt;write to file for use&lt;/li&gt;
&lt;li&gt;plot&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;university-of-malaysia-emission-estimates&#34; &gt;University of Malaysia Emission Estimates
&lt;span&gt;
    &lt;a href=&#34;#university-of-malaysia-emission-estimates&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;filepath &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/Users/jnapolitano/Projects/wattime-takehome/wattime-takehome/data/ch4_2015-2021.xlsx&amp;#34;&lt;/span&gt;

malaysia_emissions_df &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;read_excel(filepath)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;print-df-head&#34; &gt;Print Df Head
&lt;span&gt;
    &lt;a href=&#34;#print-df-head&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;malaysia_emissions_df
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div style=&#34;overflow-x:auto;&#34;&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;iso3_country&lt;/th&gt;
      &lt;th&gt;country_name&lt;/th&gt;
      &lt;th&gt;tCH4_2015&lt;/th&gt;
      &lt;th&gt;tCH4_2016&lt;/th&gt;
      &lt;th&gt;tCH4_2017&lt;/th&gt;
      &lt;th&gt;tCH4_2018&lt;/th&gt;
      &lt;th&gt;tCH4_2019&lt;/th&gt;
      &lt;th&gt;tCH4_2020&lt;/th&gt;
      &lt;th&gt;tCH4_2021&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;BGD&lt;/td&gt;
      &lt;td&gt;Bangladesh&lt;/td&gt;
      &lt;td&gt;2.344420e+06&lt;/td&gt;
      &lt;td&gt;2.278158e+06&lt;/td&gt;
      &lt;td&gt;2.098958e+06&lt;/td&gt;
      &lt;td&gt;2.141231e+06&lt;/td&gt;
      &lt;td&gt;2.070985e+06&lt;/td&gt;
      &lt;td&gt;2.106781e+06&lt;/td&gt;
      &lt;td&gt;1.983974e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;BRA&lt;/td&gt;
      &lt;td&gt;Brazil&lt;/td&gt;
      &lt;td&gt;3.410233e+05&lt;/td&gt;
      &lt;td&gt;3.104189e+05&lt;/td&gt;
      &lt;td&gt;3.725173e+05&lt;/td&gt;
      &lt;td&gt;3.717030e+05&lt;/td&gt;
      &lt;td&gt;3.294713e+05&lt;/td&gt;
      &lt;td&gt;4.902874e+05&lt;/td&gt;
      &lt;td&gt;4.544874e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;CHN&lt;/td&gt;
      &lt;td&gt;China&lt;/td&gt;
      &lt;td&gt;6.133647e+06&lt;/td&gt;
      &lt;td&gt;5.859531e+06&lt;/td&gt;
      &lt;td&gt;6.355071e+06&lt;/td&gt;
      &lt;td&gt;5.413962e+06&lt;/td&gt;
      &lt;td&gt;5.603352e+06&lt;/td&gt;
      &lt;td&gt;6.402353e+06&lt;/td&gt;
      &lt;td&gt;6.068210e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;ESP&lt;/td&gt;
      &lt;td&gt;Spain&lt;/td&gt;
      &lt;td&gt;1.141464e+04&lt;/td&gt;
      &lt;td&gt;1.334803e+04&lt;/td&gt;
      &lt;td&gt;1.217299e+04&lt;/td&gt;
      &lt;td&gt;1.405410e+04&lt;/td&gt;
      &lt;td&gt;1.148324e+04&lt;/td&gt;
      &lt;td&gt;1.305461e+04&lt;/td&gt;
      &lt;td&gt;8.531579e+03&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;IDN&lt;/td&gt;
      &lt;td&gt;Indonesia&lt;/td&gt;
      &lt;td&gt;1.283649e+06&lt;/td&gt;
      &lt;td&gt;1.023129e+06&lt;/td&gt;
      &lt;td&gt;9.615327e+05&lt;/td&gt;
      &lt;td&gt;1.176982e+06&lt;/td&gt;
      &lt;td&gt;1.266668e+06&lt;/td&gt;
      &lt;td&gt;1.188195e+06&lt;/td&gt;
      &lt;td&gt;1.009936e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;IND&lt;/td&gt;
      &lt;td&gt;India&lt;/td&gt;
      &lt;td&gt;6.219887e+06&lt;/td&gt;
      &lt;td&gt;5.309413e+06&lt;/td&gt;
      &lt;td&gt;6.228451e+06&lt;/td&gt;
      &lt;td&gt;6.589798e+06&lt;/td&gt;
      &lt;td&gt;7.501556e+06&lt;/td&gt;
      &lt;td&gt;7.599764e+06&lt;/td&gt;
      &lt;td&gt;6.567960e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;IRN&lt;/td&gt;
      &lt;td&gt;Iran (Islamic Republic of)&lt;/td&gt;
      &lt;td&gt;8.774407e+04&lt;/td&gt;
      &lt;td&gt;9.180121e+04&lt;/td&gt;
      &lt;td&gt;9.620217e+04&lt;/td&gt;
      &lt;td&gt;8.875744e+04&lt;/td&gt;
      &lt;td&gt;9.500199e+04&lt;/td&gt;
      &lt;td&gt;9.600254e+04&lt;/td&gt;
      &lt;td&gt;9.053525e+04&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;ITA&lt;/td&gt;
      &lt;td&gt;Italy&lt;/td&gt;
      &lt;td&gt;4.995968e+04&lt;/td&gt;
      &lt;td&gt;4.937785e+04&lt;/td&gt;
      &lt;td&gt;5.443679e+04&lt;/td&gt;
      &lt;td&gt;4.469902e+04&lt;/td&gt;
      &lt;td&gt;4.566914e+04&lt;/td&gt;
      &lt;td&gt;5.101547e+04&lt;/td&gt;
      &lt;td&gt;5.089759e+04&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;JPN&lt;/td&gt;
      &lt;td&gt;Japan&lt;/td&gt;
      &lt;td&gt;2.305465e+05&lt;/td&gt;
      &lt;td&gt;2.284133e+05&lt;/td&gt;
      &lt;td&gt;2.708935e+05&lt;/td&gt;
      &lt;td&gt;1.548252e+05&lt;/td&gt;
      &lt;td&gt;2.332056e+05&lt;/td&gt;
      &lt;td&gt;2.835167e+05&lt;/td&gt;
      &lt;td&gt;1.574007e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;KHM&lt;/td&gt;
      &lt;td&gt;Cambodia&lt;/td&gt;
      &lt;td&gt;4.954698e+05&lt;/td&gt;
      &lt;td&gt;5.731698e+05&lt;/td&gt;
      &lt;td&gt;4.517045e+05&lt;/td&gt;
      &lt;td&gt;5.592610e+05&lt;/td&gt;
      &lt;td&gt;5.947277e+05&lt;/td&gt;
      &lt;td&gt;6.412802e+05&lt;/td&gt;
      &lt;td&gt;5.644891e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;KOR&lt;/td&gt;
      &lt;td&gt;Korea (the Republic of)&lt;/td&gt;
      &lt;td&gt;1.451878e+05&lt;/td&gt;
      &lt;td&gt;1.274597e+05&lt;/td&gt;
      &lt;td&gt;1.463222e+05&lt;/td&gt;
      &lt;td&gt;1.293543e+05&lt;/td&gt;
      &lt;td&gt;1.327782e+05&lt;/td&gt;
      &lt;td&gt;1.165467e+05&lt;/td&gt;
      &lt;td&gt;1.013006e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;LAO&lt;/td&gt;
      &lt;td&gt;Lao People&#39;s Democratic Republic (the)&lt;/td&gt;
      &lt;td&gt;1.661169e+04&lt;/td&gt;
      &lt;td&gt;1.696441e+04&lt;/td&gt;
      &lt;td&gt;1.168063e+04&lt;/td&gt;
      &lt;td&gt;1.009675e+04&lt;/td&gt;
      &lt;td&gt;1.461058e+04&lt;/td&gt;
      &lt;td&gt;2.136270e+04&lt;/td&gt;
      &lt;td&gt;1.475014e+04&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;LKA&lt;/td&gt;
      &lt;td&gt;Sri Lanka&lt;/td&gt;
      &lt;td&gt;8.305626e+04&lt;/td&gt;
      &lt;td&gt;1.011743e+05&lt;/td&gt;
      &lt;td&gt;5.911841e+04&lt;/td&gt;
      &lt;td&gt;9.018914e+04&lt;/td&gt;
      &lt;td&gt;8.476088e+04&lt;/td&gt;
      &lt;td&gt;9.248238e+04&lt;/td&gt;
      &lt;td&gt;8.466966e+04&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;MMR&lt;/td&gt;
      &lt;td&gt;Myanmar&lt;/td&gt;
      &lt;td&gt;1.132082e+06&lt;/td&gt;
      &lt;td&gt;1.290806e+06&lt;/td&gt;
      &lt;td&gt;1.205169e+06&lt;/td&gt;
      &lt;td&gt;1.372447e+06&lt;/td&gt;
      &lt;td&gt;1.256888e+06&lt;/td&gt;
      &lt;td&gt;1.221904e+06&lt;/td&gt;
      &lt;td&gt;1.289837e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;MYS&lt;/td&gt;
      &lt;td&gt;Malaysia&lt;/td&gt;
      &lt;td&gt;1.057399e+05&lt;/td&gt;
      &lt;td&gt;1.110049e+05&lt;/td&gt;
      &lt;td&gt;1.111291e+05&lt;/td&gt;
      &lt;td&gt;1.066525e+05&lt;/td&gt;
      &lt;td&gt;1.056287e+05&lt;/td&gt;
      &lt;td&gt;1.127141e+05&lt;/td&gt;
      &lt;td&gt;1.069696e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;NPL&lt;/td&gt;
      &lt;td&gt;Nepal&lt;/td&gt;
      &lt;td&gt;1.007479e+05&lt;/td&gt;
      &lt;td&gt;6.667161e+04&lt;/td&gt;
      &lt;td&gt;8.081300e+04&lt;/td&gt;
      &lt;td&gt;9.200752e+04&lt;/td&gt;
      &lt;td&gt;1.164235e+05&lt;/td&gt;
      &lt;td&gt;7.168401e+04&lt;/td&gt;
      &lt;td&gt;4.811408e+04&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;PAK&lt;/td&gt;
      &lt;td&gt;Pakistan&lt;/td&gt;
      &lt;td&gt;4.852431e+05&lt;/td&gt;
      &lt;td&gt;5.945922e+05&lt;/td&gt;
      &lt;td&gt;5.372641e+05&lt;/td&gt;
      &lt;td&gt;4.532297e+05&lt;/td&gt;
      &lt;td&gt;6.528548e+05&lt;/td&gt;
      &lt;td&gt;6.401201e+05&lt;/td&gt;
      &lt;td&gt;4.849205e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;PHL&lt;/td&gt;
      &lt;td&gt;Philippines (the)&lt;/td&gt;
      &lt;td&gt;3.432021e+05&lt;/td&gt;
      &lt;td&gt;4.073554e+05&lt;/td&gt;
      &lt;td&gt;3.836830e+05&lt;/td&gt;
      &lt;td&gt;4.175210e+05&lt;/td&gt;
      &lt;td&gt;3.584550e+05&lt;/td&gt;
      &lt;td&gt;4.462836e+05&lt;/td&gt;
      &lt;td&gt;4.383270e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;PRK&lt;/td&gt;
      &lt;td&gt;Korea (the Democratic People&#39;s Republic of)&lt;/td&gt;
      &lt;td&gt;1.143217e+05&lt;/td&gt;
      &lt;td&gt;9.177653e+04&lt;/td&gt;
      &lt;td&gt;1.085457e+05&lt;/td&gt;
      &lt;td&gt;8.662578e+04&lt;/td&gt;
      &lt;td&gt;9.655062e+04&lt;/td&gt;
      &lt;td&gt;8.581038e+04&lt;/td&gt;
      &lt;td&gt;7.735988e+04&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;THA&lt;/td&gt;
      &lt;td&gt;Thailand&lt;/td&gt;
      &lt;td&gt;1.393798e+06&lt;/td&gt;
      &lt;td&gt;1.780993e+06&lt;/td&gt;
      &lt;td&gt;1.164699e+06&lt;/td&gt;
      &lt;td&gt;9.166575e+05&lt;/td&gt;
      &lt;td&gt;1.305046e+06&lt;/td&gt;
      &lt;td&gt;1.520788e+06&lt;/td&gt;
      &lt;td&gt;8.528673e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;20&lt;/th&gt;
      &lt;td&gt;TWN&lt;/td&gt;
      &lt;td&gt;Taiwan (Province of China)&lt;/td&gt;
      &lt;td&gt;7.866956e+04&lt;/td&gt;
      &lt;td&gt;8.089149e+04&lt;/td&gt;
      &lt;td&gt;8.705634e+04&lt;/td&gt;
      &lt;td&gt;8.138151e+04&lt;/td&gt;
      &lt;td&gt;8.990870e+04&lt;/td&gt;
      &lt;td&gt;8.333327e+04&lt;/td&gt;
      &lt;td&gt;6.619861e+04&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;21&lt;/th&gt;
      &lt;td&gt;USA&lt;/td&gt;
      &lt;td&gt;United States of America (the)&lt;/td&gt;
      &lt;td&gt;1.611324e+05&lt;/td&gt;
      &lt;td&gt;1.618576e+05&lt;/td&gt;
      &lt;td&gt;1.684799e+05&lt;/td&gt;
      &lt;td&gt;1.657254e+05&lt;/td&gt;
      &lt;td&gt;1.691351e+05&lt;/td&gt;
      &lt;td&gt;1.941455e+05&lt;/td&gt;
      &lt;td&gt;1.634842e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22&lt;/th&gt;
      &lt;td&gt;VNM&lt;/td&gt;
      &lt;td&gt;Viet Nam&lt;/td&gt;
      &lt;td&gt;1.346013e+06&lt;/td&gt;
      &lt;td&gt;1.483777e+06&lt;/td&gt;
      &lt;td&gt;1.406437e+06&lt;/td&gt;
      &lt;td&gt;1.317455e+06&lt;/td&gt;
      &lt;td&gt;1.269751e+06&lt;/td&gt;
      &lt;td&gt;1.374450e+06&lt;/td&gt;
      &lt;td&gt;1.502787e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;23&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Total&lt;/td&gt;
      &lt;td&gt;2.270357e+07&lt;/td&gt;
      &lt;td&gt;2.205208e+07&lt;/td&gt;
      &lt;td&gt;2.237234e+07&lt;/td&gt;
      &lt;td&gt;2.179462e+07&lt;/td&gt;
      &lt;td&gt;2.340491e+07&lt;/td&gt;
      &lt;td&gt;2.485387e+07&lt;/td&gt;
      &lt;td&gt;2.218801e+07&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;calculate-co2-equivalency&#34; &gt;Calculate Co2 Equivalency
&lt;span&gt;
    &lt;a href=&#34;#calculate-co2-equivalency&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;malaysia_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2015&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (malaysia_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2015&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt;)
malaysia_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2016&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (malaysia_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2016&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt;)
malaysia_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2017&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (malaysia_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2017&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt;)
malaysia_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2018&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (malaysia_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2018&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt;)
malaysia_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2019&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (malaysia_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2019&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;calculate-means&#34; &gt;Calculate Means
&lt;span&gt;
    &lt;a href=&#34;#calculate-means&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;malaysia_emissions_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;loc[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; malaysia_emissions_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;loc[(malaysia_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_name&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Total&amp;#34;&lt;/span&gt;)]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;select_dtypes(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;number)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean()
malaysia_emissions_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;at[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_name&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;
malaysia_emissions_df
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div style=&#34;overflow-x:auto;&#34;&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;iso3_country&lt;/th&gt;
      &lt;th&gt;country_name&lt;/th&gt;
      &lt;th&gt;tCH4_2015&lt;/th&gt;
      &lt;th&gt;tCH4_2016&lt;/th&gt;
      &lt;th&gt;tCH4_2017&lt;/th&gt;
      &lt;th&gt;tCH4_2018&lt;/th&gt;
      &lt;th&gt;tCH4_2019&lt;/th&gt;
      &lt;th&gt;tCH4_2020&lt;/th&gt;
      &lt;th&gt;tCH4_2021&lt;/th&gt;
      &lt;th&gt;tCO2_2015&lt;/th&gt;
      &lt;th&gt;tCO2_2016&lt;/th&gt;
      &lt;th&gt;tCO2_2017&lt;/th&gt;
      &lt;th&gt;tCO2_2018&lt;/th&gt;
      &lt;th&gt;tCO2_2019&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;BGD&lt;/td&gt;
      &lt;td&gt;Bangladesh&lt;/td&gt;
      &lt;td&gt;2.344420e+06&lt;/td&gt;
      &lt;td&gt;2.278158e+06&lt;/td&gt;
      &lt;td&gt;2.098958e+06&lt;/td&gt;
      &lt;td&gt;2.141231e+06&lt;/td&gt;
      &lt;td&gt;2.070985e+06&lt;/td&gt;
      &lt;td&gt;2.106781e+06&lt;/td&gt;
      &lt;td&gt;1.983974e+06&lt;/td&gt;
      &lt;td&gt;5.861049e+07&lt;/td&gt;
      &lt;td&gt;5.695395e+07&lt;/td&gt;
      &lt;td&gt;5.247394e+07&lt;/td&gt;
      &lt;td&gt;5.353076e+07&lt;/td&gt;
      &lt;td&gt;5.177463e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;BRA&lt;/td&gt;
      &lt;td&gt;Brazil&lt;/td&gt;
      &lt;td&gt;3.410233e+05&lt;/td&gt;
      &lt;td&gt;3.104189e+05&lt;/td&gt;
      &lt;td&gt;3.725173e+05&lt;/td&gt;
      &lt;td&gt;3.717030e+05&lt;/td&gt;
      &lt;td&gt;3.294713e+05&lt;/td&gt;
      &lt;td&gt;4.902874e+05&lt;/td&gt;
      &lt;td&gt;4.544874e+05&lt;/td&gt;
      &lt;td&gt;8.525583e+06&lt;/td&gt;
      &lt;td&gt;7.760473e+06&lt;/td&gt;
      &lt;td&gt;9.312934e+06&lt;/td&gt;
      &lt;td&gt;9.292575e+06&lt;/td&gt;
      &lt;td&gt;8.236783e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;CHN&lt;/td&gt;
      &lt;td&gt;China&lt;/td&gt;
      &lt;td&gt;6.133647e+06&lt;/td&gt;
      &lt;td&gt;5.859531e+06&lt;/td&gt;
      &lt;td&gt;6.355071e+06&lt;/td&gt;
      &lt;td&gt;5.413962e+06&lt;/td&gt;
      &lt;td&gt;5.603352e+06&lt;/td&gt;
      &lt;td&gt;6.402353e+06&lt;/td&gt;
      &lt;td&gt;6.068210e+06&lt;/td&gt;
      &lt;td&gt;1.533412e+08&lt;/td&gt;
      &lt;td&gt;1.464883e+08&lt;/td&gt;
      &lt;td&gt;1.588768e+08&lt;/td&gt;
      &lt;td&gt;1.353491e+08&lt;/td&gt;
      &lt;td&gt;1.400838e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;ESP&lt;/td&gt;
      &lt;td&gt;Spain&lt;/td&gt;
      &lt;td&gt;1.141464e+04&lt;/td&gt;
      &lt;td&gt;1.334803e+04&lt;/td&gt;
      &lt;td&gt;1.217299e+04&lt;/td&gt;
      &lt;td&gt;1.405410e+04&lt;/td&gt;
      &lt;td&gt;1.148324e+04&lt;/td&gt;
      &lt;td&gt;1.305461e+04&lt;/td&gt;
      &lt;td&gt;8.531579e+03&lt;/td&gt;
      &lt;td&gt;2.853661e+05&lt;/td&gt;
      &lt;td&gt;3.337007e+05&lt;/td&gt;
      &lt;td&gt;3.043248e+05&lt;/td&gt;
      &lt;td&gt;3.513524e+05&lt;/td&gt;
      &lt;td&gt;2.870810e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;IDN&lt;/td&gt;
      &lt;td&gt;Indonesia&lt;/td&gt;
      &lt;td&gt;1.283649e+06&lt;/td&gt;
      &lt;td&gt;1.023129e+06&lt;/td&gt;
      &lt;td&gt;9.615327e+05&lt;/td&gt;
      &lt;td&gt;1.176982e+06&lt;/td&gt;
      &lt;td&gt;1.266668e+06&lt;/td&gt;
      &lt;td&gt;1.188195e+06&lt;/td&gt;
      &lt;td&gt;1.009936e+06&lt;/td&gt;
      &lt;td&gt;3.209122e+07&lt;/td&gt;
      &lt;td&gt;2.557824e+07&lt;/td&gt;
      &lt;td&gt;2.403832e+07&lt;/td&gt;
      &lt;td&gt;2.942454e+07&lt;/td&gt;
      &lt;td&gt;3.166670e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;IND&lt;/td&gt;
      &lt;td&gt;India&lt;/td&gt;
      &lt;td&gt;6.219887e+06&lt;/td&gt;
      &lt;td&gt;5.309413e+06&lt;/td&gt;
      &lt;td&gt;6.228451e+06&lt;/td&gt;
      &lt;td&gt;6.589798e+06&lt;/td&gt;
      &lt;td&gt;7.501556e+06&lt;/td&gt;
      &lt;td&gt;7.599764e+06&lt;/td&gt;
      &lt;td&gt;6.567960e+06&lt;/td&gt;
      &lt;td&gt;1.554972e+08&lt;/td&gt;
      &lt;td&gt;1.327353e+08&lt;/td&gt;
      &lt;td&gt;1.557113e+08&lt;/td&gt;
      &lt;td&gt;1.647450e+08&lt;/td&gt;
      &lt;td&gt;1.875389e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;IRN&lt;/td&gt;
      &lt;td&gt;Iran (Islamic Republic of)&lt;/td&gt;
      &lt;td&gt;8.774407e+04&lt;/td&gt;
      &lt;td&gt;9.180121e+04&lt;/td&gt;
      &lt;td&gt;9.620217e+04&lt;/td&gt;
      &lt;td&gt;8.875744e+04&lt;/td&gt;
      &lt;td&gt;9.500199e+04&lt;/td&gt;
      &lt;td&gt;9.600254e+04&lt;/td&gt;
      &lt;td&gt;9.053525e+04&lt;/td&gt;
      &lt;td&gt;2.193602e+06&lt;/td&gt;
      &lt;td&gt;2.295030e+06&lt;/td&gt;
      &lt;td&gt;2.405054e+06&lt;/td&gt;
      &lt;td&gt;2.218936e+06&lt;/td&gt;
      &lt;td&gt;2.375050e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;ITA&lt;/td&gt;
      &lt;td&gt;Italy&lt;/td&gt;
      &lt;td&gt;4.995968e+04&lt;/td&gt;
      &lt;td&gt;4.937785e+04&lt;/td&gt;
      &lt;td&gt;5.443679e+04&lt;/td&gt;
      &lt;td&gt;4.469902e+04&lt;/td&gt;
      &lt;td&gt;4.566914e+04&lt;/td&gt;
      &lt;td&gt;5.101547e+04&lt;/td&gt;
      &lt;td&gt;5.089759e+04&lt;/td&gt;
      &lt;td&gt;1.248992e+06&lt;/td&gt;
      &lt;td&gt;1.234446e+06&lt;/td&gt;
      &lt;td&gt;1.360920e+06&lt;/td&gt;
      &lt;td&gt;1.117475e+06&lt;/td&gt;
      &lt;td&gt;1.141729e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;JPN&lt;/td&gt;
      &lt;td&gt;Japan&lt;/td&gt;
      &lt;td&gt;2.305465e+05&lt;/td&gt;
      &lt;td&gt;2.284133e+05&lt;/td&gt;
      &lt;td&gt;2.708935e+05&lt;/td&gt;
      &lt;td&gt;1.548252e+05&lt;/td&gt;
      &lt;td&gt;2.332056e+05&lt;/td&gt;
      &lt;td&gt;2.835167e+05&lt;/td&gt;
      &lt;td&gt;1.574007e+05&lt;/td&gt;
      &lt;td&gt;5.763662e+06&lt;/td&gt;
      &lt;td&gt;5.710333e+06&lt;/td&gt;
      &lt;td&gt;6.772337e+06&lt;/td&gt;
      &lt;td&gt;3.870631e+06&lt;/td&gt;
      &lt;td&gt;5.830141e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;KHM&lt;/td&gt;
      &lt;td&gt;Cambodia&lt;/td&gt;
      &lt;td&gt;4.954698e+05&lt;/td&gt;
      &lt;td&gt;5.731698e+05&lt;/td&gt;
      &lt;td&gt;4.517045e+05&lt;/td&gt;
      &lt;td&gt;5.592610e+05&lt;/td&gt;
      &lt;td&gt;5.947277e+05&lt;/td&gt;
      &lt;td&gt;6.412802e+05&lt;/td&gt;
      &lt;td&gt;5.644891e+05&lt;/td&gt;
      &lt;td&gt;1.238675e+07&lt;/td&gt;
      &lt;td&gt;1.432925e+07&lt;/td&gt;
      &lt;td&gt;1.129261e+07&lt;/td&gt;
      &lt;td&gt;1.398153e+07&lt;/td&gt;
      &lt;td&gt;1.486819e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;KOR&lt;/td&gt;
      &lt;td&gt;Korea (the Republic of)&lt;/td&gt;
      &lt;td&gt;1.451878e+05&lt;/td&gt;
      &lt;td&gt;1.274597e+05&lt;/td&gt;
      &lt;td&gt;1.463222e+05&lt;/td&gt;
      &lt;td&gt;1.293543e+05&lt;/td&gt;
      &lt;td&gt;1.327782e+05&lt;/td&gt;
      &lt;td&gt;1.165467e+05&lt;/td&gt;
      &lt;td&gt;1.013006e+05&lt;/td&gt;
      &lt;td&gt;3.629695e+06&lt;/td&gt;
      &lt;td&gt;3.186493e+06&lt;/td&gt;
      &lt;td&gt;3.658056e+06&lt;/td&gt;
      &lt;td&gt;3.233858e+06&lt;/td&gt;
      &lt;td&gt;3.319455e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;LAO&lt;/td&gt;
      &lt;td&gt;Lao People&#39;s Democratic Republic (the)&lt;/td&gt;
      &lt;td&gt;1.661169e+04&lt;/td&gt;
      &lt;td&gt;1.696441e+04&lt;/td&gt;
      &lt;td&gt;1.168063e+04&lt;/td&gt;
      &lt;td&gt;1.009675e+04&lt;/td&gt;
      &lt;td&gt;1.461058e+04&lt;/td&gt;
      &lt;td&gt;2.136270e+04&lt;/td&gt;
      &lt;td&gt;1.475014e+04&lt;/td&gt;
      &lt;td&gt;4.152924e+05&lt;/td&gt;
      &lt;td&gt;4.241102e+05&lt;/td&gt;
      &lt;td&gt;2.920158e+05&lt;/td&gt;
      &lt;td&gt;2.524186e+05&lt;/td&gt;
      &lt;td&gt;3.652645e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;LKA&lt;/td&gt;
      &lt;td&gt;Sri Lanka&lt;/td&gt;
      &lt;td&gt;8.305626e+04&lt;/td&gt;
      &lt;td&gt;1.011743e+05&lt;/td&gt;
      &lt;td&gt;5.911841e+04&lt;/td&gt;
      &lt;td&gt;9.018914e+04&lt;/td&gt;
      &lt;td&gt;8.476088e+04&lt;/td&gt;
      &lt;td&gt;9.248238e+04&lt;/td&gt;
      &lt;td&gt;8.466966e+04&lt;/td&gt;
      &lt;td&gt;2.076407e+06&lt;/td&gt;
      &lt;td&gt;2.529358e+06&lt;/td&gt;
      &lt;td&gt;1.477960e+06&lt;/td&gt;
      &lt;td&gt;2.254728e+06&lt;/td&gt;
      &lt;td&gt;2.119022e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;MMR&lt;/td&gt;
      &lt;td&gt;Myanmar&lt;/td&gt;
      &lt;td&gt;1.132082e+06&lt;/td&gt;
      &lt;td&gt;1.290806e+06&lt;/td&gt;
      &lt;td&gt;1.205169e+06&lt;/td&gt;
      &lt;td&gt;1.372447e+06&lt;/td&gt;
      &lt;td&gt;1.256888e+06&lt;/td&gt;
      &lt;td&gt;1.221904e+06&lt;/td&gt;
      &lt;td&gt;1.289837e+06&lt;/td&gt;
      &lt;td&gt;2.830206e+07&lt;/td&gt;
      &lt;td&gt;3.227014e+07&lt;/td&gt;
      &lt;td&gt;3.012923e+07&lt;/td&gt;
      &lt;td&gt;3.431117e+07&lt;/td&gt;
      &lt;td&gt;3.142221e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;MYS&lt;/td&gt;
      &lt;td&gt;Malaysia&lt;/td&gt;
      &lt;td&gt;1.057399e+05&lt;/td&gt;
      &lt;td&gt;1.110049e+05&lt;/td&gt;
      &lt;td&gt;1.111291e+05&lt;/td&gt;
      &lt;td&gt;1.066525e+05&lt;/td&gt;
      &lt;td&gt;1.056287e+05&lt;/td&gt;
      &lt;td&gt;1.127141e+05&lt;/td&gt;
      &lt;td&gt;1.069696e+05&lt;/td&gt;
      &lt;td&gt;2.643498e+06&lt;/td&gt;
      &lt;td&gt;2.775123e+06&lt;/td&gt;
      &lt;td&gt;2.778227e+06&lt;/td&gt;
      &lt;td&gt;2.666313e+06&lt;/td&gt;
      &lt;td&gt;2.640717e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;NPL&lt;/td&gt;
      &lt;td&gt;Nepal&lt;/td&gt;
      &lt;td&gt;1.007479e+05&lt;/td&gt;
      &lt;td&gt;6.667161e+04&lt;/td&gt;
      &lt;td&gt;8.081300e+04&lt;/td&gt;
      &lt;td&gt;9.200752e+04&lt;/td&gt;
      &lt;td&gt;1.164235e+05&lt;/td&gt;
      &lt;td&gt;7.168401e+04&lt;/td&gt;
      &lt;td&gt;4.811408e+04&lt;/td&gt;
      &lt;td&gt;2.518697e+06&lt;/td&gt;
      &lt;td&gt;1.666790e+06&lt;/td&gt;
      &lt;td&gt;2.020325e+06&lt;/td&gt;
      &lt;td&gt;2.300188e+06&lt;/td&gt;
      &lt;td&gt;2.910588e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;PAK&lt;/td&gt;
      &lt;td&gt;Pakistan&lt;/td&gt;
      &lt;td&gt;4.852431e+05&lt;/td&gt;
      &lt;td&gt;5.945922e+05&lt;/td&gt;
      &lt;td&gt;5.372641e+05&lt;/td&gt;
      &lt;td&gt;4.532297e+05&lt;/td&gt;
      &lt;td&gt;6.528548e+05&lt;/td&gt;
      &lt;td&gt;6.401201e+05&lt;/td&gt;
      &lt;td&gt;4.849205e+05&lt;/td&gt;
      &lt;td&gt;1.213108e+07&lt;/td&gt;
      &lt;td&gt;1.486480e+07&lt;/td&gt;
      &lt;td&gt;1.343160e+07&lt;/td&gt;
      &lt;td&gt;1.133074e+07&lt;/td&gt;
      &lt;td&gt;1.632137e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;PHL&lt;/td&gt;
      &lt;td&gt;Philippines (the)&lt;/td&gt;
      &lt;td&gt;3.432021e+05&lt;/td&gt;
      &lt;td&gt;4.073554e+05&lt;/td&gt;
      &lt;td&gt;3.836830e+05&lt;/td&gt;
      &lt;td&gt;4.175210e+05&lt;/td&gt;
      &lt;td&gt;3.584550e+05&lt;/td&gt;
      &lt;td&gt;4.462836e+05&lt;/td&gt;
      &lt;td&gt;4.383270e+05&lt;/td&gt;
      &lt;td&gt;8.580052e+06&lt;/td&gt;
      &lt;td&gt;1.018389e+07&lt;/td&gt;
      &lt;td&gt;9.592074e+06&lt;/td&gt;
      &lt;td&gt;1.043803e+07&lt;/td&gt;
      &lt;td&gt;8.961374e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;PRK&lt;/td&gt;
      &lt;td&gt;Korea (the Democratic People&#39;s Republic of)&lt;/td&gt;
      &lt;td&gt;1.143217e+05&lt;/td&gt;
      &lt;td&gt;9.177653e+04&lt;/td&gt;
      &lt;td&gt;1.085457e+05&lt;/td&gt;
      &lt;td&gt;8.662578e+04&lt;/td&gt;
      &lt;td&gt;9.655062e+04&lt;/td&gt;
      &lt;td&gt;8.581038e+04&lt;/td&gt;
      &lt;td&gt;7.735988e+04&lt;/td&gt;
      &lt;td&gt;2.858041e+06&lt;/td&gt;
      &lt;td&gt;2.294413e+06&lt;/td&gt;
      &lt;td&gt;2.713641e+06&lt;/td&gt;
      &lt;td&gt;2.165645e+06&lt;/td&gt;
      &lt;td&gt;2.413765e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;THA&lt;/td&gt;
      &lt;td&gt;Thailand&lt;/td&gt;
      &lt;td&gt;1.393798e+06&lt;/td&gt;
      &lt;td&gt;1.780993e+06&lt;/td&gt;
      &lt;td&gt;1.164699e+06&lt;/td&gt;
      &lt;td&gt;9.166575e+05&lt;/td&gt;
      &lt;td&gt;1.305046e+06&lt;/td&gt;
      &lt;td&gt;1.520788e+06&lt;/td&gt;
      &lt;td&gt;8.528673e+05&lt;/td&gt;
      &lt;td&gt;3.484495e+07&lt;/td&gt;
      &lt;td&gt;4.452483e+07&lt;/td&gt;
      &lt;td&gt;2.911748e+07&lt;/td&gt;
      &lt;td&gt;2.291644e+07&lt;/td&gt;
      &lt;td&gt;3.262615e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;20&lt;/th&gt;
      &lt;td&gt;TWN&lt;/td&gt;
      &lt;td&gt;Taiwan (Province of China)&lt;/td&gt;
      &lt;td&gt;7.866956e+04&lt;/td&gt;
      &lt;td&gt;8.089149e+04&lt;/td&gt;
      &lt;td&gt;8.705634e+04&lt;/td&gt;
      &lt;td&gt;8.138151e+04&lt;/td&gt;
      &lt;td&gt;8.990870e+04&lt;/td&gt;
      &lt;td&gt;8.333327e+04&lt;/td&gt;
      &lt;td&gt;6.619861e+04&lt;/td&gt;
      &lt;td&gt;1.966739e+06&lt;/td&gt;
      &lt;td&gt;2.022287e+06&lt;/td&gt;
      &lt;td&gt;2.176408e+06&lt;/td&gt;
      &lt;td&gt;2.034538e+06&lt;/td&gt;
      &lt;td&gt;2.247717e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;21&lt;/th&gt;
      &lt;td&gt;USA&lt;/td&gt;
      &lt;td&gt;United States of America (the)&lt;/td&gt;
      &lt;td&gt;1.611324e+05&lt;/td&gt;
      &lt;td&gt;1.618576e+05&lt;/td&gt;
      &lt;td&gt;1.684799e+05&lt;/td&gt;
      &lt;td&gt;1.657254e+05&lt;/td&gt;
      &lt;td&gt;1.691351e+05&lt;/td&gt;
      &lt;td&gt;1.941455e+05&lt;/td&gt;
      &lt;td&gt;1.634842e+05&lt;/td&gt;
      &lt;td&gt;4.028310e+06&lt;/td&gt;
      &lt;td&gt;4.046440e+06&lt;/td&gt;
      &lt;td&gt;4.211999e+06&lt;/td&gt;
      &lt;td&gt;4.143136e+06&lt;/td&gt;
      &lt;td&gt;4.228377e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22&lt;/th&gt;
      &lt;td&gt;VNM&lt;/td&gt;
      &lt;td&gt;Viet Nam&lt;/td&gt;
      &lt;td&gt;1.346013e+06&lt;/td&gt;
      &lt;td&gt;1.483777e+06&lt;/td&gt;
      &lt;td&gt;1.406437e+06&lt;/td&gt;
      &lt;td&gt;1.317455e+06&lt;/td&gt;
      &lt;td&gt;1.269751e+06&lt;/td&gt;
      &lt;td&gt;1.374450e+06&lt;/td&gt;
      &lt;td&gt;1.502787e+06&lt;/td&gt;
      &lt;td&gt;3.365033e+07&lt;/td&gt;
      &lt;td&gt;3.709441e+07&lt;/td&gt;
      &lt;td&gt;3.516092e+07&lt;/td&gt;
      &lt;td&gt;3.293637e+07&lt;/td&gt;
      &lt;td&gt;3.174377e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;23&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Total&lt;/td&gt;
      &lt;td&gt;2.270357e+07&lt;/td&gt;
      &lt;td&gt;2.205208e+07&lt;/td&gt;
      &lt;td&gt;2.237234e+07&lt;/td&gt;
      &lt;td&gt;2.179462e+07&lt;/td&gt;
      &lt;td&gt;2.340491e+07&lt;/td&gt;
      &lt;td&gt;2.485387e+07&lt;/td&gt;
      &lt;td&gt;2.218801e+07&lt;/td&gt;
      &lt;td&gt;5.675891e+08&lt;/td&gt;
      &lt;td&gt;5.513021e+08&lt;/td&gt;
      &lt;td&gt;5.593084e+08&lt;/td&gt;
      &lt;td&gt;5.448654e+08&lt;/td&gt;
      &lt;td&gt;5.851228e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;mean&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;mean&lt;/td&gt;
      &lt;td&gt;9.871116e+05&lt;/td&gt;
      &lt;td&gt;9.587863e+05&lt;/td&gt;
      &lt;td&gt;9.727103e+05&lt;/td&gt;
      &lt;td&gt;9.475920e+05&lt;/td&gt;
      &lt;td&gt;1.017605e+06&lt;/td&gt;
      &lt;td&gt;1.080603e+06&lt;/td&gt;
      &lt;td&gt;9.646959e+05&lt;/td&gt;
      &lt;td&gt;2.467779e+07&lt;/td&gt;
      &lt;td&gt;2.396966e+07&lt;/td&gt;
      &lt;td&gt;2.431776e+07&lt;/td&gt;
      &lt;td&gt;2.368980e+07&lt;/td&gt;
      &lt;td&gt;2.544012e+07&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;calculate-means-and-totals-across-rows&#34; &gt;Calculate Means and Totals Across Rows
&lt;span&gt;
    &lt;a href=&#34;#calculate-means-and-totals-across-rows&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;mean_series &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; malaysia_emissions_df[[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2015&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2016&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2017&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2018&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2019&amp;#39;&lt;/span&gt;]]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;select_dtypes(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;number)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean(axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
total_series &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; malaysia_emissions_df[[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2015&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2016&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2017&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2018&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2019&amp;#39;&lt;/span&gt;]]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;select_dtypes(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;number)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sum(axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
malaysia_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Mean_CH4&amp;#34;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; mean_series
malaysia_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total_CH4&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; total_series 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;## the select np.number is uncecessary, but i&amp;#39;m including anyways as it doesnt really hurt but for a small calculation penalty&lt;/span&gt;
mean_series &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; malaysia_emissions_df[[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2015&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2016&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2017&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2018&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2019&amp;#39;&lt;/span&gt;]]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;select_dtypes(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;number)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean(axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
total_series &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; malaysia_emissions_df[[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2015&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2016&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2017&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2018&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2019&amp;#39;&lt;/span&gt;]]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;select_dtypes(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;number)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sum(axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
malaysia_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Mean_CO2&amp;#34;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; mean_series
malaysia_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total_CO2&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; total_series 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;malaysia_emissions_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;reset_index(inplace&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, drop &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;malaysia_emissions_df
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div style=&#34;overflow-x:auto;&#34;&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;iso3_country&lt;/th&gt;
      &lt;th&gt;country_name&lt;/th&gt;
      &lt;th&gt;tCH4_2015&lt;/th&gt;
      &lt;th&gt;tCH4_2016&lt;/th&gt;
      &lt;th&gt;tCH4_2017&lt;/th&gt;
      &lt;th&gt;tCH4_2018&lt;/th&gt;
      &lt;th&gt;tCH4_2019&lt;/th&gt;
      &lt;th&gt;tCH4_2020&lt;/th&gt;
      &lt;th&gt;tCH4_2021&lt;/th&gt;
      &lt;th&gt;tCO2_2015&lt;/th&gt;
      &lt;th&gt;tCO2_2016&lt;/th&gt;
      &lt;th&gt;tCO2_2017&lt;/th&gt;
      &lt;th&gt;tCO2_2018&lt;/th&gt;
      &lt;th&gt;tCO2_2019&lt;/th&gt;
      &lt;th&gt;Mean_CH4&lt;/th&gt;
      &lt;th&gt;Total_CH4&lt;/th&gt;
      &lt;th&gt;Mean_CO2&lt;/th&gt;
      &lt;th&gt;Total_CO2&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;BGD&lt;/td&gt;
      &lt;td&gt;Bangladesh&lt;/td&gt;
      &lt;td&gt;2.344420e+06&lt;/td&gt;
      &lt;td&gt;2.278158e+06&lt;/td&gt;
      &lt;td&gt;2.098958e+06&lt;/td&gt;
      &lt;td&gt;2.141231e+06&lt;/td&gt;
      &lt;td&gt;2.070985e+06&lt;/td&gt;
      &lt;td&gt;2.106781e+06&lt;/td&gt;
      &lt;td&gt;1.983974e+06&lt;/td&gt;
      &lt;td&gt;5.861049e+07&lt;/td&gt;
      &lt;td&gt;5.695395e+07&lt;/td&gt;
      &lt;td&gt;5.247394e+07&lt;/td&gt;
      &lt;td&gt;5.353076e+07&lt;/td&gt;
      &lt;td&gt;5.177463e+07&lt;/td&gt;
      &lt;td&gt;2.186750e+06&lt;/td&gt;
      &lt;td&gt;1.093375e+07&lt;/td&gt;
      &lt;td&gt;5.466875e+07&lt;/td&gt;
      &lt;td&gt;2.733438e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;BRA&lt;/td&gt;
      &lt;td&gt;Brazil&lt;/td&gt;
      &lt;td&gt;3.410233e+05&lt;/td&gt;
      &lt;td&gt;3.104189e+05&lt;/td&gt;
      &lt;td&gt;3.725173e+05&lt;/td&gt;
      &lt;td&gt;3.717030e+05&lt;/td&gt;
      &lt;td&gt;3.294713e+05&lt;/td&gt;
      &lt;td&gt;4.902874e+05&lt;/td&gt;
      &lt;td&gt;4.544874e+05&lt;/td&gt;
      &lt;td&gt;8.525583e+06&lt;/td&gt;
      &lt;td&gt;7.760473e+06&lt;/td&gt;
      &lt;td&gt;9.312934e+06&lt;/td&gt;
      &lt;td&gt;9.292575e+06&lt;/td&gt;
      &lt;td&gt;8.236783e+06&lt;/td&gt;
      &lt;td&gt;3.450268e+05&lt;/td&gt;
      &lt;td&gt;1.725134e+06&lt;/td&gt;
      &lt;td&gt;8.625670e+06&lt;/td&gt;
      &lt;td&gt;4.312835e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;CHN&lt;/td&gt;
      &lt;td&gt;China&lt;/td&gt;
      &lt;td&gt;6.133647e+06&lt;/td&gt;
      &lt;td&gt;5.859531e+06&lt;/td&gt;
      &lt;td&gt;6.355071e+06&lt;/td&gt;
      &lt;td&gt;5.413962e+06&lt;/td&gt;
      &lt;td&gt;5.603352e+06&lt;/td&gt;
      &lt;td&gt;6.402353e+06&lt;/td&gt;
      &lt;td&gt;6.068210e+06&lt;/td&gt;
      &lt;td&gt;1.533412e+08&lt;/td&gt;
      &lt;td&gt;1.464883e+08&lt;/td&gt;
      &lt;td&gt;1.588768e+08&lt;/td&gt;
      &lt;td&gt;1.353491e+08&lt;/td&gt;
      &lt;td&gt;1.400838e+08&lt;/td&gt;
      &lt;td&gt;5.873113e+06&lt;/td&gt;
      &lt;td&gt;2.936556e+07&lt;/td&gt;
      &lt;td&gt;1.468278e+08&lt;/td&gt;
      &lt;td&gt;7.341391e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;ESP&lt;/td&gt;
      &lt;td&gt;Spain&lt;/td&gt;
      &lt;td&gt;1.141464e+04&lt;/td&gt;
      &lt;td&gt;1.334803e+04&lt;/td&gt;
      &lt;td&gt;1.217299e+04&lt;/td&gt;
      &lt;td&gt;1.405410e+04&lt;/td&gt;
      &lt;td&gt;1.148324e+04&lt;/td&gt;
      &lt;td&gt;1.305461e+04&lt;/td&gt;
      &lt;td&gt;8.531579e+03&lt;/td&gt;
      &lt;td&gt;2.853661e+05&lt;/td&gt;
      &lt;td&gt;3.337007e+05&lt;/td&gt;
      &lt;td&gt;3.043248e+05&lt;/td&gt;
      &lt;td&gt;3.513524e+05&lt;/td&gt;
      &lt;td&gt;2.870810e+05&lt;/td&gt;
      &lt;td&gt;1.249460e+04&lt;/td&gt;
      &lt;td&gt;6.247300e+04&lt;/td&gt;
      &lt;td&gt;3.123650e+05&lt;/td&gt;
      &lt;td&gt;1.561825e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;IDN&lt;/td&gt;
      &lt;td&gt;Indonesia&lt;/td&gt;
      &lt;td&gt;1.283649e+06&lt;/td&gt;
      &lt;td&gt;1.023129e+06&lt;/td&gt;
      &lt;td&gt;9.615327e+05&lt;/td&gt;
      &lt;td&gt;1.176982e+06&lt;/td&gt;
      &lt;td&gt;1.266668e+06&lt;/td&gt;
      &lt;td&gt;1.188195e+06&lt;/td&gt;
      &lt;td&gt;1.009936e+06&lt;/td&gt;
      &lt;td&gt;3.209122e+07&lt;/td&gt;
      &lt;td&gt;2.557824e+07&lt;/td&gt;
      &lt;td&gt;2.403832e+07&lt;/td&gt;
      &lt;td&gt;2.942454e+07&lt;/td&gt;
      &lt;td&gt;3.166670e+07&lt;/td&gt;
      &lt;td&gt;1.142392e+06&lt;/td&gt;
      &lt;td&gt;5.711960e+06&lt;/td&gt;
      &lt;td&gt;2.855980e+07&lt;/td&gt;
      &lt;td&gt;1.427990e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;IND&lt;/td&gt;
      &lt;td&gt;India&lt;/td&gt;
      &lt;td&gt;6.219887e+06&lt;/td&gt;
      &lt;td&gt;5.309413e+06&lt;/td&gt;
      &lt;td&gt;6.228451e+06&lt;/td&gt;
      &lt;td&gt;6.589798e+06&lt;/td&gt;
      &lt;td&gt;7.501556e+06&lt;/td&gt;
      &lt;td&gt;7.599764e+06&lt;/td&gt;
      &lt;td&gt;6.567960e+06&lt;/td&gt;
      &lt;td&gt;1.554972e+08&lt;/td&gt;
      &lt;td&gt;1.327353e+08&lt;/td&gt;
      &lt;td&gt;1.557113e+08&lt;/td&gt;
      &lt;td&gt;1.647450e+08&lt;/td&gt;
      &lt;td&gt;1.875389e+08&lt;/td&gt;
      &lt;td&gt;6.369821e+06&lt;/td&gt;
      &lt;td&gt;3.184910e+07&lt;/td&gt;
      &lt;td&gt;1.592455e+08&lt;/td&gt;
      &lt;td&gt;7.962276e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;IRN&lt;/td&gt;
      &lt;td&gt;Iran (Islamic Republic of)&lt;/td&gt;
      &lt;td&gt;8.774407e+04&lt;/td&gt;
      &lt;td&gt;9.180121e+04&lt;/td&gt;
      &lt;td&gt;9.620217e+04&lt;/td&gt;
      &lt;td&gt;8.875744e+04&lt;/td&gt;
      &lt;td&gt;9.500199e+04&lt;/td&gt;
      &lt;td&gt;9.600254e+04&lt;/td&gt;
      &lt;td&gt;9.053525e+04&lt;/td&gt;
      &lt;td&gt;2.193602e+06&lt;/td&gt;
      &lt;td&gt;2.295030e+06&lt;/td&gt;
      &lt;td&gt;2.405054e+06&lt;/td&gt;
      &lt;td&gt;2.218936e+06&lt;/td&gt;
      &lt;td&gt;2.375050e+06&lt;/td&gt;
      &lt;td&gt;9.190138e+04&lt;/td&gt;
      &lt;td&gt;4.595069e+05&lt;/td&gt;
      &lt;td&gt;2.297534e+06&lt;/td&gt;
      &lt;td&gt;1.148767e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;ITA&lt;/td&gt;
      &lt;td&gt;Italy&lt;/td&gt;
      &lt;td&gt;4.995968e+04&lt;/td&gt;
      &lt;td&gt;4.937785e+04&lt;/td&gt;
      &lt;td&gt;5.443679e+04&lt;/td&gt;
      &lt;td&gt;4.469902e+04&lt;/td&gt;
      &lt;td&gt;4.566914e+04&lt;/td&gt;
      &lt;td&gt;5.101547e+04&lt;/td&gt;
      &lt;td&gt;5.089759e+04&lt;/td&gt;
      &lt;td&gt;1.248992e+06&lt;/td&gt;
      &lt;td&gt;1.234446e+06&lt;/td&gt;
      &lt;td&gt;1.360920e+06&lt;/td&gt;
      &lt;td&gt;1.117475e+06&lt;/td&gt;
      &lt;td&gt;1.141729e+06&lt;/td&gt;
      &lt;td&gt;4.882850e+04&lt;/td&gt;
      &lt;td&gt;2.441425e+05&lt;/td&gt;
      &lt;td&gt;1.220712e+06&lt;/td&gt;
      &lt;td&gt;6.103562e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;JPN&lt;/td&gt;
      &lt;td&gt;Japan&lt;/td&gt;
      &lt;td&gt;2.305465e+05&lt;/td&gt;
      &lt;td&gt;2.284133e+05&lt;/td&gt;
      &lt;td&gt;2.708935e+05&lt;/td&gt;
      &lt;td&gt;1.548252e+05&lt;/td&gt;
      &lt;td&gt;2.332056e+05&lt;/td&gt;
      &lt;td&gt;2.835167e+05&lt;/td&gt;
      &lt;td&gt;1.574007e+05&lt;/td&gt;
      &lt;td&gt;5.763662e+06&lt;/td&gt;
      &lt;td&gt;5.710333e+06&lt;/td&gt;
      &lt;td&gt;6.772337e+06&lt;/td&gt;
      &lt;td&gt;3.870631e+06&lt;/td&gt;
      &lt;td&gt;5.830141e+06&lt;/td&gt;
      &lt;td&gt;2.235768e+05&lt;/td&gt;
      &lt;td&gt;1.117884e+06&lt;/td&gt;
      &lt;td&gt;5.589421e+06&lt;/td&gt;
      &lt;td&gt;2.794710e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;KHM&lt;/td&gt;
      &lt;td&gt;Cambodia&lt;/td&gt;
      &lt;td&gt;4.954698e+05&lt;/td&gt;
      &lt;td&gt;5.731698e+05&lt;/td&gt;
      &lt;td&gt;4.517045e+05&lt;/td&gt;
      &lt;td&gt;5.592610e+05&lt;/td&gt;
      &lt;td&gt;5.947277e+05&lt;/td&gt;
      &lt;td&gt;6.412802e+05&lt;/td&gt;
      &lt;td&gt;5.644891e+05&lt;/td&gt;
      &lt;td&gt;1.238675e+07&lt;/td&gt;
      &lt;td&gt;1.432925e+07&lt;/td&gt;
      &lt;td&gt;1.129261e+07&lt;/td&gt;
      &lt;td&gt;1.398153e+07&lt;/td&gt;
      &lt;td&gt;1.486819e+07&lt;/td&gt;
      &lt;td&gt;5.348666e+05&lt;/td&gt;
      &lt;td&gt;2.674333e+06&lt;/td&gt;
      &lt;td&gt;1.337166e+07&lt;/td&gt;
      &lt;td&gt;6.685832e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;KOR&lt;/td&gt;
      &lt;td&gt;Korea (the Republic of)&lt;/td&gt;
      &lt;td&gt;1.451878e+05&lt;/td&gt;
      &lt;td&gt;1.274597e+05&lt;/td&gt;
      &lt;td&gt;1.463222e+05&lt;/td&gt;
      &lt;td&gt;1.293543e+05&lt;/td&gt;
      &lt;td&gt;1.327782e+05&lt;/td&gt;
      &lt;td&gt;1.165467e+05&lt;/td&gt;
      &lt;td&gt;1.013006e+05&lt;/td&gt;
      &lt;td&gt;3.629695e+06&lt;/td&gt;
      &lt;td&gt;3.186493e+06&lt;/td&gt;
      &lt;td&gt;3.658056e+06&lt;/td&gt;
      &lt;td&gt;3.233858e+06&lt;/td&gt;
      &lt;td&gt;3.319455e+06&lt;/td&gt;
      &lt;td&gt;1.362205e+05&lt;/td&gt;
      &lt;td&gt;6.811023e+05&lt;/td&gt;
      &lt;td&gt;3.405512e+06&lt;/td&gt;
      &lt;td&gt;1.702756e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;LAO&lt;/td&gt;
      &lt;td&gt;Lao People&#39;s Democratic Republic (the)&lt;/td&gt;
      &lt;td&gt;1.661169e+04&lt;/td&gt;
      &lt;td&gt;1.696441e+04&lt;/td&gt;
      &lt;td&gt;1.168063e+04&lt;/td&gt;
      &lt;td&gt;1.009675e+04&lt;/td&gt;
      &lt;td&gt;1.461058e+04&lt;/td&gt;
      &lt;td&gt;2.136270e+04&lt;/td&gt;
      &lt;td&gt;1.475014e+04&lt;/td&gt;
      &lt;td&gt;4.152924e+05&lt;/td&gt;
      &lt;td&gt;4.241102e+05&lt;/td&gt;
      &lt;td&gt;2.920158e+05&lt;/td&gt;
      &lt;td&gt;2.524186e+05&lt;/td&gt;
      &lt;td&gt;3.652645e+05&lt;/td&gt;
      &lt;td&gt;1.399281e+04&lt;/td&gt;
      &lt;td&gt;6.996406e+04&lt;/td&gt;
      &lt;td&gt;3.498203e+05&lt;/td&gt;
      &lt;td&gt;1.749102e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;LKA&lt;/td&gt;
      &lt;td&gt;Sri Lanka&lt;/td&gt;
      &lt;td&gt;8.305626e+04&lt;/td&gt;
      &lt;td&gt;1.011743e+05&lt;/td&gt;
      &lt;td&gt;5.911841e+04&lt;/td&gt;
      &lt;td&gt;9.018914e+04&lt;/td&gt;
      &lt;td&gt;8.476088e+04&lt;/td&gt;
      &lt;td&gt;9.248238e+04&lt;/td&gt;
      &lt;td&gt;8.466966e+04&lt;/td&gt;
      &lt;td&gt;2.076407e+06&lt;/td&gt;
      &lt;td&gt;2.529358e+06&lt;/td&gt;
      &lt;td&gt;1.477960e+06&lt;/td&gt;
      &lt;td&gt;2.254728e+06&lt;/td&gt;
      &lt;td&gt;2.119022e+06&lt;/td&gt;
      &lt;td&gt;8.365981e+04&lt;/td&gt;
      &lt;td&gt;4.182990e+05&lt;/td&gt;
      &lt;td&gt;2.091495e+06&lt;/td&gt;
      &lt;td&gt;1.045748e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;MMR&lt;/td&gt;
      &lt;td&gt;Myanmar&lt;/td&gt;
      &lt;td&gt;1.132082e+06&lt;/td&gt;
      &lt;td&gt;1.290806e+06&lt;/td&gt;
      &lt;td&gt;1.205169e+06&lt;/td&gt;
      &lt;td&gt;1.372447e+06&lt;/td&gt;
      &lt;td&gt;1.256888e+06&lt;/td&gt;
      &lt;td&gt;1.221904e+06&lt;/td&gt;
      &lt;td&gt;1.289837e+06&lt;/td&gt;
      &lt;td&gt;2.830206e+07&lt;/td&gt;
      &lt;td&gt;3.227014e+07&lt;/td&gt;
      &lt;td&gt;3.012923e+07&lt;/td&gt;
      &lt;td&gt;3.431117e+07&lt;/td&gt;
      &lt;td&gt;3.142221e+07&lt;/td&gt;
      &lt;td&gt;1.251478e+06&lt;/td&gt;
      &lt;td&gt;6.257392e+06&lt;/td&gt;
      &lt;td&gt;3.128696e+07&lt;/td&gt;
      &lt;td&gt;1.564348e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;MYS&lt;/td&gt;
      &lt;td&gt;Malaysia&lt;/td&gt;
      &lt;td&gt;1.057399e+05&lt;/td&gt;
      &lt;td&gt;1.110049e+05&lt;/td&gt;
      &lt;td&gt;1.111291e+05&lt;/td&gt;
      &lt;td&gt;1.066525e+05&lt;/td&gt;
      &lt;td&gt;1.056287e+05&lt;/td&gt;
      &lt;td&gt;1.127141e+05&lt;/td&gt;
      &lt;td&gt;1.069696e+05&lt;/td&gt;
      &lt;td&gt;2.643498e+06&lt;/td&gt;
      &lt;td&gt;2.775123e+06&lt;/td&gt;
      &lt;td&gt;2.778227e+06&lt;/td&gt;
      &lt;td&gt;2.666313e+06&lt;/td&gt;
      &lt;td&gt;2.640717e+06&lt;/td&gt;
      &lt;td&gt;1.080310e+05&lt;/td&gt;
      &lt;td&gt;5.401551e+05&lt;/td&gt;
      &lt;td&gt;2.700775e+06&lt;/td&gt;
      &lt;td&gt;1.350388e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;NPL&lt;/td&gt;
      &lt;td&gt;Nepal&lt;/td&gt;
      &lt;td&gt;1.007479e+05&lt;/td&gt;
      &lt;td&gt;6.667161e+04&lt;/td&gt;
      &lt;td&gt;8.081300e+04&lt;/td&gt;
      &lt;td&gt;9.200752e+04&lt;/td&gt;
      &lt;td&gt;1.164235e+05&lt;/td&gt;
      &lt;td&gt;7.168401e+04&lt;/td&gt;
      &lt;td&gt;4.811408e+04&lt;/td&gt;
      &lt;td&gt;2.518697e+06&lt;/td&gt;
      &lt;td&gt;1.666790e+06&lt;/td&gt;
      &lt;td&gt;2.020325e+06&lt;/td&gt;
      &lt;td&gt;2.300188e+06&lt;/td&gt;
      &lt;td&gt;2.910588e+06&lt;/td&gt;
      &lt;td&gt;9.133271e+04&lt;/td&gt;
      &lt;td&gt;4.566635e+05&lt;/td&gt;
      &lt;td&gt;2.283318e+06&lt;/td&gt;
      &lt;td&gt;1.141659e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;PAK&lt;/td&gt;
      &lt;td&gt;Pakistan&lt;/td&gt;
      &lt;td&gt;4.852431e+05&lt;/td&gt;
      &lt;td&gt;5.945922e+05&lt;/td&gt;
      &lt;td&gt;5.372641e+05&lt;/td&gt;
      &lt;td&gt;4.532297e+05&lt;/td&gt;
      &lt;td&gt;6.528548e+05&lt;/td&gt;
      &lt;td&gt;6.401201e+05&lt;/td&gt;
      &lt;td&gt;4.849205e+05&lt;/td&gt;
      &lt;td&gt;1.213108e+07&lt;/td&gt;
      &lt;td&gt;1.486480e+07&lt;/td&gt;
      &lt;td&gt;1.343160e+07&lt;/td&gt;
      &lt;td&gt;1.133074e+07&lt;/td&gt;
      &lt;td&gt;1.632137e+07&lt;/td&gt;
      &lt;td&gt;5.446368e+05&lt;/td&gt;
      &lt;td&gt;2.723184e+06&lt;/td&gt;
      &lt;td&gt;1.361592e+07&lt;/td&gt;
      &lt;td&gt;6.807960e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;PHL&lt;/td&gt;
      &lt;td&gt;Philippines (the)&lt;/td&gt;
      &lt;td&gt;3.432021e+05&lt;/td&gt;
      &lt;td&gt;4.073554e+05&lt;/td&gt;
      &lt;td&gt;3.836830e+05&lt;/td&gt;
      &lt;td&gt;4.175210e+05&lt;/td&gt;
      &lt;td&gt;3.584550e+05&lt;/td&gt;
      &lt;td&gt;4.462836e+05&lt;/td&gt;
      &lt;td&gt;4.383270e+05&lt;/td&gt;
      &lt;td&gt;8.580052e+06&lt;/td&gt;
      &lt;td&gt;1.018389e+07&lt;/td&gt;
      &lt;td&gt;9.592074e+06&lt;/td&gt;
      &lt;td&gt;1.043803e+07&lt;/td&gt;
      &lt;td&gt;8.961374e+06&lt;/td&gt;
      &lt;td&gt;3.820433e+05&lt;/td&gt;
      &lt;td&gt;1.910216e+06&lt;/td&gt;
      &lt;td&gt;9.551082e+06&lt;/td&gt;
      &lt;td&gt;4.775541e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;PRK&lt;/td&gt;
      &lt;td&gt;Korea (the Democratic People&#39;s Republic of)&lt;/td&gt;
      &lt;td&gt;1.143217e+05&lt;/td&gt;
      &lt;td&gt;9.177653e+04&lt;/td&gt;
      &lt;td&gt;1.085457e+05&lt;/td&gt;
      &lt;td&gt;8.662578e+04&lt;/td&gt;
      &lt;td&gt;9.655062e+04&lt;/td&gt;
      &lt;td&gt;8.581038e+04&lt;/td&gt;
      &lt;td&gt;7.735988e+04&lt;/td&gt;
      &lt;td&gt;2.858041e+06&lt;/td&gt;
      &lt;td&gt;2.294413e+06&lt;/td&gt;
      &lt;td&gt;2.713641e+06&lt;/td&gt;
      &lt;td&gt;2.165645e+06&lt;/td&gt;
      &lt;td&gt;2.413765e+06&lt;/td&gt;
      &lt;td&gt;9.956405e+04&lt;/td&gt;
      &lt;td&gt;4.978202e+05&lt;/td&gt;
      &lt;td&gt;2.489101e+06&lt;/td&gt;
      &lt;td&gt;1.244551e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;THA&lt;/td&gt;
      &lt;td&gt;Thailand&lt;/td&gt;
      &lt;td&gt;1.393798e+06&lt;/td&gt;
      &lt;td&gt;1.780993e+06&lt;/td&gt;
      &lt;td&gt;1.164699e+06&lt;/td&gt;
      &lt;td&gt;9.166575e+05&lt;/td&gt;
      &lt;td&gt;1.305046e+06&lt;/td&gt;
      &lt;td&gt;1.520788e+06&lt;/td&gt;
      &lt;td&gt;8.528673e+05&lt;/td&gt;
      &lt;td&gt;3.484495e+07&lt;/td&gt;
      &lt;td&gt;4.452483e+07&lt;/td&gt;
      &lt;td&gt;2.911748e+07&lt;/td&gt;
      &lt;td&gt;2.291644e+07&lt;/td&gt;
      &lt;td&gt;3.262615e+07&lt;/td&gt;
      &lt;td&gt;1.312239e+06&lt;/td&gt;
      &lt;td&gt;6.561194e+06&lt;/td&gt;
      &lt;td&gt;3.280597e+07&lt;/td&gt;
      &lt;td&gt;1.640298e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;20&lt;/th&gt;
      &lt;td&gt;TWN&lt;/td&gt;
      &lt;td&gt;Taiwan (Province of China)&lt;/td&gt;
      &lt;td&gt;7.866956e+04&lt;/td&gt;
      &lt;td&gt;8.089149e+04&lt;/td&gt;
      &lt;td&gt;8.705634e+04&lt;/td&gt;
      &lt;td&gt;8.138151e+04&lt;/td&gt;
      &lt;td&gt;8.990870e+04&lt;/td&gt;
      &lt;td&gt;8.333327e+04&lt;/td&gt;
      &lt;td&gt;6.619861e+04&lt;/td&gt;
      &lt;td&gt;1.966739e+06&lt;/td&gt;
      &lt;td&gt;2.022287e+06&lt;/td&gt;
      &lt;td&gt;2.176408e+06&lt;/td&gt;
      &lt;td&gt;2.034538e+06&lt;/td&gt;
      &lt;td&gt;2.247717e+06&lt;/td&gt;
      &lt;td&gt;8.358152e+04&lt;/td&gt;
      &lt;td&gt;4.179076e+05&lt;/td&gt;
      &lt;td&gt;2.089538e+06&lt;/td&gt;
      &lt;td&gt;1.044769e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;21&lt;/th&gt;
      &lt;td&gt;USA&lt;/td&gt;
      &lt;td&gt;United States of America (the)&lt;/td&gt;
      &lt;td&gt;1.611324e+05&lt;/td&gt;
      &lt;td&gt;1.618576e+05&lt;/td&gt;
      &lt;td&gt;1.684799e+05&lt;/td&gt;
      &lt;td&gt;1.657254e+05&lt;/td&gt;
      &lt;td&gt;1.691351e+05&lt;/td&gt;
      &lt;td&gt;1.941455e+05&lt;/td&gt;
      &lt;td&gt;1.634842e+05&lt;/td&gt;
      &lt;td&gt;4.028310e+06&lt;/td&gt;
      &lt;td&gt;4.046440e+06&lt;/td&gt;
      &lt;td&gt;4.211999e+06&lt;/td&gt;
      &lt;td&gt;4.143136e+06&lt;/td&gt;
      &lt;td&gt;4.228377e+06&lt;/td&gt;
      &lt;td&gt;1.652661e+05&lt;/td&gt;
      &lt;td&gt;8.263305e+05&lt;/td&gt;
      &lt;td&gt;4.131652e+06&lt;/td&gt;
      &lt;td&gt;2.065826e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22&lt;/th&gt;
      &lt;td&gt;VNM&lt;/td&gt;
      &lt;td&gt;Viet Nam&lt;/td&gt;
      &lt;td&gt;1.346013e+06&lt;/td&gt;
      &lt;td&gt;1.483777e+06&lt;/td&gt;
      &lt;td&gt;1.406437e+06&lt;/td&gt;
      &lt;td&gt;1.317455e+06&lt;/td&gt;
      &lt;td&gt;1.269751e+06&lt;/td&gt;
      &lt;td&gt;1.374450e+06&lt;/td&gt;
      &lt;td&gt;1.502787e+06&lt;/td&gt;
      &lt;td&gt;3.365033e+07&lt;/td&gt;
      &lt;td&gt;3.709441e+07&lt;/td&gt;
      &lt;td&gt;3.516092e+07&lt;/td&gt;
      &lt;td&gt;3.293637e+07&lt;/td&gt;
      &lt;td&gt;3.174377e+07&lt;/td&gt;
      &lt;td&gt;1.364686e+06&lt;/td&gt;
      &lt;td&gt;6.823432e+06&lt;/td&gt;
      &lt;td&gt;3.411716e+07&lt;/td&gt;
      &lt;td&gt;1.705858e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;23&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Total&lt;/td&gt;
      &lt;td&gt;2.270357e+07&lt;/td&gt;
      &lt;td&gt;2.205208e+07&lt;/td&gt;
      &lt;td&gt;2.237234e+07&lt;/td&gt;
      &lt;td&gt;2.179462e+07&lt;/td&gt;
      &lt;td&gt;2.340491e+07&lt;/td&gt;
      &lt;td&gt;2.485387e+07&lt;/td&gt;
      &lt;td&gt;2.218801e+07&lt;/td&gt;
      &lt;td&gt;5.675891e+08&lt;/td&gt;
      &lt;td&gt;5.513021e+08&lt;/td&gt;
      &lt;td&gt;5.593084e+08&lt;/td&gt;
      &lt;td&gt;5.448654e+08&lt;/td&gt;
      &lt;td&gt;5.851228e+08&lt;/td&gt;
      &lt;td&gt;2.246550e+07&lt;/td&gt;
      &lt;td&gt;1.123275e+08&lt;/td&gt;
      &lt;td&gt;5.616376e+08&lt;/td&gt;
      &lt;td&gt;2.808188e+09&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;24&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;mean&lt;/td&gt;
      &lt;td&gt;9.871116e+05&lt;/td&gt;
      &lt;td&gt;9.587863e+05&lt;/td&gt;
      &lt;td&gt;9.727103e+05&lt;/td&gt;
      &lt;td&gt;9.475920e+05&lt;/td&gt;
      &lt;td&gt;1.017605e+06&lt;/td&gt;
      &lt;td&gt;1.080603e+06&lt;/td&gt;
      &lt;td&gt;9.646959e+05&lt;/td&gt;
      &lt;td&gt;2.467779e+07&lt;/td&gt;
      &lt;td&gt;2.396966e+07&lt;/td&gt;
      &lt;td&gt;2.431776e+07&lt;/td&gt;
      &lt;td&gt;2.368980e+07&lt;/td&gt;
      &lt;td&gt;2.544012e+07&lt;/td&gt;
      &lt;td&gt;9.767610e+05&lt;/td&gt;
      &lt;td&gt;4.883805e+06&lt;/td&gt;
      &lt;td&gt;2.441902e+07&lt;/td&gt;
      &lt;td&gt;1.220951e+08&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;write-data-to-file&#34; &gt;Write Data to File
&lt;span&gt;
    &lt;a href=&#34;#write-data-to-file&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;outfile &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/Users/jnapolitano/Projects/wattime-takehome/wattime-takehome/data/TRACE_DATA.csv&amp;#34;&lt;/span&gt;

malaysia_emissions_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to_csv(outfile)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;university-of-malaysia-plots&#34; &gt;University of Malaysia Plots
&lt;span&gt;
    &lt;a href=&#34;#university-of-malaysia-plots&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;h3 id=&#34;university-of-malaysia-bar-plot&#34; &gt;University of Malaysia Bar Plot
&lt;span&gt;
    &lt;a href=&#34;#university-of-malaysia-bar-plot&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;malaysia_emissions_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;plot(kind &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;barh&amp;#34;&lt;/span&gt;, x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_name&amp;#39;&lt;/span&gt;, xlabel &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Country Name&amp;#34;&lt;/span&gt;, ylabel &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;CH4 Tonnes&amp;#34;&lt;/span&gt;, figsize &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;AxesSubplot:ylabel=&#39;Country Name&#39;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;data_exploration_files/data_exploration_28_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;university-of-malaysia-density-plot&#34; &gt;University of Malaysia Density Plot
&lt;span&gt;
    &lt;a href=&#34;#university-of-malaysia-density-plot&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;malaysia_emissions_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;plot(rot &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, kind &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;density&amp;#34;&lt;/span&gt;, figsize &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#ae81ff&#34;&gt;15&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)) 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;AxesSubplot:ylabel=&#39;Density&#39;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;data_exploration_files/data_exploration_30_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;I did not exclude totals or mean from the dataframe, but as we can see the second hump in the density graph shows the distribution of totals annualy.  Interestingly the 2020 data is shifted further to the right than other years.  This actually questions the validity of the study promoted by the University of malaysia&lt;/p&gt;
&lt;h2 id=&#34;faostat-data&#34; &gt;FAOSTAT Data
&lt;span&gt;
    &lt;a href=&#34;#faostat-data&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;filepath &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/Users/jnapolitano/Projects/wattime-takehome/wattime-takehome/data/emissions_csv_fao_emiss_csv_ch4_fao_2015_2019_tonnes.xlsx&amp;#34;&lt;/span&gt;

faostat_emissions_df &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;read_excel(filepath)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;print-faostat-data&#34; &gt;Print FAOSTAT Data
&lt;span&gt;
    &lt;a href=&#34;#print-faostat-data&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;## I didn&amp;#39;t write the index to the csv file in the previous step.  IF time permits go back and fix this error&lt;/span&gt;
faostat_emissions_df

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div style=&#34;overflow-x:auto;&#34;&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;code&lt;/th&gt;
      &lt;th&gt;country&lt;/th&gt;
      &lt;th&gt;country_fao&lt;/th&gt;
      &lt;th&gt;2015&lt;/th&gt;
      &lt;th&gt;2016&lt;/th&gt;
      &lt;th&gt;2017&lt;/th&gt;
      &lt;th&gt;2018&lt;/th&gt;
      &lt;th&gt;2019&lt;/th&gt;
      &lt;th&gt;2020&lt;/th&gt;
      &lt;th&gt;2021&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;BGD&lt;/td&gt;
      &lt;td&gt;Bangladesh&lt;/td&gt;
      &lt;td&gt;Bangladesh&lt;/td&gt;
      &lt;td&gt;1131293.4&lt;/td&gt;
      &lt;td&gt;1093480.4&lt;/td&gt;
      &lt;td&gt;1154531.0&lt;/td&gt;
      &lt;td&gt;1144591.0&lt;/td&gt;
      &lt;td&gt;1144745.4&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;BRA&lt;/td&gt;
      &lt;td&gt;Brazil&lt;/td&gt;
      &lt;td&gt;Brazil&lt;/td&gt;
      &lt;td&gt;138910.3&lt;/td&gt;
      &lt;td&gt;126278.2&lt;/td&gt;
      &lt;td&gt;130322.9&lt;/td&gt;
      &lt;td&gt;121615.2&lt;/td&gt;
      &lt;td&gt;111084.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;CHN&lt;/td&gt;
      &lt;td&gt;China&lt;/td&gt;
      &lt;td&gt;China, mainland&lt;/td&gt;
      &lt;td&gt;5406593.9&lt;/td&gt;
      &lt;td&gt;5399920.0&lt;/td&gt;
      &lt;td&gt;5400129.0&lt;/td&gt;
      &lt;td&gt;5302173.1&lt;/td&gt;
      &lt;td&gt;5214454.7&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;ESP&lt;/td&gt;
      &lt;td&gt;Spain&lt;/td&gt;
      &lt;td&gt;Spain&lt;/td&gt;
      &lt;td&gt;55082.2&lt;/td&gt;
      &lt;td&gt;55073.1&lt;/td&gt;
      &lt;td&gt;54232.4&lt;/td&gt;
      &lt;td&gt;52925.0&lt;/td&gt;
      &lt;td&gt;52098.5&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;IDN&lt;/td&gt;
      &lt;td&gt;Indonesia&lt;/td&gt;
      &lt;td&gt;Indonesia&lt;/td&gt;
      &lt;td&gt;2407953.5&lt;/td&gt;
      &lt;td&gt;2387656.4&lt;/td&gt;
      &lt;td&gt;2425290.6&lt;/td&gt;
      &lt;td&gt;2405613.8&lt;/td&gt;
      &lt;td&gt;2257604.3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;IND&lt;/td&gt;
      &lt;td&gt;India&lt;/td&gt;
      &lt;td&gt;India&lt;/td&gt;
      &lt;td&gt;4580248.4&lt;/td&gt;
      &lt;td&gt;4559136.4&lt;/td&gt;
      &lt;td&gt;4620790.8&lt;/td&gt;
      &lt;td&gt;4661154.9&lt;/td&gt;
      &lt;td&gt;4621416.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;IRN&lt;/td&gt;
      &lt;td&gt;Iran (Islamic Republic of)&lt;/td&gt;
      &lt;td&gt;Iran (Islamic Republic of)&lt;/td&gt;
      &lt;td&gt;116486.7&lt;/td&gt;
      &lt;td&gt;131008.5&lt;/td&gt;
      &lt;td&gt;87233.6&lt;/td&gt;
      &lt;td&gt;93936.6&lt;/td&gt;
      &lt;td&gt;96103.4&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;ITA&lt;/td&gt;
      &lt;td&gt;Italy&lt;/td&gt;
      &lt;td&gt;Italy&lt;/td&gt;
      &lt;td&gt;114574.8&lt;/td&gt;
      &lt;td&gt;118003.0&lt;/td&gt;
      &lt;td&gt;118003.0&lt;/td&gt;
      &lt;td&gt;109463.8&lt;/td&gt;
      &lt;td&gt;110895.1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;JPN&lt;/td&gt;
      &lt;td&gt;Japan&lt;/td&gt;
      &lt;td&gt;Japan&lt;/td&gt;
      &lt;td&gt;330353.1&lt;/td&gt;
      &lt;td&gt;326403.0&lt;/td&gt;
      &lt;td&gt;323700.3&lt;/td&gt;
      &lt;td&gt;322245.0&lt;/td&gt;
      &lt;td&gt;320581.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;KHM&lt;/td&gt;
      &lt;td&gt;Cambodia&lt;/td&gt;
      &lt;td&gt;Cambodia&lt;/td&gt;
      &lt;td&gt;436826.0&lt;/td&gt;
      &lt;td&gt;459003.1&lt;/td&gt;
      &lt;td&gt;473745.3&lt;/td&gt;
      &lt;td&gt;479362.7&lt;/td&gt;
      &lt;td&gt;468378.9&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;KOR&lt;/td&gt;
      &lt;td&gt;Korea (the Republic of)&lt;/td&gt;
      &lt;td&gt;Republic of Korea&lt;/td&gt;
      &lt;td&gt;167862.2&lt;/td&gt;
      &lt;td&gt;163534.1&lt;/td&gt;
      &lt;td&gt;158489.7&lt;/td&gt;
      &lt;td&gt;154911.3&lt;/td&gt;
      &lt;td&gt;153260.9&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;LAO&lt;/td&gt;
      &lt;td&gt;Lao People&#39;s Democratic Republic (the)&lt;/td&gt;
      &lt;td&gt;Lao People&#39;s Democratic Republic&lt;/td&gt;
      &lt;td&gt;94826.8&lt;/td&gt;
      &lt;td&gt;95630.0&lt;/td&gt;
      &lt;td&gt;93940.7&lt;/td&gt;
      &lt;td&gt;83333.6&lt;/td&gt;
      &lt;td&gt;77005.5&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;LKA&lt;/td&gt;
      &lt;td&gt;Sri Lanka&lt;/td&gt;
      &lt;td&gt;Sri Lanka&lt;/td&gt;
      &lt;td&gt;132640.0&lt;/td&gt;
      &lt;td&gt;121756.3&lt;/td&gt;
      &lt;td&gt;84456.3&lt;/td&gt;
      &lt;td&gt;111049.0&lt;/td&gt;
      &lt;td&gt;102156.3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;MMR&lt;/td&gt;
      &lt;td&gt;Myanmar&lt;/td&gt;
      &lt;td&gt;Myanmar&lt;/td&gt;
      &lt;td&gt;1059409.6&lt;/td&gt;
      &lt;td&gt;1052287.7&lt;/td&gt;
      &lt;td&gt;1087029.5&lt;/td&gt;
      &lt;td&gt;1118850.0&lt;/td&gt;
      &lt;td&gt;1083100.3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;MYS&lt;/td&gt;
      &lt;td&gt;Malaysia&lt;/td&gt;
      &lt;td&gt;Malaysia&lt;/td&gt;
      &lt;td&gt;121942.6&lt;/td&gt;
      &lt;td&gt;123232.8&lt;/td&gt;
      &lt;td&gt;122656.3&lt;/td&gt;
      &lt;td&gt;125238.5&lt;/td&gt;
      &lt;td&gt;122453.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;NPL&lt;/td&gt;
      &lt;td&gt;Nepal&lt;/td&gt;
      &lt;td&gt;Nepal&lt;/td&gt;
      &lt;td&gt;149262.2&lt;/td&gt;
      &lt;td&gt;142723.7&lt;/td&gt;
      &lt;td&gt;162574.6&lt;/td&gt;
      &lt;td&gt;153890.8&lt;/td&gt;
      &lt;td&gt;156215.4&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;PAK&lt;/td&gt;
      &lt;td&gt;Pakistan&lt;/td&gt;
      &lt;td&gt;Pakistan&lt;/td&gt;
      &lt;td&gt;383529.3&lt;/td&gt;
      &lt;td&gt;381361.8&lt;/td&gt;
      &lt;td&gt;406083.3&lt;/td&gt;
      &lt;td&gt;393404.2&lt;/td&gt;
      &lt;td&gt;424755.1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;PHL&lt;/td&gt;
      &lt;td&gt;Philippines (the)&lt;/td&gt;
      &lt;td&gt;Philippines&lt;/td&gt;
      &lt;td&gt;1557810.6&lt;/td&gt;
      &lt;td&gt;1524292.5&lt;/td&gt;
      &lt;td&gt;1609862.5&lt;/td&gt;
      &lt;td&gt;1606047.8&lt;/td&gt;
      &lt;td&gt;1556225.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;PRK&lt;/td&gt;
      &lt;td&gt;Korea (the Democratic People&#39;s Republic of)&lt;/td&gt;
      &lt;td&gt;Democratic People&#39;s Republic of Korea&lt;/td&gt;
      &lt;td&gt;82823.3&lt;/td&gt;
      &lt;td&gt;83442.3&lt;/td&gt;
      &lt;td&gt;84596.2&lt;/td&gt;
      &lt;td&gt;83943.3&lt;/td&gt;
      &lt;td&gt;82937.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;THA&lt;/td&gt;
      &lt;td&gt;Thailand&lt;/td&gt;
      &lt;td&gt;Thailand&lt;/td&gt;
      &lt;td&gt;1554254.0&lt;/td&gt;
      &lt;td&gt;1703327.7&lt;/td&gt;
      &lt;td&gt;1714465.6&lt;/td&gt;
      &lt;td&gt;1702989.1&lt;/td&gt;
      &lt;td&gt;1553835.5&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;20&lt;/th&gt;
      &lt;td&gt;TWN&lt;/td&gt;
      &lt;td&gt;Taiwan (Province of China)&lt;/td&gt;
      &lt;td&gt;China, Taiwan Province of&lt;/td&gt;
      &lt;td&gt;45838.7&lt;/td&gt;
      &lt;td&gt;49838.3&lt;/td&gt;
      &lt;td&gt;49991.2&lt;/td&gt;
      &lt;td&gt;49414.1&lt;/td&gt;
      &lt;td&gt;49152.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;21&lt;/th&gt;
      &lt;td&gt;USA&lt;/td&gt;
      &lt;td&gt;United States of America (the)&lt;/td&gt;
      &lt;td&gt;United States of America&lt;/td&gt;
      &lt;td&gt;364728.0&lt;/td&gt;
      &lt;td&gt;438662.0&lt;/td&gt;
      &lt;td&gt;336255.5&lt;/td&gt;
      &lt;td&gt;412177.5&lt;/td&gt;
      &lt;td&gt;350136.5&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22&lt;/th&gt;
      &lt;td&gt;VNM&lt;/td&gt;
      &lt;td&gt;Viet Nam&lt;/td&gt;
      &lt;td&gt;Viet Nam&lt;/td&gt;
      &lt;td&gt;1381744.4&lt;/td&gt;
      &lt;td&gt;1365173.8&lt;/td&gt;
      &lt;td&gt;1360551.6&lt;/td&gt;
      &lt;td&gt;1336231.2&lt;/td&gt;
      &lt;td&gt;1318431.1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;23&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Total&lt;/td&gt;
      &lt;td&gt;23829994.0&lt;/td&gt;
      &lt;td&gt;23917225.1&lt;/td&gt;
      &lt;td&gt;24075931.9&lt;/td&gt;
      &lt;td&gt;24042561.5&lt;/td&gt;
      &lt;td&gt;23446028.9&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;change-code-to-iso3_country&#34; &gt;Change code to iso3_country
&lt;span&gt;
    &lt;a href=&#34;#change-code-to-iso3_country&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;
faostat_emissions_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;rename(columns&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;{&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;code&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;iso3_country&amp;#34;&lt;/span&gt;}, inplace &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
faostat_emissions_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;rename(columns&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;{&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;country&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;country_name&amp;#34;&lt;/span&gt;}, inplace &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
&lt;span style=&#34;color:#75715e&#34;&gt;# The column title is not a string.  It is understood as an int or a datetime.  &lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#faostat_emissions_df[&amp;#39;2015&amp;#39;]&lt;/span&gt;
faostat_emissions_df
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div style=&#34;overflow-x:auto;&#34;&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;iso3_country&lt;/th&gt;
      &lt;th&gt;country_name&lt;/th&gt;
      &lt;th&gt;country_fao&lt;/th&gt;
      &lt;th&gt;2015&lt;/th&gt;
      &lt;th&gt;2016&lt;/th&gt;
      &lt;th&gt;2017&lt;/th&gt;
      &lt;th&gt;2018&lt;/th&gt;
      &lt;th&gt;2019&lt;/th&gt;
      &lt;th&gt;2020&lt;/th&gt;
      &lt;th&gt;2021&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;BGD&lt;/td&gt;
      &lt;td&gt;Bangladesh&lt;/td&gt;
      &lt;td&gt;Bangladesh&lt;/td&gt;
      &lt;td&gt;1131293.4&lt;/td&gt;
      &lt;td&gt;1093480.4&lt;/td&gt;
      &lt;td&gt;1154531.0&lt;/td&gt;
      &lt;td&gt;1144591.0&lt;/td&gt;
      &lt;td&gt;1144745.4&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;BRA&lt;/td&gt;
      &lt;td&gt;Brazil&lt;/td&gt;
      &lt;td&gt;Brazil&lt;/td&gt;
      &lt;td&gt;138910.3&lt;/td&gt;
      &lt;td&gt;126278.2&lt;/td&gt;
      &lt;td&gt;130322.9&lt;/td&gt;
      &lt;td&gt;121615.2&lt;/td&gt;
      &lt;td&gt;111084.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;CHN&lt;/td&gt;
      &lt;td&gt;China&lt;/td&gt;
      &lt;td&gt;China, mainland&lt;/td&gt;
      &lt;td&gt;5406593.9&lt;/td&gt;
      &lt;td&gt;5399920.0&lt;/td&gt;
      &lt;td&gt;5400129.0&lt;/td&gt;
      &lt;td&gt;5302173.1&lt;/td&gt;
      &lt;td&gt;5214454.7&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;ESP&lt;/td&gt;
      &lt;td&gt;Spain&lt;/td&gt;
      &lt;td&gt;Spain&lt;/td&gt;
      &lt;td&gt;55082.2&lt;/td&gt;
      &lt;td&gt;55073.1&lt;/td&gt;
      &lt;td&gt;54232.4&lt;/td&gt;
      &lt;td&gt;52925.0&lt;/td&gt;
      &lt;td&gt;52098.5&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;IDN&lt;/td&gt;
      &lt;td&gt;Indonesia&lt;/td&gt;
      &lt;td&gt;Indonesia&lt;/td&gt;
      &lt;td&gt;2407953.5&lt;/td&gt;
      &lt;td&gt;2387656.4&lt;/td&gt;
      &lt;td&gt;2425290.6&lt;/td&gt;
      &lt;td&gt;2405613.8&lt;/td&gt;
      &lt;td&gt;2257604.3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;IND&lt;/td&gt;
      &lt;td&gt;India&lt;/td&gt;
      &lt;td&gt;India&lt;/td&gt;
      &lt;td&gt;4580248.4&lt;/td&gt;
      &lt;td&gt;4559136.4&lt;/td&gt;
      &lt;td&gt;4620790.8&lt;/td&gt;
      &lt;td&gt;4661154.9&lt;/td&gt;
      &lt;td&gt;4621416.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;IRN&lt;/td&gt;
      &lt;td&gt;Iran (Islamic Republic of)&lt;/td&gt;
      &lt;td&gt;Iran (Islamic Republic of)&lt;/td&gt;
      &lt;td&gt;116486.7&lt;/td&gt;
      &lt;td&gt;131008.5&lt;/td&gt;
      &lt;td&gt;87233.6&lt;/td&gt;
      &lt;td&gt;93936.6&lt;/td&gt;
      &lt;td&gt;96103.4&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;ITA&lt;/td&gt;
      &lt;td&gt;Italy&lt;/td&gt;
      &lt;td&gt;Italy&lt;/td&gt;
      &lt;td&gt;114574.8&lt;/td&gt;
      &lt;td&gt;118003.0&lt;/td&gt;
      &lt;td&gt;118003.0&lt;/td&gt;
      &lt;td&gt;109463.8&lt;/td&gt;
      &lt;td&gt;110895.1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;JPN&lt;/td&gt;
      &lt;td&gt;Japan&lt;/td&gt;
      &lt;td&gt;Japan&lt;/td&gt;
      &lt;td&gt;330353.1&lt;/td&gt;
      &lt;td&gt;326403.0&lt;/td&gt;
      &lt;td&gt;323700.3&lt;/td&gt;
      &lt;td&gt;322245.0&lt;/td&gt;
      &lt;td&gt;320581.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;KHM&lt;/td&gt;
      &lt;td&gt;Cambodia&lt;/td&gt;
      &lt;td&gt;Cambodia&lt;/td&gt;
      &lt;td&gt;436826.0&lt;/td&gt;
      &lt;td&gt;459003.1&lt;/td&gt;
      &lt;td&gt;473745.3&lt;/td&gt;
      &lt;td&gt;479362.7&lt;/td&gt;
      &lt;td&gt;468378.9&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;KOR&lt;/td&gt;
      &lt;td&gt;Korea (the Republic of)&lt;/td&gt;
      &lt;td&gt;Republic of Korea&lt;/td&gt;
      &lt;td&gt;167862.2&lt;/td&gt;
      &lt;td&gt;163534.1&lt;/td&gt;
      &lt;td&gt;158489.7&lt;/td&gt;
      &lt;td&gt;154911.3&lt;/td&gt;
      &lt;td&gt;153260.9&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;LAO&lt;/td&gt;
      &lt;td&gt;Lao People&#39;s Democratic Republic (the)&lt;/td&gt;
      &lt;td&gt;Lao People&#39;s Democratic Republic&lt;/td&gt;
      &lt;td&gt;94826.8&lt;/td&gt;
      &lt;td&gt;95630.0&lt;/td&gt;
      &lt;td&gt;93940.7&lt;/td&gt;
      &lt;td&gt;83333.6&lt;/td&gt;
      &lt;td&gt;77005.5&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;LKA&lt;/td&gt;
      &lt;td&gt;Sri Lanka&lt;/td&gt;
      &lt;td&gt;Sri Lanka&lt;/td&gt;
      &lt;td&gt;132640.0&lt;/td&gt;
      &lt;td&gt;121756.3&lt;/td&gt;
      &lt;td&gt;84456.3&lt;/td&gt;
      &lt;td&gt;111049.0&lt;/td&gt;
      &lt;td&gt;102156.3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;MMR&lt;/td&gt;
      &lt;td&gt;Myanmar&lt;/td&gt;
      &lt;td&gt;Myanmar&lt;/td&gt;
      &lt;td&gt;1059409.6&lt;/td&gt;
      &lt;td&gt;1052287.7&lt;/td&gt;
      &lt;td&gt;1087029.5&lt;/td&gt;
      &lt;td&gt;1118850.0&lt;/td&gt;
      &lt;td&gt;1083100.3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;MYS&lt;/td&gt;
      &lt;td&gt;Malaysia&lt;/td&gt;
      &lt;td&gt;Malaysia&lt;/td&gt;
      &lt;td&gt;121942.6&lt;/td&gt;
      &lt;td&gt;123232.8&lt;/td&gt;
      &lt;td&gt;122656.3&lt;/td&gt;
      &lt;td&gt;125238.5&lt;/td&gt;
      &lt;td&gt;122453.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;NPL&lt;/td&gt;
      &lt;td&gt;Nepal&lt;/td&gt;
      &lt;td&gt;Nepal&lt;/td&gt;
      &lt;td&gt;149262.2&lt;/td&gt;
      &lt;td&gt;142723.7&lt;/td&gt;
      &lt;td&gt;162574.6&lt;/td&gt;
      &lt;td&gt;153890.8&lt;/td&gt;
      &lt;td&gt;156215.4&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;PAK&lt;/td&gt;
      &lt;td&gt;Pakistan&lt;/td&gt;
      &lt;td&gt;Pakistan&lt;/td&gt;
      &lt;td&gt;383529.3&lt;/td&gt;
      &lt;td&gt;381361.8&lt;/td&gt;
      &lt;td&gt;406083.3&lt;/td&gt;
      &lt;td&gt;393404.2&lt;/td&gt;
      &lt;td&gt;424755.1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;PHL&lt;/td&gt;
      &lt;td&gt;Philippines (the)&lt;/td&gt;
      &lt;td&gt;Philippines&lt;/td&gt;
      &lt;td&gt;1557810.6&lt;/td&gt;
      &lt;td&gt;1524292.5&lt;/td&gt;
      &lt;td&gt;1609862.5&lt;/td&gt;
      &lt;td&gt;1606047.8&lt;/td&gt;
      &lt;td&gt;1556225.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;PRK&lt;/td&gt;
      &lt;td&gt;Korea (the Democratic People&#39;s Republic of)&lt;/td&gt;
      &lt;td&gt;Democratic People&#39;s Republic of Korea&lt;/td&gt;
      &lt;td&gt;82823.3&lt;/td&gt;
      &lt;td&gt;83442.3&lt;/td&gt;
      &lt;td&gt;84596.2&lt;/td&gt;
      &lt;td&gt;83943.3&lt;/td&gt;
      &lt;td&gt;82937.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;THA&lt;/td&gt;
      &lt;td&gt;Thailand&lt;/td&gt;
      &lt;td&gt;Thailand&lt;/td&gt;
      &lt;td&gt;1554254.0&lt;/td&gt;
      &lt;td&gt;1703327.7&lt;/td&gt;
      &lt;td&gt;1714465.6&lt;/td&gt;
      &lt;td&gt;1702989.1&lt;/td&gt;
      &lt;td&gt;1553835.5&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;20&lt;/th&gt;
      &lt;td&gt;TWN&lt;/td&gt;
      &lt;td&gt;Taiwan (Province of China)&lt;/td&gt;
      &lt;td&gt;China, Taiwan Province of&lt;/td&gt;
      &lt;td&gt;45838.7&lt;/td&gt;
      &lt;td&gt;49838.3&lt;/td&gt;
      &lt;td&gt;49991.2&lt;/td&gt;
      &lt;td&gt;49414.1&lt;/td&gt;
      &lt;td&gt;49152.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;21&lt;/th&gt;
      &lt;td&gt;USA&lt;/td&gt;
      &lt;td&gt;United States of America (the)&lt;/td&gt;
      &lt;td&gt;United States of America&lt;/td&gt;
      &lt;td&gt;364728.0&lt;/td&gt;
      &lt;td&gt;438662.0&lt;/td&gt;
      &lt;td&gt;336255.5&lt;/td&gt;
      &lt;td&gt;412177.5&lt;/td&gt;
      &lt;td&gt;350136.5&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22&lt;/th&gt;
      &lt;td&gt;VNM&lt;/td&gt;
      &lt;td&gt;Viet Nam&lt;/td&gt;
      &lt;td&gt;Viet Nam&lt;/td&gt;
      &lt;td&gt;1381744.4&lt;/td&gt;
      &lt;td&gt;1365173.8&lt;/td&gt;
      &lt;td&gt;1360551.6&lt;/td&gt;
      &lt;td&gt;1336231.2&lt;/td&gt;
      &lt;td&gt;1318431.1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;23&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Total&lt;/td&gt;
      &lt;td&gt;23829994.0&lt;/td&gt;
      &lt;td&gt;23917225.1&lt;/td&gt;
      &lt;td&gt;24075931.9&lt;/td&gt;
      &lt;td&gt;24042561.5&lt;/td&gt;
      &lt;td&gt;23446028.9&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;set-country_name-total-to-total&#34; &gt;Set country_name total to total
&lt;span&gt;
    &lt;a href=&#34;#set-country_name-total-to-total&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;faostat_emissions_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;at[&lt;span style=&#34;color:#ae81ff&#34;&gt;23&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_name&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;drop-fao-country-code&#34; &gt;Drop Fao Country Code
&lt;span&gt;
    &lt;a href=&#34;#drop-fao-country-code&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;faostat_emissions_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;drop(labels &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_fao&amp;#39;&lt;/span&gt;], axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, inplace&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
faostat_emissions_df
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div style=&#34;overflow-x:auto;&#34;&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;iso3_country&lt;/th&gt;
      &lt;th&gt;country_name&lt;/th&gt;
      &lt;th&gt;2015&lt;/th&gt;
      &lt;th&gt;2016&lt;/th&gt;
      &lt;th&gt;2017&lt;/th&gt;
      &lt;th&gt;2018&lt;/th&gt;
      &lt;th&gt;2019&lt;/th&gt;
      &lt;th&gt;2020&lt;/th&gt;
      &lt;th&gt;2021&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;BGD&lt;/td&gt;
      &lt;td&gt;Bangladesh&lt;/td&gt;
      &lt;td&gt;1131293.4&lt;/td&gt;
      &lt;td&gt;1093480.4&lt;/td&gt;
      &lt;td&gt;1154531.0&lt;/td&gt;
      &lt;td&gt;1144591.0&lt;/td&gt;
      &lt;td&gt;1144745.4&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;BRA&lt;/td&gt;
      &lt;td&gt;Brazil&lt;/td&gt;
      &lt;td&gt;138910.3&lt;/td&gt;
      &lt;td&gt;126278.2&lt;/td&gt;
      &lt;td&gt;130322.9&lt;/td&gt;
      &lt;td&gt;121615.2&lt;/td&gt;
      &lt;td&gt;111084.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;CHN&lt;/td&gt;
      &lt;td&gt;China&lt;/td&gt;
      &lt;td&gt;5406593.9&lt;/td&gt;
      &lt;td&gt;5399920.0&lt;/td&gt;
      &lt;td&gt;5400129.0&lt;/td&gt;
      &lt;td&gt;5302173.1&lt;/td&gt;
      &lt;td&gt;5214454.7&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;ESP&lt;/td&gt;
      &lt;td&gt;Spain&lt;/td&gt;
      &lt;td&gt;55082.2&lt;/td&gt;
      &lt;td&gt;55073.1&lt;/td&gt;
      &lt;td&gt;54232.4&lt;/td&gt;
      &lt;td&gt;52925.0&lt;/td&gt;
      &lt;td&gt;52098.5&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;IDN&lt;/td&gt;
      &lt;td&gt;Indonesia&lt;/td&gt;
      &lt;td&gt;2407953.5&lt;/td&gt;
      &lt;td&gt;2387656.4&lt;/td&gt;
      &lt;td&gt;2425290.6&lt;/td&gt;
      &lt;td&gt;2405613.8&lt;/td&gt;
      &lt;td&gt;2257604.3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;IND&lt;/td&gt;
      &lt;td&gt;India&lt;/td&gt;
      &lt;td&gt;4580248.4&lt;/td&gt;
      &lt;td&gt;4559136.4&lt;/td&gt;
      &lt;td&gt;4620790.8&lt;/td&gt;
      &lt;td&gt;4661154.9&lt;/td&gt;
      &lt;td&gt;4621416.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;IRN&lt;/td&gt;
      &lt;td&gt;Iran (Islamic Republic of)&lt;/td&gt;
      &lt;td&gt;116486.7&lt;/td&gt;
      &lt;td&gt;131008.5&lt;/td&gt;
      &lt;td&gt;87233.6&lt;/td&gt;
      &lt;td&gt;93936.6&lt;/td&gt;
      &lt;td&gt;96103.4&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;ITA&lt;/td&gt;
      &lt;td&gt;Italy&lt;/td&gt;
      &lt;td&gt;114574.8&lt;/td&gt;
      &lt;td&gt;118003.0&lt;/td&gt;
      &lt;td&gt;118003.0&lt;/td&gt;
      &lt;td&gt;109463.8&lt;/td&gt;
      &lt;td&gt;110895.1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;JPN&lt;/td&gt;
      &lt;td&gt;Japan&lt;/td&gt;
      &lt;td&gt;330353.1&lt;/td&gt;
      &lt;td&gt;326403.0&lt;/td&gt;
      &lt;td&gt;323700.3&lt;/td&gt;
      &lt;td&gt;322245.0&lt;/td&gt;
      &lt;td&gt;320581.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;KHM&lt;/td&gt;
      &lt;td&gt;Cambodia&lt;/td&gt;
      &lt;td&gt;436826.0&lt;/td&gt;
      &lt;td&gt;459003.1&lt;/td&gt;
      &lt;td&gt;473745.3&lt;/td&gt;
      &lt;td&gt;479362.7&lt;/td&gt;
      &lt;td&gt;468378.9&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;KOR&lt;/td&gt;
      &lt;td&gt;Korea (the Republic of)&lt;/td&gt;
      &lt;td&gt;167862.2&lt;/td&gt;
      &lt;td&gt;163534.1&lt;/td&gt;
      &lt;td&gt;158489.7&lt;/td&gt;
      &lt;td&gt;154911.3&lt;/td&gt;
      &lt;td&gt;153260.9&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;LAO&lt;/td&gt;
      &lt;td&gt;Lao People&#39;s Democratic Republic (the)&lt;/td&gt;
      &lt;td&gt;94826.8&lt;/td&gt;
      &lt;td&gt;95630.0&lt;/td&gt;
      &lt;td&gt;93940.7&lt;/td&gt;
      &lt;td&gt;83333.6&lt;/td&gt;
      &lt;td&gt;77005.5&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;LKA&lt;/td&gt;
      &lt;td&gt;Sri Lanka&lt;/td&gt;
      &lt;td&gt;132640.0&lt;/td&gt;
      &lt;td&gt;121756.3&lt;/td&gt;
      &lt;td&gt;84456.3&lt;/td&gt;
      &lt;td&gt;111049.0&lt;/td&gt;
      &lt;td&gt;102156.3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;MMR&lt;/td&gt;
      &lt;td&gt;Myanmar&lt;/td&gt;
      &lt;td&gt;1059409.6&lt;/td&gt;
      &lt;td&gt;1052287.7&lt;/td&gt;
      &lt;td&gt;1087029.5&lt;/td&gt;
      &lt;td&gt;1118850.0&lt;/td&gt;
      &lt;td&gt;1083100.3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;MYS&lt;/td&gt;
      &lt;td&gt;Malaysia&lt;/td&gt;
      &lt;td&gt;121942.6&lt;/td&gt;
      &lt;td&gt;123232.8&lt;/td&gt;
      &lt;td&gt;122656.3&lt;/td&gt;
      &lt;td&gt;125238.5&lt;/td&gt;
      &lt;td&gt;122453.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;NPL&lt;/td&gt;
      &lt;td&gt;Nepal&lt;/td&gt;
      &lt;td&gt;149262.2&lt;/td&gt;
      &lt;td&gt;142723.7&lt;/td&gt;
      &lt;td&gt;162574.6&lt;/td&gt;
      &lt;td&gt;153890.8&lt;/td&gt;
      &lt;td&gt;156215.4&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;PAK&lt;/td&gt;
      &lt;td&gt;Pakistan&lt;/td&gt;
      &lt;td&gt;383529.3&lt;/td&gt;
      &lt;td&gt;381361.8&lt;/td&gt;
      &lt;td&gt;406083.3&lt;/td&gt;
      &lt;td&gt;393404.2&lt;/td&gt;
      &lt;td&gt;424755.1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;PHL&lt;/td&gt;
      &lt;td&gt;Philippines (the)&lt;/td&gt;
      &lt;td&gt;1557810.6&lt;/td&gt;
      &lt;td&gt;1524292.5&lt;/td&gt;
      &lt;td&gt;1609862.5&lt;/td&gt;
      &lt;td&gt;1606047.8&lt;/td&gt;
      &lt;td&gt;1556225.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;PRK&lt;/td&gt;
      &lt;td&gt;Korea (the Democratic People&#39;s Republic of)&lt;/td&gt;
      &lt;td&gt;82823.3&lt;/td&gt;
      &lt;td&gt;83442.3&lt;/td&gt;
      &lt;td&gt;84596.2&lt;/td&gt;
      &lt;td&gt;83943.3&lt;/td&gt;
      &lt;td&gt;82937.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;THA&lt;/td&gt;
      &lt;td&gt;Thailand&lt;/td&gt;
      &lt;td&gt;1554254.0&lt;/td&gt;
      &lt;td&gt;1703327.7&lt;/td&gt;
      &lt;td&gt;1714465.6&lt;/td&gt;
      &lt;td&gt;1702989.1&lt;/td&gt;
      &lt;td&gt;1553835.5&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;20&lt;/th&gt;
      &lt;td&gt;TWN&lt;/td&gt;
      &lt;td&gt;Taiwan (Province of China)&lt;/td&gt;
      &lt;td&gt;45838.7&lt;/td&gt;
      &lt;td&gt;49838.3&lt;/td&gt;
      &lt;td&gt;49991.2&lt;/td&gt;
      &lt;td&gt;49414.1&lt;/td&gt;
      &lt;td&gt;49152.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;21&lt;/th&gt;
      &lt;td&gt;USA&lt;/td&gt;
      &lt;td&gt;United States of America (the)&lt;/td&gt;
      &lt;td&gt;364728.0&lt;/td&gt;
      &lt;td&gt;438662.0&lt;/td&gt;
      &lt;td&gt;336255.5&lt;/td&gt;
      &lt;td&gt;412177.5&lt;/td&gt;
      &lt;td&gt;350136.5&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22&lt;/th&gt;
      &lt;td&gt;VNM&lt;/td&gt;
      &lt;td&gt;Viet Nam&lt;/td&gt;
      &lt;td&gt;1381744.4&lt;/td&gt;
      &lt;td&gt;1365173.8&lt;/td&gt;
      &lt;td&gt;1360551.6&lt;/td&gt;
      &lt;td&gt;1336231.2&lt;/td&gt;
      &lt;td&gt;1318431.1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;23&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Total&lt;/td&gt;
      &lt;td&gt;23829994.0&lt;/td&gt;
      &lt;td&gt;23917225.1&lt;/td&gt;
      &lt;td&gt;24075931.9&lt;/td&gt;
      &lt;td&gt;24042561.5&lt;/td&gt;
      &lt;td&gt;23446028.9&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;calculate-co2-equivalency-1&#34; &gt;Calculate Co2 Equivalency
&lt;span&gt;
    &lt;a href=&#34;#calculate-co2-equivalency-1&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;faostat_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2015&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; faostat_emissions_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2015&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt;
faostat_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2016&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; faostat_emissions_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2016&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt;
faostat_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2017&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; faostat_emissions_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2017&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt;
faostat_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2018&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; faostat_emissions_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2018&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt;
faostat_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2019&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; faostat_emissions_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;calculate-means-1&#34; &gt;Calculate Means
&lt;span&gt;
    &lt;a href=&#34;#calculate-means-1&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;faostat_emissions_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;loc[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; faostat_emissions_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;loc[(faostat_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_name&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Total&amp;#34;&lt;/span&gt;)]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;select_dtypes(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;number)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean()
faostat_emissions_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;at[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_name&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;
faostat_emissions_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;reset_index(inplace&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, drop&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
&lt;span style=&#34;color:#75715e&#34;&gt;#faostat_emissions_df.at[&amp;#39;mean&amp;#39;,&amp;#39;country_fao&amp;#39;] = &amp;#39;mean&amp;#39;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;calculate-means-and-totals-across-rows-1&#34; &gt;Calculate Means and Totals Across Rows
&lt;span&gt;
    &lt;a href=&#34;#calculate-means-and-totals-across-rows-1&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;mean_series &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; faostat_emissions_df[[&lt;span style=&#34;color:#ae81ff&#34;&gt;2015&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2016&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2017&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2018&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt;]]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;select_dtypes(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;number)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean(axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
total_series &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; faostat_emissions_df[[&lt;span style=&#34;color:#ae81ff&#34;&gt;2015&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2016&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2017&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2018&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt;]]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;select_dtypes(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;number)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sum(axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
faostat_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Mean_CH4&amp;#34;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; mean_series
faostat_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total_CH4&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; total_series 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;## the select np.number is uncecessary, but i&amp;#39;m including anyways as it doesnt really hurt but for a small calculation penalty&lt;/span&gt;
mean_series &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; faostat_emissions_df[[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2015&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2016&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2017&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2018&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2019&amp;#39;&lt;/span&gt;]]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;select_dtypes(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;number)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean(axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
total_series &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; faostat_emissions_df[[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2015&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2016&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2017&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2018&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2019&amp;#39;&lt;/span&gt;]]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;select_dtypes(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;number)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sum(axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
faostat_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Mean_CO2&amp;#34;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; mean_series
faostat_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total_CO2&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; total_series 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;faostat_emissions_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;reset_index(inplace&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, drop&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;faostat_emissions_df
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div style=&#34;overflow-x:auto;&#34;&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;iso3_country&lt;/th&gt;
      &lt;th&gt;country_name&lt;/th&gt;
      &lt;th&gt;2015&lt;/th&gt;
      &lt;th&gt;2016&lt;/th&gt;
      &lt;th&gt;2017&lt;/th&gt;
      &lt;th&gt;2018&lt;/th&gt;
      &lt;th&gt;2019&lt;/th&gt;
      &lt;th&gt;2020&lt;/th&gt;
      &lt;th&gt;2021&lt;/th&gt;
      &lt;th&gt;tCO2_2015&lt;/th&gt;
      &lt;th&gt;tCO2_2016&lt;/th&gt;
      &lt;th&gt;tCO2_2017&lt;/th&gt;
      &lt;th&gt;tCO2_2018&lt;/th&gt;
      &lt;th&gt;tCO2_2019&lt;/th&gt;
      &lt;th&gt;Mean_CH4&lt;/th&gt;
      &lt;th&gt;Total_CH4&lt;/th&gt;
      &lt;th&gt;Mean_CO2&lt;/th&gt;
      &lt;th&gt;Total_CO2&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;BGD&lt;/td&gt;
      &lt;td&gt;Bangladesh&lt;/td&gt;
      &lt;td&gt;1131293.4&lt;/td&gt;
      &lt;td&gt;1.093480e+06&lt;/td&gt;
      &lt;td&gt;1.154531e+06&lt;/td&gt;
      &lt;td&gt;1.144591e+06&lt;/td&gt;
      &lt;td&gt;1.144745e+06&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;28282335.0&lt;/td&gt;
      &lt;td&gt;2.733701e+07&lt;/td&gt;
      &lt;td&gt;2.886328e+07&lt;/td&gt;
      &lt;td&gt;2.861478e+07&lt;/td&gt;
      &lt;td&gt;2.861863e+07&lt;/td&gt;
      &lt;td&gt;1.133728e+06&lt;/td&gt;
      &lt;td&gt;5.668641e+06&lt;/td&gt;
      &lt;td&gt;2.834321e+07&lt;/td&gt;
      &lt;td&gt;1.417160e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;BRA&lt;/td&gt;
      &lt;td&gt;Brazil&lt;/td&gt;
      &lt;td&gt;138910.3&lt;/td&gt;
      &lt;td&gt;1.262782e+05&lt;/td&gt;
      &lt;td&gt;1.303229e+05&lt;/td&gt;
      &lt;td&gt;1.216152e+05&lt;/td&gt;
      &lt;td&gt;1.110848e+05&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;3472757.5&lt;/td&gt;
      &lt;td&gt;3.156955e+06&lt;/td&gt;
      &lt;td&gt;3.258072e+06&lt;/td&gt;
      &lt;td&gt;3.040380e+06&lt;/td&gt;
      &lt;td&gt;2.777120e+06&lt;/td&gt;
      &lt;td&gt;1.256423e+05&lt;/td&gt;
      &lt;td&gt;6.282114e+05&lt;/td&gt;
      &lt;td&gt;3.141057e+06&lt;/td&gt;
      &lt;td&gt;1.570528e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;CHN&lt;/td&gt;
      &lt;td&gt;China&lt;/td&gt;
      &lt;td&gt;5406593.9&lt;/td&gt;
      &lt;td&gt;5.399920e+06&lt;/td&gt;
      &lt;td&gt;5.400129e+06&lt;/td&gt;
      &lt;td&gt;5.302173e+06&lt;/td&gt;
      &lt;td&gt;5.214455e+06&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;135164847.5&lt;/td&gt;
      &lt;td&gt;1.349980e+08&lt;/td&gt;
      &lt;td&gt;1.350032e+08&lt;/td&gt;
      &lt;td&gt;1.325543e+08&lt;/td&gt;
      &lt;td&gt;1.303614e+08&lt;/td&gt;
      &lt;td&gt;5.344654e+06&lt;/td&gt;
      &lt;td&gt;2.672327e+07&lt;/td&gt;
      &lt;td&gt;1.336164e+08&lt;/td&gt;
      &lt;td&gt;6.680818e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;ESP&lt;/td&gt;
      &lt;td&gt;Spain&lt;/td&gt;
      &lt;td&gt;55082.2&lt;/td&gt;
      &lt;td&gt;5.507310e+04&lt;/td&gt;
      &lt;td&gt;5.423240e+04&lt;/td&gt;
      &lt;td&gt;5.292500e+04&lt;/td&gt;
      &lt;td&gt;5.209850e+04&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1377055.0&lt;/td&gt;
      &lt;td&gt;1.376828e+06&lt;/td&gt;
      &lt;td&gt;1.355810e+06&lt;/td&gt;
      &lt;td&gt;1.323125e+06&lt;/td&gt;
      &lt;td&gt;1.302462e+06&lt;/td&gt;
      &lt;td&gt;5.388224e+04&lt;/td&gt;
      &lt;td&gt;2.694112e+05&lt;/td&gt;
      &lt;td&gt;1.347056e+06&lt;/td&gt;
      &lt;td&gt;6.735280e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;IDN&lt;/td&gt;
      &lt;td&gt;Indonesia&lt;/td&gt;
      &lt;td&gt;2407953.5&lt;/td&gt;
      &lt;td&gt;2.387656e+06&lt;/td&gt;
      &lt;td&gt;2.425291e+06&lt;/td&gt;
      &lt;td&gt;2.405614e+06&lt;/td&gt;
      &lt;td&gt;2.257604e+06&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;60198837.5&lt;/td&gt;
      &lt;td&gt;5.969141e+07&lt;/td&gt;
      &lt;td&gt;6.063226e+07&lt;/td&gt;
      &lt;td&gt;6.014035e+07&lt;/td&gt;
      &lt;td&gt;5.644011e+07&lt;/td&gt;
      &lt;td&gt;2.376824e+06&lt;/td&gt;
      &lt;td&gt;1.188412e+07&lt;/td&gt;
      &lt;td&gt;5.942059e+07&lt;/td&gt;
      &lt;td&gt;2.971030e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;IND&lt;/td&gt;
      &lt;td&gt;India&lt;/td&gt;
      &lt;td&gt;4580248.4&lt;/td&gt;
      &lt;td&gt;4.559136e+06&lt;/td&gt;
      &lt;td&gt;4.620791e+06&lt;/td&gt;
      &lt;td&gt;4.661155e+06&lt;/td&gt;
      &lt;td&gt;4.621417e+06&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;114506210.0&lt;/td&gt;
      &lt;td&gt;1.139784e+08&lt;/td&gt;
      &lt;td&gt;1.155198e+08&lt;/td&gt;
      &lt;td&gt;1.165289e+08&lt;/td&gt;
      &lt;td&gt;1.155354e+08&lt;/td&gt;
      &lt;td&gt;4.608549e+06&lt;/td&gt;
      &lt;td&gt;2.304275e+07&lt;/td&gt;
      &lt;td&gt;1.152137e+08&lt;/td&gt;
      &lt;td&gt;5.760687e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;IRN&lt;/td&gt;
      &lt;td&gt;Iran (Islamic Republic of)&lt;/td&gt;
      &lt;td&gt;116486.7&lt;/td&gt;
      &lt;td&gt;1.310085e+05&lt;/td&gt;
      &lt;td&gt;8.723360e+04&lt;/td&gt;
      &lt;td&gt;9.393660e+04&lt;/td&gt;
      &lt;td&gt;9.610340e+04&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;2912167.5&lt;/td&gt;
      &lt;td&gt;3.275212e+06&lt;/td&gt;
      &lt;td&gt;2.180840e+06&lt;/td&gt;
      &lt;td&gt;2.348415e+06&lt;/td&gt;
      &lt;td&gt;2.402585e+06&lt;/td&gt;
      &lt;td&gt;1.049538e+05&lt;/td&gt;
      &lt;td&gt;5.247688e+05&lt;/td&gt;
      &lt;td&gt;2.623844e+06&lt;/td&gt;
      &lt;td&gt;1.311922e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;ITA&lt;/td&gt;
      &lt;td&gt;Italy&lt;/td&gt;
      &lt;td&gt;114574.8&lt;/td&gt;
      &lt;td&gt;1.180030e+05&lt;/td&gt;
      &lt;td&gt;1.180030e+05&lt;/td&gt;
      &lt;td&gt;1.094638e+05&lt;/td&gt;
      &lt;td&gt;1.108951e+05&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;2864370.0&lt;/td&gt;
      &lt;td&gt;2.950075e+06&lt;/td&gt;
      &lt;td&gt;2.950075e+06&lt;/td&gt;
      &lt;td&gt;2.736595e+06&lt;/td&gt;
      &lt;td&gt;2.772378e+06&lt;/td&gt;
      &lt;td&gt;1.141879e+05&lt;/td&gt;
      &lt;td&gt;5.709397e+05&lt;/td&gt;
      &lt;td&gt;2.854698e+06&lt;/td&gt;
      &lt;td&gt;1.427349e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;JPN&lt;/td&gt;
      &lt;td&gt;Japan&lt;/td&gt;
      &lt;td&gt;330353.1&lt;/td&gt;
      &lt;td&gt;3.264030e+05&lt;/td&gt;
      &lt;td&gt;3.237003e+05&lt;/td&gt;
      &lt;td&gt;3.222450e+05&lt;/td&gt;
      &lt;td&gt;3.205818e+05&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;8258827.5&lt;/td&gt;
      &lt;td&gt;8.160075e+06&lt;/td&gt;
      &lt;td&gt;8.092508e+06&lt;/td&gt;
      &lt;td&gt;8.056125e+06&lt;/td&gt;
      &lt;td&gt;8.014545e+06&lt;/td&gt;
      &lt;td&gt;3.246566e+05&lt;/td&gt;
      &lt;td&gt;1.623283e+06&lt;/td&gt;
      &lt;td&gt;8.116416e+06&lt;/td&gt;
      &lt;td&gt;4.058208e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;KHM&lt;/td&gt;
      &lt;td&gt;Cambodia&lt;/td&gt;
      &lt;td&gt;436826.0&lt;/td&gt;
      &lt;td&gt;4.590031e+05&lt;/td&gt;
      &lt;td&gt;4.737453e+05&lt;/td&gt;
      &lt;td&gt;4.793627e+05&lt;/td&gt;
      &lt;td&gt;4.683789e+05&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;10920650.0&lt;/td&gt;
      &lt;td&gt;1.147508e+07&lt;/td&gt;
      &lt;td&gt;1.184363e+07&lt;/td&gt;
      &lt;td&gt;1.198407e+07&lt;/td&gt;
      &lt;td&gt;1.170947e+07&lt;/td&gt;
      &lt;td&gt;4.634632e+05&lt;/td&gt;
      &lt;td&gt;2.317316e+06&lt;/td&gt;
      &lt;td&gt;1.158658e+07&lt;/td&gt;
      &lt;td&gt;5.793290e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;KOR&lt;/td&gt;
      &lt;td&gt;Korea (the Republic of)&lt;/td&gt;
      &lt;td&gt;167862.2&lt;/td&gt;
      &lt;td&gt;1.635341e+05&lt;/td&gt;
      &lt;td&gt;1.584897e+05&lt;/td&gt;
      &lt;td&gt;1.549113e+05&lt;/td&gt;
      &lt;td&gt;1.532609e+05&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;4196555.0&lt;/td&gt;
      &lt;td&gt;4.088352e+06&lt;/td&gt;
      &lt;td&gt;3.962243e+06&lt;/td&gt;
      &lt;td&gt;3.872783e+06&lt;/td&gt;
      &lt;td&gt;3.831522e+06&lt;/td&gt;
      &lt;td&gt;1.596116e+05&lt;/td&gt;
      &lt;td&gt;7.980582e+05&lt;/td&gt;
      &lt;td&gt;3.990291e+06&lt;/td&gt;
      &lt;td&gt;1.995146e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;LAO&lt;/td&gt;
      &lt;td&gt;Lao People&#39;s Democratic Republic (the)&lt;/td&gt;
      &lt;td&gt;94826.8&lt;/td&gt;
      &lt;td&gt;9.563000e+04&lt;/td&gt;
      &lt;td&gt;9.394070e+04&lt;/td&gt;
      &lt;td&gt;8.333360e+04&lt;/td&gt;
      &lt;td&gt;7.700550e+04&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;2370670.0&lt;/td&gt;
      &lt;td&gt;2.390750e+06&lt;/td&gt;
      &lt;td&gt;2.348518e+06&lt;/td&gt;
      &lt;td&gt;2.083340e+06&lt;/td&gt;
      &lt;td&gt;1.925138e+06&lt;/td&gt;
      &lt;td&gt;8.894732e+04&lt;/td&gt;
      &lt;td&gt;4.447366e+05&lt;/td&gt;
      &lt;td&gt;2.223683e+06&lt;/td&gt;
      &lt;td&gt;1.111842e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;LKA&lt;/td&gt;
      &lt;td&gt;Sri Lanka&lt;/td&gt;
      &lt;td&gt;132640.0&lt;/td&gt;
      &lt;td&gt;1.217563e+05&lt;/td&gt;
      &lt;td&gt;8.445630e+04&lt;/td&gt;
      &lt;td&gt;1.110490e+05&lt;/td&gt;
      &lt;td&gt;1.021563e+05&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;3316000.0&lt;/td&gt;
      &lt;td&gt;3.043908e+06&lt;/td&gt;
      &lt;td&gt;2.111408e+06&lt;/td&gt;
      &lt;td&gt;2.776225e+06&lt;/td&gt;
      &lt;td&gt;2.553908e+06&lt;/td&gt;
      &lt;td&gt;1.104116e+05&lt;/td&gt;
      &lt;td&gt;5.520579e+05&lt;/td&gt;
      &lt;td&gt;2.760290e+06&lt;/td&gt;
      &lt;td&gt;1.380145e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;MMR&lt;/td&gt;
      &lt;td&gt;Myanmar&lt;/td&gt;
      &lt;td&gt;1059409.6&lt;/td&gt;
      &lt;td&gt;1.052288e+06&lt;/td&gt;
      &lt;td&gt;1.087030e+06&lt;/td&gt;
      &lt;td&gt;1.118850e+06&lt;/td&gt;
      &lt;td&gt;1.083100e+06&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;26485240.0&lt;/td&gt;
      &lt;td&gt;2.630719e+07&lt;/td&gt;
      &lt;td&gt;2.717574e+07&lt;/td&gt;
      &lt;td&gt;2.797125e+07&lt;/td&gt;
      &lt;td&gt;2.707751e+07&lt;/td&gt;
      &lt;td&gt;1.080135e+06&lt;/td&gt;
      &lt;td&gt;5.400677e+06&lt;/td&gt;
      &lt;td&gt;2.700339e+07&lt;/td&gt;
      &lt;td&gt;1.350169e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;MYS&lt;/td&gt;
      &lt;td&gt;Malaysia&lt;/td&gt;
      &lt;td&gt;121942.6&lt;/td&gt;
      &lt;td&gt;1.232328e+05&lt;/td&gt;
      &lt;td&gt;1.226563e+05&lt;/td&gt;
      &lt;td&gt;1.252385e+05&lt;/td&gt;
      &lt;td&gt;1.224538e+05&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;3048565.0&lt;/td&gt;
      &lt;td&gt;3.080820e+06&lt;/td&gt;
      &lt;td&gt;3.066408e+06&lt;/td&gt;
      &lt;td&gt;3.130962e+06&lt;/td&gt;
      &lt;td&gt;3.061345e+06&lt;/td&gt;
      &lt;td&gt;1.231048e+05&lt;/td&gt;
      &lt;td&gt;6.155240e+05&lt;/td&gt;
      &lt;td&gt;3.077620e+06&lt;/td&gt;
      &lt;td&gt;1.538810e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;NPL&lt;/td&gt;
      &lt;td&gt;Nepal&lt;/td&gt;
      &lt;td&gt;149262.2&lt;/td&gt;
      &lt;td&gt;1.427237e+05&lt;/td&gt;
      &lt;td&gt;1.625746e+05&lt;/td&gt;
      &lt;td&gt;1.538908e+05&lt;/td&gt;
      &lt;td&gt;1.562154e+05&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;3731555.0&lt;/td&gt;
      &lt;td&gt;3.568093e+06&lt;/td&gt;
      &lt;td&gt;4.064365e+06&lt;/td&gt;
      &lt;td&gt;3.847270e+06&lt;/td&gt;
      &lt;td&gt;3.905385e+06&lt;/td&gt;
      &lt;td&gt;1.529333e+05&lt;/td&gt;
      &lt;td&gt;7.646667e+05&lt;/td&gt;
      &lt;td&gt;3.823334e+06&lt;/td&gt;
      &lt;td&gt;1.911667e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;PAK&lt;/td&gt;
      &lt;td&gt;Pakistan&lt;/td&gt;
      &lt;td&gt;383529.3&lt;/td&gt;
      &lt;td&gt;3.813618e+05&lt;/td&gt;
      &lt;td&gt;4.060833e+05&lt;/td&gt;
      &lt;td&gt;3.934042e+05&lt;/td&gt;
      &lt;td&gt;4.247551e+05&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;9588232.5&lt;/td&gt;
      &lt;td&gt;9.534045e+06&lt;/td&gt;
      &lt;td&gt;1.015208e+07&lt;/td&gt;
      &lt;td&gt;9.835105e+06&lt;/td&gt;
      &lt;td&gt;1.061888e+07&lt;/td&gt;
      &lt;td&gt;3.978267e+05&lt;/td&gt;
      &lt;td&gt;1.989134e+06&lt;/td&gt;
      &lt;td&gt;9.945668e+06&lt;/td&gt;
      &lt;td&gt;4.972834e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;PHL&lt;/td&gt;
      &lt;td&gt;Philippines (the)&lt;/td&gt;
      &lt;td&gt;1557810.6&lt;/td&gt;
      &lt;td&gt;1.524292e+06&lt;/td&gt;
      &lt;td&gt;1.609862e+06&lt;/td&gt;
      &lt;td&gt;1.606048e+06&lt;/td&gt;
      &lt;td&gt;1.556226e+06&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;38945265.0&lt;/td&gt;
      &lt;td&gt;3.810731e+07&lt;/td&gt;
      &lt;td&gt;4.024656e+07&lt;/td&gt;
      &lt;td&gt;4.015120e+07&lt;/td&gt;
      &lt;td&gt;3.890564e+07&lt;/td&gt;
      &lt;td&gt;1.570848e+06&lt;/td&gt;
      &lt;td&gt;7.854239e+06&lt;/td&gt;
      &lt;td&gt;3.927120e+07&lt;/td&gt;
      &lt;td&gt;1.963560e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;PRK&lt;/td&gt;
      &lt;td&gt;Korea (the Democratic People&#39;s Republic of)&lt;/td&gt;
      &lt;td&gt;82823.3&lt;/td&gt;
      &lt;td&gt;8.344230e+04&lt;/td&gt;
      &lt;td&gt;8.459620e+04&lt;/td&gt;
      &lt;td&gt;8.394330e+04&lt;/td&gt;
      &lt;td&gt;8.293700e+04&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;2070582.5&lt;/td&gt;
      &lt;td&gt;2.086058e+06&lt;/td&gt;
      &lt;td&gt;2.114905e+06&lt;/td&gt;
      &lt;td&gt;2.098582e+06&lt;/td&gt;
      &lt;td&gt;2.073425e+06&lt;/td&gt;
      &lt;td&gt;8.354842e+04&lt;/td&gt;
      &lt;td&gt;4.177421e+05&lt;/td&gt;
      &lt;td&gt;2.088710e+06&lt;/td&gt;
      &lt;td&gt;1.044355e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;THA&lt;/td&gt;
      &lt;td&gt;Thailand&lt;/td&gt;
      &lt;td&gt;1554254.0&lt;/td&gt;
      &lt;td&gt;1.703328e+06&lt;/td&gt;
      &lt;td&gt;1.714466e+06&lt;/td&gt;
      &lt;td&gt;1.702989e+06&lt;/td&gt;
      &lt;td&gt;1.553836e+06&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;38856350.0&lt;/td&gt;
      &lt;td&gt;4.258319e+07&lt;/td&gt;
      &lt;td&gt;4.286164e+07&lt;/td&gt;
      &lt;td&gt;4.257473e+07&lt;/td&gt;
      &lt;td&gt;3.884589e+07&lt;/td&gt;
      &lt;td&gt;1.645774e+06&lt;/td&gt;
      &lt;td&gt;8.228872e+06&lt;/td&gt;
      &lt;td&gt;4.114436e+07&lt;/td&gt;
      &lt;td&gt;2.057218e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;20&lt;/th&gt;
      &lt;td&gt;TWN&lt;/td&gt;
      &lt;td&gt;Taiwan (Province of China)&lt;/td&gt;
      &lt;td&gt;45838.7&lt;/td&gt;
      &lt;td&gt;4.983830e+04&lt;/td&gt;
      &lt;td&gt;4.999120e+04&lt;/td&gt;
      &lt;td&gt;4.941410e+04&lt;/td&gt;
      &lt;td&gt;4.915200e+04&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1145967.5&lt;/td&gt;
      &lt;td&gt;1.245958e+06&lt;/td&gt;
      &lt;td&gt;1.249780e+06&lt;/td&gt;
      &lt;td&gt;1.235352e+06&lt;/td&gt;
      &lt;td&gt;1.228800e+06&lt;/td&gt;
      &lt;td&gt;4.884686e+04&lt;/td&gt;
      &lt;td&gt;2.442343e+05&lt;/td&gt;
      &lt;td&gt;1.221172e+06&lt;/td&gt;
      &lt;td&gt;6.105858e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;21&lt;/th&gt;
      &lt;td&gt;USA&lt;/td&gt;
      &lt;td&gt;United States of America (the)&lt;/td&gt;
      &lt;td&gt;364728.0&lt;/td&gt;
      &lt;td&gt;4.386620e+05&lt;/td&gt;
      &lt;td&gt;3.362555e+05&lt;/td&gt;
      &lt;td&gt;4.121775e+05&lt;/td&gt;
      &lt;td&gt;3.501365e+05&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;9118200.0&lt;/td&gt;
      &lt;td&gt;1.096655e+07&lt;/td&gt;
      &lt;td&gt;8.406388e+06&lt;/td&gt;
      &lt;td&gt;1.030444e+07&lt;/td&gt;
      &lt;td&gt;8.753412e+06&lt;/td&gt;
      &lt;td&gt;3.803919e+05&lt;/td&gt;
      &lt;td&gt;1.901960e+06&lt;/td&gt;
      &lt;td&gt;9.509798e+06&lt;/td&gt;
      &lt;td&gt;4.754899e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22&lt;/th&gt;
      &lt;td&gt;VNM&lt;/td&gt;
      &lt;td&gt;Viet Nam&lt;/td&gt;
      &lt;td&gt;1381744.4&lt;/td&gt;
      &lt;td&gt;1.365174e+06&lt;/td&gt;
      &lt;td&gt;1.360552e+06&lt;/td&gt;
      &lt;td&gt;1.336231e+06&lt;/td&gt;
      &lt;td&gt;1.318431e+06&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;34543610.0&lt;/td&gt;
      &lt;td&gt;3.412934e+07&lt;/td&gt;
      &lt;td&gt;3.401379e+07&lt;/td&gt;
      &lt;td&gt;3.340578e+07&lt;/td&gt;
      &lt;td&gt;3.296078e+07&lt;/td&gt;
      &lt;td&gt;1.352426e+06&lt;/td&gt;
      &lt;td&gt;6.762132e+06&lt;/td&gt;
      &lt;td&gt;3.381066e+07&lt;/td&gt;
      &lt;td&gt;1.690533e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;23&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Total&lt;/td&gt;
      &lt;td&gt;23829994.0&lt;/td&gt;
      &lt;td&gt;2.391723e+07&lt;/td&gt;
      &lt;td&gt;2.407593e+07&lt;/td&gt;
      &lt;td&gt;2.404256e+07&lt;/td&gt;
      &lt;td&gt;2.344603e+07&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;595749850.0&lt;/td&gt;
      &lt;td&gt;5.979306e+08&lt;/td&gt;
      &lt;td&gt;6.018983e+08&lt;/td&gt;
      &lt;td&gt;6.010640e+08&lt;/td&gt;
      &lt;td&gt;5.861507e+08&lt;/td&gt;
      &lt;td&gt;2.386235e+07&lt;/td&gt;
      &lt;td&gt;1.193117e+08&lt;/td&gt;
      &lt;td&gt;5.965587e+08&lt;/td&gt;
      &lt;td&gt;2.982794e+09&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;24&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;mean&lt;/td&gt;
      &lt;td&gt;948478.0&lt;/td&gt;
      &lt;td&gt;9.522272e+05&lt;/td&gt;
      &lt;td&gt;9.590840e+05&lt;/td&gt;
      &lt;td&gt;9.575896e+05&lt;/td&gt;
      &lt;td&gt;9.316100e+05&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;23711950.0&lt;/td&gt;
      &lt;td&gt;2.380568e+07&lt;/td&gt;
      &lt;td&gt;2.397710e+07&lt;/td&gt;
      &lt;td&gt;2.393974e+07&lt;/td&gt;
      &lt;td&gt;2.329025e+07&lt;/td&gt;
      &lt;td&gt;9.497978e+05&lt;/td&gt;
      &lt;td&gt;4.748989e+06&lt;/td&gt;
      &lt;td&gt;2.374494e+07&lt;/td&gt;
      &lt;td&gt;1.187247e+08&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h3 id=&#34;faostat-data-to-file&#34; &gt;FAOSTAT Data to File
&lt;span&gt;
    &lt;a href=&#34;#faostat-data-to-file&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;outfile &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/Users/jnapolitano/Projects/wattime-takehome/wattime-takehome/data/FAOSTAT_DATA.csv&amp;#34;&lt;/span&gt;

faostat_emissions_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to_csv(outfile)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;faostat-plots&#34; &gt;FaoSTAT PLOTS
&lt;span&gt;
    &lt;a href=&#34;#faostat-plots&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;h3 id=&#34;faostat-hectare-estimates-bar-plot&#34; &gt;FAOSTAT Hectare Estimates Bar Plot
&lt;span&gt;
    &lt;a href=&#34;#faostat-hectare-estimates-bar-plot&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;faostat_emissions_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;plot(kind &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;barh&amp;#34;&lt;/span&gt;, x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_name&amp;#39;&lt;/span&gt;, y &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [&lt;span style=&#34;color:#ae81ff&#34;&gt;2015&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2016&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2017&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2018&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt;], xlabel &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Country Name&amp;#34;&lt;/span&gt;, ylabel &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Tonnes CH4&amp;#34;&lt;/span&gt;, figsize &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;AxesSubplot:ylabel=&#39;Country Name&#39;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;data_exploration_files/data_exploration_55_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;faostat-density-plot&#34; &gt;FAOSTAT Density Plot
&lt;span&gt;
    &lt;a href=&#34;#faostat-density-plot&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;faostat_emissions_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;plot(rot &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;90&lt;/span&gt;, kind &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;density&amp;#34;&lt;/span&gt;,y &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [&lt;span style=&#34;color:#ae81ff&#34;&gt;2015&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2016&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2017&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2018&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt;], figsize &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#ae81ff&#34;&gt;15&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)) 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;AxesSubplot:ylabel=&#39;Density&#39;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;data_exploration_files/data_exploration_57_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;The density plot is fairly consistent.  There is nearly no variation between nations and in total.  The 2020 data may show otherwise as the Malaysian data shows.&lt;/p&gt;
&lt;h2 id=&#34;join-dfs-by-iso3-country&#34; &gt;Join Df&amp;rsquo;s by ISO3 Country
&lt;span&gt;
    &lt;a href=&#34;#join-dfs-by-iso3-country&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;h3 id=&#34;drop-totals-and-means-from-the-original-df&#34; &gt;Drop totals and means from the original df.
&lt;span&gt;
    &lt;a href=&#34;#drop-totals-and-means-from-the-original-df&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;p&gt;Because I am joining on iso3 country country code if the totals and means are located at different indexes we may experience merge and calculation errors&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;faostat_emissions_df &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; faostat_emissions_df[(faostat_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;country_name&amp;#34;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Total&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt; (faostat_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_name&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;)]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;copy()
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;malaysia_emissions_df &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; malaysia_emissions_df[(malaysia_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;country_name&amp;#34;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Total&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt; (malaysia_emissions_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_name&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;)]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;copy()
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;faostat_emissions_df
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div style=&#34;overflow-x:auto;&#34;&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;iso3_country&lt;/th&gt;
      &lt;th&gt;country_name&lt;/th&gt;
      &lt;th&gt;2015&lt;/th&gt;
      &lt;th&gt;2016&lt;/th&gt;
      &lt;th&gt;2017&lt;/th&gt;
      &lt;th&gt;2018&lt;/th&gt;
      &lt;th&gt;2019&lt;/th&gt;
      &lt;th&gt;2020&lt;/th&gt;
      &lt;th&gt;2021&lt;/th&gt;
      &lt;th&gt;tCO2_2015&lt;/th&gt;
      &lt;th&gt;tCO2_2016&lt;/th&gt;
      &lt;th&gt;tCO2_2017&lt;/th&gt;
      &lt;th&gt;tCO2_2018&lt;/th&gt;
      &lt;th&gt;tCO2_2019&lt;/th&gt;
      &lt;th&gt;Mean_CH4&lt;/th&gt;
      &lt;th&gt;Total_CH4&lt;/th&gt;
      &lt;th&gt;Mean_CO2&lt;/th&gt;
      &lt;th&gt;Total_CO2&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;BGD&lt;/td&gt;
      &lt;td&gt;Bangladesh&lt;/td&gt;
      &lt;td&gt;1131293.4&lt;/td&gt;
      &lt;td&gt;1093480.4&lt;/td&gt;
      &lt;td&gt;1154531.0&lt;/td&gt;
      &lt;td&gt;1144591.0&lt;/td&gt;
      &lt;td&gt;1144745.4&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;28282335.0&lt;/td&gt;
      &lt;td&gt;27337010.0&lt;/td&gt;
      &lt;td&gt;28863275.0&lt;/td&gt;
      &lt;td&gt;28614775.0&lt;/td&gt;
      &lt;td&gt;28618635.0&lt;/td&gt;
      &lt;td&gt;1133728.24&lt;/td&gt;
      &lt;td&gt;5668641.2&lt;/td&gt;
      &lt;td&gt;28343206.0&lt;/td&gt;
      &lt;td&gt;141716030.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;BRA&lt;/td&gt;
      &lt;td&gt;Brazil&lt;/td&gt;
      &lt;td&gt;138910.3&lt;/td&gt;
      &lt;td&gt;126278.2&lt;/td&gt;
      &lt;td&gt;130322.9&lt;/td&gt;
      &lt;td&gt;121615.2&lt;/td&gt;
      &lt;td&gt;111084.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;3472757.5&lt;/td&gt;
      &lt;td&gt;3156955.0&lt;/td&gt;
      &lt;td&gt;3258072.5&lt;/td&gt;
      &lt;td&gt;3040380.0&lt;/td&gt;
      &lt;td&gt;2777120.0&lt;/td&gt;
      &lt;td&gt;125642.28&lt;/td&gt;
      &lt;td&gt;628211.4&lt;/td&gt;
      &lt;td&gt;3141057.0&lt;/td&gt;
      &lt;td&gt;15705285.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;CHN&lt;/td&gt;
      &lt;td&gt;China&lt;/td&gt;
      &lt;td&gt;5406593.9&lt;/td&gt;
      &lt;td&gt;5399920.0&lt;/td&gt;
      &lt;td&gt;5400129.0&lt;/td&gt;
      &lt;td&gt;5302173.1&lt;/td&gt;
      &lt;td&gt;5214454.7&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;135164847.5&lt;/td&gt;
      &lt;td&gt;134998000.0&lt;/td&gt;
      &lt;td&gt;135003225.0&lt;/td&gt;
      &lt;td&gt;132554327.5&lt;/td&gt;
      &lt;td&gt;130361367.5&lt;/td&gt;
      &lt;td&gt;5344654.14&lt;/td&gt;
      &lt;td&gt;26723270.7&lt;/td&gt;
      &lt;td&gt;133616353.5&lt;/td&gt;
      &lt;td&gt;668081767.5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;ESP&lt;/td&gt;
      &lt;td&gt;Spain&lt;/td&gt;
      &lt;td&gt;55082.2&lt;/td&gt;
      &lt;td&gt;55073.1&lt;/td&gt;
      &lt;td&gt;54232.4&lt;/td&gt;
      &lt;td&gt;52925.0&lt;/td&gt;
      &lt;td&gt;52098.5&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1377055.0&lt;/td&gt;
      &lt;td&gt;1376827.5&lt;/td&gt;
      &lt;td&gt;1355810.0&lt;/td&gt;
      &lt;td&gt;1323125.0&lt;/td&gt;
      &lt;td&gt;1302462.5&lt;/td&gt;
      &lt;td&gt;53882.24&lt;/td&gt;
      &lt;td&gt;269411.2&lt;/td&gt;
      &lt;td&gt;1347056.0&lt;/td&gt;
      &lt;td&gt;6735280.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;IDN&lt;/td&gt;
      &lt;td&gt;Indonesia&lt;/td&gt;
      &lt;td&gt;2407953.5&lt;/td&gt;
      &lt;td&gt;2387656.4&lt;/td&gt;
      &lt;td&gt;2425290.6&lt;/td&gt;
      &lt;td&gt;2405613.8&lt;/td&gt;
      &lt;td&gt;2257604.3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;60198837.5&lt;/td&gt;
      &lt;td&gt;59691410.0&lt;/td&gt;
      &lt;td&gt;60632265.0&lt;/td&gt;
      &lt;td&gt;60140345.0&lt;/td&gt;
      &lt;td&gt;56440107.5&lt;/td&gt;
      &lt;td&gt;2376823.72&lt;/td&gt;
      &lt;td&gt;11884118.6&lt;/td&gt;
      &lt;td&gt;59420593.0&lt;/td&gt;
      &lt;td&gt;297102965.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;IND&lt;/td&gt;
      &lt;td&gt;India&lt;/td&gt;
      &lt;td&gt;4580248.4&lt;/td&gt;
      &lt;td&gt;4559136.4&lt;/td&gt;
      &lt;td&gt;4620790.8&lt;/td&gt;
      &lt;td&gt;4661154.9&lt;/td&gt;
      &lt;td&gt;4621416.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;114506210.0&lt;/td&gt;
      &lt;td&gt;113978410.0&lt;/td&gt;
      &lt;td&gt;115519770.0&lt;/td&gt;
      &lt;td&gt;116528872.5&lt;/td&gt;
      &lt;td&gt;115535420.0&lt;/td&gt;
      &lt;td&gt;4608549.46&lt;/td&gt;
      &lt;td&gt;23042747.3&lt;/td&gt;
      &lt;td&gt;115213736.5&lt;/td&gt;
      &lt;td&gt;576068682.5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;IRN&lt;/td&gt;
      &lt;td&gt;Iran (Islamic Republic of)&lt;/td&gt;
      &lt;td&gt;116486.7&lt;/td&gt;
      &lt;td&gt;131008.5&lt;/td&gt;
      &lt;td&gt;87233.6&lt;/td&gt;
      &lt;td&gt;93936.6&lt;/td&gt;
      &lt;td&gt;96103.4&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;2912167.5&lt;/td&gt;
      &lt;td&gt;3275212.5&lt;/td&gt;
      &lt;td&gt;2180840.0&lt;/td&gt;
      &lt;td&gt;2348415.0&lt;/td&gt;
      &lt;td&gt;2402585.0&lt;/td&gt;
      &lt;td&gt;104953.76&lt;/td&gt;
      &lt;td&gt;524768.8&lt;/td&gt;
      &lt;td&gt;2623844.0&lt;/td&gt;
      &lt;td&gt;13119220.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;ITA&lt;/td&gt;
      &lt;td&gt;Italy&lt;/td&gt;
      &lt;td&gt;114574.8&lt;/td&gt;
      &lt;td&gt;118003.0&lt;/td&gt;
      &lt;td&gt;118003.0&lt;/td&gt;
      &lt;td&gt;109463.8&lt;/td&gt;
      &lt;td&gt;110895.1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;2864370.0&lt;/td&gt;
      &lt;td&gt;2950075.0&lt;/td&gt;
      &lt;td&gt;2950075.0&lt;/td&gt;
      &lt;td&gt;2736595.0&lt;/td&gt;
      &lt;td&gt;2772377.5&lt;/td&gt;
      &lt;td&gt;114187.94&lt;/td&gt;
      &lt;td&gt;570939.7&lt;/td&gt;
      &lt;td&gt;2854698.5&lt;/td&gt;
      &lt;td&gt;14273492.5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;JPN&lt;/td&gt;
      &lt;td&gt;Japan&lt;/td&gt;
      &lt;td&gt;330353.1&lt;/td&gt;
      &lt;td&gt;326403.0&lt;/td&gt;
      &lt;td&gt;323700.3&lt;/td&gt;
      &lt;td&gt;322245.0&lt;/td&gt;
      &lt;td&gt;320581.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;8258827.5&lt;/td&gt;
      &lt;td&gt;8160075.0&lt;/td&gt;
      &lt;td&gt;8092507.5&lt;/td&gt;
      &lt;td&gt;8056125.0&lt;/td&gt;
      &lt;td&gt;8014545.0&lt;/td&gt;
      &lt;td&gt;324656.64&lt;/td&gt;
      &lt;td&gt;1623283.2&lt;/td&gt;
      &lt;td&gt;8116416.0&lt;/td&gt;
      &lt;td&gt;40582080.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;KHM&lt;/td&gt;
      &lt;td&gt;Cambodia&lt;/td&gt;
      &lt;td&gt;436826.0&lt;/td&gt;
      &lt;td&gt;459003.1&lt;/td&gt;
      &lt;td&gt;473745.3&lt;/td&gt;
      &lt;td&gt;479362.7&lt;/td&gt;
      &lt;td&gt;468378.9&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;10920650.0&lt;/td&gt;
      &lt;td&gt;11475077.5&lt;/td&gt;
      &lt;td&gt;11843632.5&lt;/td&gt;
      &lt;td&gt;11984067.5&lt;/td&gt;
      &lt;td&gt;11709472.5&lt;/td&gt;
      &lt;td&gt;463463.20&lt;/td&gt;
      &lt;td&gt;2317316.0&lt;/td&gt;
      &lt;td&gt;11586580.0&lt;/td&gt;
      &lt;td&gt;57932900.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;KOR&lt;/td&gt;
      &lt;td&gt;Korea (the Republic of)&lt;/td&gt;
      &lt;td&gt;167862.2&lt;/td&gt;
      &lt;td&gt;163534.1&lt;/td&gt;
      &lt;td&gt;158489.7&lt;/td&gt;
      &lt;td&gt;154911.3&lt;/td&gt;
      &lt;td&gt;153260.9&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;4196555.0&lt;/td&gt;
      &lt;td&gt;4088352.5&lt;/td&gt;
      &lt;td&gt;3962242.5&lt;/td&gt;
      &lt;td&gt;3872782.5&lt;/td&gt;
      &lt;td&gt;3831522.5&lt;/td&gt;
      &lt;td&gt;159611.64&lt;/td&gt;
      &lt;td&gt;798058.2&lt;/td&gt;
      &lt;td&gt;3990291.0&lt;/td&gt;
      &lt;td&gt;19951455.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;LAO&lt;/td&gt;
      &lt;td&gt;Lao People&#39;s Democratic Republic (the)&lt;/td&gt;
      &lt;td&gt;94826.8&lt;/td&gt;
      &lt;td&gt;95630.0&lt;/td&gt;
      &lt;td&gt;93940.7&lt;/td&gt;
      &lt;td&gt;83333.6&lt;/td&gt;
      &lt;td&gt;77005.5&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;2370670.0&lt;/td&gt;
      &lt;td&gt;2390750.0&lt;/td&gt;
      &lt;td&gt;2348517.5&lt;/td&gt;
      &lt;td&gt;2083340.0&lt;/td&gt;
      &lt;td&gt;1925137.5&lt;/td&gt;
      &lt;td&gt;88947.32&lt;/td&gt;
      &lt;td&gt;444736.6&lt;/td&gt;
      &lt;td&gt;2223683.0&lt;/td&gt;
      &lt;td&gt;11118415.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;LKA&lt;/td&gt;
      &lt;td&gt;Sri Lanka&lt;/td&gt;
      &lt;td&gt;132640.0&lt;/td&gt;
      &lt;td&gt;121756.3&lt;/td&gt;
      &lt;td&gt;84456.3&lt;/td&gt;
      &lt;td&gt;111049.0&lt;/td&gt;
      &lt;td&gt;102156.3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;3316000.0&lt;/td&gt;
      &lt;td&gt;3043907.5&lt;/td&gt;
      &lt;td&gt;2111407.5&lt;/td&gt;
      &lt;td&gt;2776225.0&lt;/td&gt;
      &lt;td&gt;2553907.5&lt;/td&gt;
      &lt;td&gt;110411.58&lt;/td&gt;
      &lt;td&gt;552057.9&lt;/td&gt;
      &lt;td&gt;2760289.5&lt;/td&gt;
      &lt;td&gt;13801447.5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;MMR&lt;/td&gt;
      &lt;td&gt;Myanmar&lt;/td&gt;
      &lt;td&gt;1059409.6&lt;/td&gt;
      &lt;td&gt;1052287.7&lt;/td&gt;
      &lt;td&gt;1087029.5&lt;/td&gt;
      &lt;td&gt;1118850.0&lt;/td&gt;
      &lt;td&gt;1083100.3&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;26485240.0&lt;/td&gt;
      &lt;td&gt;26307192.5&lt;/td&gt;
      &lt;td&gt;27175737.5&lt;/td&gt;
      &lt;td&gt;27971250.0&lt;/td&gt;
      &lt;td&gt;27077507.5&lt;/td&gt;
      &lt;td&gt;1080135.42&lt;/td&gt;
      &lt;td&gt;5400677.1&lt;/td&gt;
      &lt;td&gt;27003385.5&lt;/td&gt;
      &lt;td&gt;135016927.5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;MYS&lt;/td&gt;
      &lt;td&gt;Malaysia&lt;/td&gt;
      &lt;td&gt;121942.6&lt;/td&gt;
      &lt;td&gt;123232.8&lt;/td&gt;
      &lt;td&gt;122656.3&lt;/td&gt;
      &lt;td&gt;125238.5&lt;/td&gt;
      &lt;td&gt;122453.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;3048565.0&lt;/td&gt;
      &lt;td&gt;3080820.0&lt;/td&gt;
      &lt;td&gt;3066407.5&lt;/td&gt;
      &lt;td&gt;3130962.5&lt;/td&gt;
      &lt;td&gt;3061345.0&lt;/td&gt;
      &lt;td&gt;123104.80&lt;/td&gt;
      &lt;td&gt;615524.0&lt;/td&gt;
      &lt;td&gt;3077620.0&lt;/td&gt;
      &lt;td&gt;15388100.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;NPL&lt;/td&gt;
      &lt;td&gt;Nepal&lt;/td&gt;
      &lt;td&gt;149262.2&lt;/td&gt;
      &lt;td&gt;142723.7&lt;/td&gt;
      &lt;td&gt;162574.6&lt;/td&gt;
      &lt;td&gt;153890.8&lt;/td&gt;
      &lt;td&gt;156215.4&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;3731555.0&lt;/td&gt;
      &lt;td&gt;3568092.5&lt;/td&gt;
      &lt;td&gt;4064365.0&lt;/td&gt;
      &lt;td&gt;3847270.0&lt;/td&gt;
      &lt;td&gt;3905385.0&lt;/td&gt;
      &lt;td&gt;152933.34&lt;/td&gt;
      &lt;td&gt;764666.7&lt;/td&gt;
      &lt;td&gt;3823333.5&lt;/td&gt;
      &lt;td&gt;19116667.5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;PAK&lt;/td&gt;
      &lt;td&gt;Pakistan&lt;/td&gt;
      &lt;td&gt;383529.3&lt;/td&gt;
      &lt;td&gt;381361.8&lt;/td&gt;
      &lt;td&gt;406083.3&lt;/td&gt;
      &lt;td&gt;393404.2&lt;/td&gt;
      &lt;td&gt;424755.1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;9588232.5&lt;/td&gt;
      &lt;td&gt;9534045.0&lt;/td&gt;
      &lt;td&gt;10152082.5&lt;/td&gt;
      &lt;td&gt;9835105.0&lt;/td&gt;
      &lt;td&gt;10618877.5&lt;/td&gt;
      &lt;td&gt;397826.74&lt;/td&gt;
      &lt;td&gt;1989133.7&lt;/td&gt;
      &lt;td&gt;9945668.5&lt;/td&gt;
      &lt;td&gt;49728342.5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;PHL&lt;/td&gt;
      &lt;td&gt;Philippines (the)&lt;/td&gt;
      &lt;td&gt;1557810.6&lt;/td&gt;
      &lt;td&gt;1524292.5&lt;/td&gt;
      &lt;td&gt;1609862.5&lt;/td&gt;
      &lt;td&gt;1606047.8&lt;/td&gt;
      &lt;td&gt;1556225.8&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;38945265.0&lt;/td&gt;
      &lt;td&gt;38107312.5&lt;/td&gt;
      &lt;td&gt;40246562.5&lt;/td&gt;
      &lt;td&gt;40151195.0&lt;/td&gt;
      &lt;td&gt;38905645.0&lt;/td&gt;
      &lt;td&gt;1570847.84&lt;/td&gt;
      &lt;td&gt;7854239.2&lt;/td&gt;
      &lt;td&gt;39271196.0&lt;/td&gt;
      &lt;td&gt;196355980.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;PRK&lt;/td&gt;
      &lt;td&gt;Korea (the Democratic People&#39;s Republic of)&lt;/td&gt;
      &lt;td&gt;82823.3&lt;/td&gt;
      &lt;td&gt;83442.3&lt;/td&gt;
      &lt;td&gt;84596.2&lt;/td&gt;
      &lt;td&gt;83943.3&lt;/td&gt;
      &lt;td&gt;82937.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;2070582.5&lt;/td&gt;
      &lt;td&gt;2086057.5&lt;/td&gt;
      &lt;td&gt;2114905.0&lt;/td&gt;
      &lt;td&gt;2098582.5&lt;/td&gt;
      &lt;td&gt;2073425.0&lt;/td&gt;
      &lt;td&gt;83548.42&lt;/td&gt;
      &lt;td&gt;417742.1&lt;/td&gt;
      &lt;td&gt;2088710.5&lt;/td&gt;
      &lt;td&gt;10443552.5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;THA&lt;/td&gt;
      &lt;td&gt;Thailand&lt;/td&gt;
      &lt;td&gt;1554254.0&lt;/td&gt;
      &lt;td&gt;1703327.7&lt;/td&gt;
      &lt;td&gt;1714465.6&lt;/td&gt;
      &lt;td&gt;1702989.1&lt;/td&gt;
      &lt;td&gt;1553835.5&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;38856350.0&lt;/td&gt;
      &lt;td&gt;42583192.5&lt;/td&gt;
      &lt;td&gt;42861640.0&lt;/td&gt;
      &lt;td&gt;42574727.5&lt;/td&gt;
      &lt;td&gt;38845887.5&lt;/td&gt;
      &lt;td&gt;1645774.38&lt;/td&gt;
      &lt;td&gt;8228871.9&lt;/td&gt;
      &lt;td&gt;41144359.5&lt;/td&gt;
      &lt;td&gt;205721797.5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;20&lt;/th&gt;
      &lt;td&gt;TWN&lt;/td&gt;
      &lt;td&gt;Taiwan (Province of China)&lt;/td&gt;
      &lt;td&gt;45838.7&lt;/td&gt;
      &lt;td&gt;49838.3&lt;/td&gt;
      &lt;td&gt;49991.2&lt;/td&gt;
      &lt;td&gt;49414.1&lt;/td&gt;
      &lt;td&gt;49152.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1145967.5&lt;/td&gt;
      &lt;td&gt;1245957.5&lt;/td&gt;
      &lt;td&gt;1249780.0&lt;/td&gt;
      &lt;td&gt;1235352.5&lt;/td&gt;
      &lt;td&gt;1228800.0&lt;/td&gt;
      &lt;td&gt;48846.86&lt;/td&gt;
      &lt;td&gt;244234.3&lt;/td&gt;
      &lt;td&gt;1221171.5&lt;/td&gt;
      &lt;td&gt;6105857.5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;21&lt;/th&gt;
      &lt;td&gt;USA&lt;/td&gt;
      &lt;td&gt;United States of America (the)&lt;/td&gt;
      &lt;td&gt;364728.0&lt;/td&gt;
      &lt;td&gt;438662.0&lt;/td&gt;
      &lt;td&gt;336255.5&lt;/td&gt;
      &lt;td&gt;412177.5&lt;/td&gt;
      &lt;td&gt;350136.5&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;9118200.0&lt;/td&gt;
      &lt;td&gt;10966550.0&lt;/td&gt;
      &lt;td&gt;8406387.5&lt;/td&gt;
      &lt;td&gt;10304437.5&lt;/td&gt;
      &lt;td&gt;8753412.5&lt;/td&gt;
      &lt;td&gt;380391.90&lt;/td&gt;
      &lt;td&gt;1901959.5&lt;/td&gt;
      &lt;td&gt;9509797.5&lt;/td&gt;
      &lt;td&gt;47548987.5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22&lt;/th&gt;
      &lt;td&gt;VNM&lt;/td&gt;
      &lt;td&gt;Viet Nam&lt;/td&gt;
      &lt;td&gt;1381744.4&lt;/td&gt;
      &lt;td&gt;1365173.8&lt;/td&gt;
      &lt;td&gt;1360551.6&lt;/td&gt;
      &lt;td&gt;1336231.2&lt;/td&gt;
      &lt;td&gt;1318431.1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;34543610.0&lt;/td&gt;
      &lt;td&gt;34129345.0&lt;/td&gt;
      &lt;td&gt;34013790.0&lt;/td&gt;
      &lt;td&gt;33405780.0&lt;/td&gt;
      &lt;td&gt;32960777.5&lt;/td&gt;
      &lt;td&gt;1352426.42&lt;/td&gt;
      &lt;td&gt;6762132.1&lt;/td&gt;
      &lt;td&gt;33810660.5&lt;/td&gt;
      &lt;td&gt;169053302.5&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;malaysia_emissions_df
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div style=&#34;overflow-x:auto;&#34;&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;iso3_country&lt;/th&gt;
      &lt;th&gt;country_name&lt;/th&gt;
      &lt;th&gt;tCH4_2015&lt;/th&gt;
      &lt;th&gt;tCH4_2016&lt;/th&gt;
      &lt;th&gt;tCH4_2017&lt;/th&gt;
      &lt;th&gt;tCH4_2018&lt;/th&gt;
      &lt;th&gt;tCH4_2019&lt;/th&gt;
      &lt;th&gt;tCH4_2020&lt;/th&gt;
      &lt;th&gt;tCH4_2021&lt;/th&gt;
      &lt;th&gt;tCO2_2015&lt;/th&gt;
      &lt;th&gt;tCO2_2016&lt;/th&gt;
      &lt;th&gt;tCO2_2017&lt;/th&gt;
      &lt;th&gt;tCO2_2018&lt;/th&gt;
      &lt;th&gt;tCO2_2019&lt;/th&gt;
      &lt;th&gt;Mean_CH4&lt;/th&gt;
      &lt;th&gt;Total_CH4&lt;/th&gt;
      &lt;th&gt;Mean_CO2&lt;/th&gt;
      &lt;th&gt;Total_CO2&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;BGD&lt;/td&gt;
      &lt;td&gt;Bangladesh&lt;/td&gt;
      &lt;td&gt;2.344420e+06&lt;/td&gt;
      &lt;td&gt;2.278158e+06&lt;/td&gt;
      &lt;td&gt;2.098958e+06&lt;/td&gt;
      &lt;td&gt;2.141231e+06&lt;/td&gt;
      &lt;td&gt;2.070985e+06&lt;/td&gt;
      &lt;td&gt;2.106781e+06&lt;/td&gt;
      &lt;td&gt;1.983974e+06&lt;/td&gt;
      &lt;td&gt;5.861049e+07&lt;/td&gt;
      &lt;td&gt;5.695395e+07&lt;/td&gt;
      &lt;td&gt;5.247394e+07&lt;/td&gt;
      &lt;td&gt;5.353076e+07&lt;/td&gt;
      &lt;td&gt;5.177463e+07&lt;/td&gt;
      &lt;td&gt;2.186750e+06&lt;/td&gt;
      &lt;td&gt;1.093375e+07&lt;/td&gt;
      &lt;td&gt;5.466875e+07&lt;/td&gt;
      &lt;td&gt;2.733438e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;BRA&lt;/td&gt;
      &lt;td&gt;Brazil&lt;/td&gt;
      &lt;td&gt;3.410233e+05&lt;/td&gt;
      &lt;td&gt;3.104189e+05&lt;/td&gt;
      &lt;td&gt;3.725173e+05&lt;/td&gt;
      &lt;td&gt;3.717030e+05&lt;/td&gt;
      &lt;td&gt;3.294713e+05&lt;/td&gt;
      &lt;td&gt;4.902874e+05&lt;/td&gt;
      &lt;td&gt;4.544874e+05&lt;/td&gt;
      &lt;td&gt;8.525583e+06&lt;/td&gt;
      &lt;td&gt;7.760473e+06&lt;/td&gt;
      &lt;td&gt;9.312934e+06&lt;/td&gt;
      &lt;td&gt;9.292575e+06&lt;/td&gt;
      &lt;td&gt;8.236783e+06&lt;/td&gt;
      &lt;td&gt;3.450268e+05&lt;/td&gt;
      &lt;td&gt;1.725134e+06&lt;/td&gt;
      &lt;td&gt;8.625670e+06&lt;/td&gt;
      &lt;td&gt;4.312835e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;CHN&lt;/td&gt;
      &lt;td&gt;China&lt;/td&gt;
      &lt;td&gt;6.133647e+06&lt;/td&gt;
      &lt;td&gt;5.859531e+06&lt;/td&gt;
      &lt;td&gt;6.355071e+06&lt;/td&gt;
      &lt;td&gt;5.413962e+06&lt;/td&gt;
      &lt;td&gt;5.603352e+06&lt;/td&gt;
      &lt;td&gt;6.402353e+06&lt;/td&gt;
      &lt;td&gt;6.068210e+06&lt;/td&gt;
      &lt;td&gt;1.533412e+08&lt;/td&gt;
      &lt;td&gt;1.464883e+08&lt;/td&gt;
      &lt;td&gt;1.588768e+08&lt;/td&gt;
      &lt;td&gt;1.353491e+08&lt;/td&gt;
      &lt;td&gt;1.400838e+08&lt;/td&gt;
      &lt;td&gt;5.873113e+06&lt;/td&gt;
      &lt;td&gt;2.936556e+07&lt;/td&gt;
      &lt;td&gt;1.468278e+08&lt;/td&gt;
      &lt;td&gt;7.341391e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;ESP&lt;/td&gt;
      &lt;td&gt;Spain&lt;/td&gt;
      &lt;td&gt;1.141464e+04&lt;/td&gt;
      &lt;td&gt;1.334803e+04&lt;/td&gt;
      &lt;td&gt;1.217299e+04&lt;/td&gt;
      &lt;td&gt;1.405410e+04&lt;/td&gt;
      &lt;td&gt;1.148324e+04&lt;/td&gt;
      &lt;td&gt;1.305461e+04&lt;/td&gt;
      &lt;td&gt;8.531579e+03&lt;/td&gt;
      &lt;td&gt;2.853661e+05&lt;/td&gt;
      &lt;td&gt;3.337007e+05&lt;/td&gt;
      &lt;td&gt;3.043248e+05&lt;/td&gt;
      &lt;td&gt;3.513524e+05&lt;/td&gt;
      &lt;td&gt;2.870810e+05&lt;/td&gt;
      &lt;td&gt;1.249460e+04&lt;/td&gt;
      &lt;td&gt;6.247300e+04&lt;/td&gt;
      &lt;td&gt;3.123650e+05&lt;/td&gt;
      &lt;td&gt;1.561825e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;IDN&lt;/td&gt;
      &lt;td&gt;Indonesia&lt;/td&gt;
      &lt;td&gt;1.283649e+06&lt;/td&gt;
      &lt;td&gt;1.023129e+06&lt;/td&gt;
      &lt;td&gt;9.615327e+05&lt;/td&gt;
      &lt;td&gt;1.176982e+06&lt;/td&gt;
      &lt;td&gt;1.266668e+06&lt;/td&gt;
      &lt;td&gt;1.188195e+06&lt;/td&gt;
      &lt;td&gt;1.009936e+06&lt;/td&gt;
      &lt;td&gt;3.209122e+07&lt;/td&gt;
      &lt;td&gt;2.557824e+07&lt;/td&gt;
      &lt;td&gt;2.403832e+07&lt;/td&gt;
      &lt;td&gt;2.942454e+07&lt;/td&gt;
      &lt;td&gt;3.166670e+07&lt;/td&gt;
      &lt;td&gt;1.142392e+06&lt;/td&gt;
      &lt;td&gt;5.711960e+06&lt;/td&gt;
      &lt;td&gt;2.855980e+07&lt;/td&gt;
      &lt;td&gt;1.427990e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;IND&lt;/td&gt;
      &lt;td&gt;India&lt;/td&gt;
      &lt;td&gt;6.219887e+06&lt;/td&gt;
      &lt;td&gt;5.309413e+06&lt;/td&gt;
      &lt;td&gt;6.228451e+06&lt;/td&gt;
      &lt;td&gt;6.589798e+06&lt;/td&gt;
      &lt;td&gt;7.501556e+06&lt;/td&gt;
      &lt;td&gt;7.599764e+06&lt;/td&gt;
      &lt;td&gt;6.567960e+06&lt;/td&gt;
      &lt;td&gt;1.554972e+08&lt;/td&gt;
      &lt;td&gt;1.327353e+08&lt;/td&gt;
      &lt;td&gt;1.557113e+08&lt;/td&gt;
      &lt;td&gt;1.647450e+08&lt;/td&gt;
      &lt;td&gt;1.875389e+08&lt;/td&gt;
      &lt;td&gt;6.369821e+06&lt;/td&gt;
      &lt;td&gt;3.184910e+07&lt;/td&gt;
      &lt;td&gt;1.592455e+08&lt;/td&gt;
      &lt;td&gt;7.962276e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;IRN&lt;/td&gt;
      &lt;td&gt;Iran (Islamic Republic of)&lt;/td&gt;
      &lt;td&gt;8.774407e+04&lt;/td&gt;
      &lt;td&gt;9.180121e+04&lt;/td&gt;
      &lt;td&gt;9.620217e+04&lt;/td&gt;
      &lt;td&gt;8.875744e+04&lt;/td&gt;
      &lt;td&gt;9.500199e+04&lt;/td&gt;
      &lt;td&gt;9.600254e+04&lt;/td&gt;
      &lt;td&gt;9.053525e+04&lt;/td&gt;
      &lt;td&gt;2.193602e+06&lt;/td&gt;
      &lt;td&gt;2.295030e+06&lt;/td&gt;
      &lt;td&gt;2.405054e+06&lt;/td&gt;
      &lt;td&gt;2.218936e+06&lt;/td&gt;
      &lt;td&gt;2.375050e+06&lt;/td&gt;
      &lt;td&gt;9.190138e+04&lt;/td&gt;
      &lt;td&gt;4.595069e+05&lt;/td&gt;
      &lt;td&gt;2.297534e+06&lt;/td&gt;
      &lt;td&gt;1.148767e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;ITA&lt;/td&gt;
      &lt;td&gt;Italy&lt;/td&gt;
      &lt;td&gt;4.995968e+04&lt;/td&gt;
      &lt;td&gt;4.937785e+04&lt;/td&gt;
      &lt;td&gt;5.443679e+04&lt;/td&gt;
      &lt;td&gt;4.469902e+04&lt;/td&gt;
      &lt;td&gt;4.566914e+04&lt;/td&gt;
      &lt;td&gt;5.101547e+04&lt;/td&gt;
      &lt;td&gt;5.089759e+04&lt;/td&gt;
      &lt;td&gt;1.248992e+06&lt;/td&gt;
      &lt;td&gt;1.234446e+06&lt;/td&gt;
      &lt;td&gt;1.360920e+06&lt;/td&gt;
      &lt;td&gt;1.117475e+06&lt;/td&gt;
      &lt;td&gt;1.141729e+06&lt;/td&gt;
      &lt;td&gt;4.882850e+04&lt;/td&gt;
      &lt;td&gt;2.441425e+05&lt;/td&gt;
      &lt;td&gt;1.220712e+06&lt;/td&gt;
      &lt;td&gt;6.103562e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;JPN&lt;/td&gt;
      &lt;td&gt;Japan&lt;/td&gt;
      &lt;td&gt;2.305465e+05&lt;/td&gt;
      &lt;td&gt;2.284133e+05&lt;/td&gt;
      &lt;td&gt;2.708935e+05&lt;/td&gt;
      &lt;td&gt;1.548252e+05&lt;/td&gt;
      &lt;td&gt;2.332056e+05&lt;/td&gt;
      &lt;td&gt;2.835167e+05&lt;/td&gt;
      &lt;td&gt;1.574007e+05&lt;/td&gt;
      &lt;td&gt;5.763662e+06&lt;/td&gt;
      &lt;td&gt;5.710333e+06&lt;/td&gt;
      &lt;td&gt;6.772337e+06&lt;/td&gt;
      &lt;td&gt;3.870631e+06&lt;/td&gt;
      &lt;td&gt;5.830141e+06&lt;/td&gt;
      &lt;td&gt;2.235768e+05&lt;/td&gt;
      &lt;td&gt;1.117884e+06&lt;/td&gt;
      &lt;td&gt;5.589421e+06&lt;/td&gt;
      &lt;td&gt;2.794710e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;KHM&lt;/td&gt;
      &lt;td&gt;Cambodia&lt;/td&gt;
      &lt;td&gt;4.954698e+05&lt;/td&gt;
      &lt;td&gt;5.731698e+05&lt;/td&gt;
      &lt;td&gt;4.517045e+05&lt;/td&gt;
      &lt;td&gt;5.592610e+05&lt;/td&gt;
      &lt;td&gt;5.947277e+05&lt;/td&gt;
      &lt;td&gt;6.412802e+05&lt;/td&gt;
      &lt;td&gt;5.644891e+05&lt;/td&gt;
      &lt;td&gt;1.238675e+07&lt;/td&gt;
      &lt;td&gt;1.432925e+07&lt;/td&gt;
      &lt;td&gt;1.129261e+07&lt;/td&gt;
      &lt;td&gt;1.398153e+07&lt;/td&gt;
      &lt;td&gt;1.486819e+07&lt;/td&gt;
      &lt;td&gt;5.348666e+05&lt;/td&gt;
      &lt;td&gt;2.674333e+06&lt;/td&gt;
      &lt;td&gt;1.337166e+07&lt;/td&gt;
      &lt;td&gt;6.685832e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;KOR&lt;/td&gt;
      &lt;td&gt;Korea (the Republic of)&lt;/td&gt;
      &lt;td&gt;1.451878e+05&lt;/td&gt;
      &lt;td&gt;1.274597e+05&lt;/td&gt;
      &lt;td&gt;1.463222e+05&lt;/td&gt;
      &lt;td&gt;1.293543e+05&lt;/td&gt;
      &lt;td&gt;1.327782e+05&lt;/td&gt;
      &lt;td&gt;1.165467e+05&lt;/td&gt;
      &lt;td&gt;1.013006e+05&lt;/td&gt;
      &lt;td&gt;3.629695e+06&lt;/td&gt;
      &lt;td&gt;3.186493e+06&lt;/td&gt;
      &lt;td&gt;3.658056e+06&lt;/td&gt;
      &lt;td&gt;3.233858e+06&lt;/td&gt;
      &lt;td&gt;3.319455e+06&lt;/td&gt;
      &lt;td&gt;1.362205e+05&lt;/td&gt;
      &lt;td&gt;6.811023e+05&lt;/td&gt;
      &lt;td&gt;3.405512e+06&lt;/td&gt;
      &lt;td&gt;1.702756e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;LAO&lt;/td&gt;
      &lt;td&gt;Lao People&#39;s Democratic Republic (the)&lt;/td&gt;
      &lt;td&gt;1.661169e+04&lt;/td&gt;
      &lt;td&gt;1.696441e+04&lt;/td&gt;
      &lt;td&gt;1.168063e+04&lt;/td&gt;
      &lt;td&gt;1.009675e+04&lt;/td&gt;
      &lt;td&gt;1.461058e+04&lt;/td&gt;
      &lt;td&gt;2.136270e+04&lt;/td&gt;
      &lt;td&gt;1.475014e+04&lt;/td&gt;
      &lt;td&gt;4.152924e+05&lt;/td&gt;
      &lt;td&gt;4.241102e+05&lt;/td&gt;
      &lt;td&gt;2.920158e+05&lt;/td&gt;
      &lt;td&gt;2.524186e+05&lt;/td&gt;
      &lt;td&gt;3.652645e+05&lt;/td&gt;
      &lt;td&gt;1.399281e+04&lt;/td&gt;
      &lt;td&gt;6.996406e+04&lt;/td&gt;
      &lt;td&gt;3.498203e+05&lt;/td&gt;
      &lt;td&gt;1.749102e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;LKA&lt;/td&gt;
      &lt;td&gt;Sri Lanka&lt;/td&gt;
      &lt;td&gt;8.305626e+04&lt;/td&gt;
      &lt;td&gt;1.011743e+05&lt;/td&gt;
      &lt;td&gt;5.911841e+04&lt;/td&gt;
      &lt;td&gt;9.018914e+04&lt;/td&gt;
      &lt;td&gt;8.476088e+04&lt;/td&gt;
      &lt;td&gt;9.248238e+04&lt;/td&gt;
      &lt;td&gt;8.466966e+04&lt;/td&gt;
      &lt;td&gt;2.076407e+06&lt;/td&gt;
      &lt;td&gt;2.529358e+06&lt;/td&gt;
      &lt;td&gt;1.477960e+06&lt;/td&gt;
      &lt;td&gt;2.254728e+06&lt;/td&gt;
      &lt;td&gt;2.119022e+06&lt;/td&gt;
      &lt;td&gt;8.365981e+04&lt;/td&gt;
      &lt;td&gt;4.182990e+05&lt;/td&gt;
      &lt;td&gt;2.091495e+06&lt;/td&gt;
      &lt;td&gt;1.045748e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;MMR&lt;/td&gt;
      &lt;td&gt;Myanmar&lt;/td&gt;
      &lt;td&gt;1.132082e+06&lt;/td&gt;
      &lt;td&gt;1.290806e+06&lt;/td&gt;
      &lt;td&gt;1.205169e+06&lt;/td&gt;
      &lt;td&gt;1.372447e+06&lt;/td&gt;
      &lt;td&gt;1.256888e+06&lt;/td&gt;
      &lt;td&gt;1.221904e+06&lt;/td&gt;
      &lt;td&gt;1.289837e+06&lt;/td&gt;
      &lt;td&gt;2.830206e+07&lt;/td&gt;
      &lt;td&gt;3.227014e+07&lt;/td&gt;
      &lt;td&gt;3.012923e+07&lt;/td&gt;
      &lt;td&gt;3.431117e+07&lt;/td&gt;
      &lt;td&gt;3.142221e+07&lt;/td&gt;
      &lt;td&gt;1.251478e+06&lt;/td&gt;
      &lt;td&gt;6.257392e+06&lt;/td&gt;
      &lt;td&gt;3.128696e+07&lt;/td&gt;
      &lt;td&gt;1.564348e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;MYS&lt;/td&gt;
      &lt;td&gt;Malaysia&lt;/td&gt;
      &lt;td&gt;1.057399e+05&lt;/td&gt;
      &lt;td&gt;1.110049e+05&lt;/td&gt;
      &lt;td&gt;1.111291e+05&lt;/td&gt;
      &lt;td&gt;1.066525e+05&lt;/td&gt;
      &lt;td&gt;1.056287e+05&lt;/td&gt;
      &lt;td&gt;1.127141e+05&lt;/td&gt;
      &lt;td&gt;1.069696e+05&lt;/td&gt;
      &lt;td&gt;2.643498e+06&lt;/td&gt;
      &lt;td&gt;2.775123e+06&lt;/td&gt;
      &lt;td&gt;2.778227e+06&lt;/td&gt;
      &lt;td&gt;2.666313e+06&lt;/td&gt;
      &lt;td&gt;2.640717e+06&lt;/td&gt;
      &lt;td&gt;1.080310e+05&lt;/td&gt;
      &lt;td&gt;5.401551e+05&lt;/td&gt;
      &lt;td&gt;2.700775e+06&lt;/td&gt;
      &lt;td&gt;1.350388e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;NPL&lt;/td&gt;
      &lt;td&gt;Nepal&lt;/td&gt;
      &lt;td&gt;1.007479e+05&lt;/td&gt;
      &lt;td&gt;6.667161e+04&lt;/td&gt;
      &lt;td&gt;8.081300e+04&lt;/td&gt;
      &lt;td&gt;9.200752e+04&lt;/td&gt;
      &lt;td&gt;1.164235e+05&lt;/td&gt;
      &lt;td&gt;7.168401e+04&lt;/td&gt;
      &lt;td&gt;4.811408e+04&lt;/td&gt;
      &lt;td&gt;2.518697e+06&lt;/td&gt;
      &lt;td&gt;1.666790e+06&lt;/td&gt;
      &lt;td&gt;2.020325e+06&lt;/td&gt;
      &lt;td&gt;2.300188e+06&lt;/td&gt;
      &lt;td&gt;2.910588e+06&lt;/td&gt;
      &lt;td&gt;9.133271e+04&lt;/td&gt;
      &lt;td&gt;4.566635e+05&lt;/td&gt;
      &lt;td&gt;2.283318e+06&lt;/td&gt;
      &lt;td&gt;1.141659e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;PAK&lt;/td&gt;
      &lt;td&gt;Pakistan&lt;/td&gt;
      &lt;td&gt;4.852431e+05&lt;/td&gt;
      &lt;td&gt;5.945922e+05&lt;/td&gt;
      &lt;td&gt;5.372641e+05&lt;/td&gt;
      &lt;td&gt;4.532297e+05&lt;/td&gt;
      &lt;td&gt;6.528548e+05&lt;/td&gt;
      &lt;td&gt;6.401201e+05&lt;/td&gt;
      &lt;td&gt;4.849205e+05&lt;/td&gt;
      &lt;td&gt;1.213108e+07&lt;/td&gt;
      &lt;td&gt;1.486480e+07&lt;/td&gt;
      &lt;td&gt;1.343160e+07&lt;/td&gt;
      &lt;td&gt;1.133074e+07&lt;/td&gt;
      &lt;td&gt;1.632137e+07&lt;/td&gt;
      &lt;td&gt;5.446368e+05&lt;/td&gt;
      &lt;td&gt;2.723184e+06&lt;/td&gt;
      &lt;td&gt;1.361592e+07&lt;/td&gt;
      &lt;td&gt;6.807960e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;PHL&lt;/td&gt;
      &lt;td&gt;Philippines (the)&lt;/td&gt;
      &lt;td&gt;3.432021e+05&lt;/td&gt;
      &lt;td&gt;4.073554e+05&lt;/td&gt;
      &lt;td&gt;3.836830e+05&lt;/td&gt;
      &lt;td&gt;4.175210e+05&lt;/td&gt;
      &lt;td&gt;3.584550e+05&lt;/td&gt;
      &lt;td&gt;4.462836e+05&lt;/td&gt;
      &lt;td&gt;4.383270e+05&lt;/td&gt;
      &lt;td&gt;8.580052e+06&lt;/td&gt;
      &lt;td&gt;1.018389e+07&lt;/td&gt;
      &lt;td&gt;9.592074e+06&lt;/td&gt;
      &lt;td&gt;1.043803e+07&lt;/td&gt;
      &lt;td&gt;8.961374e+06&lt;/td&gt;
      &lt;td&gt;3.820433e+05&lt;/td&gt;
      &lt;td&gt;1.910216e+06&lt;/td&gt;
      &lt;td&gt;9.551082e+06&lt;/td&gt;
      &lt;td&gt;4.775541e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;PRK&lt;/td&gt;
      &lt;td&gt;Korea (the Democratic People&#39;s Republic of)&lt;/td&gt;
      &lt;td&gt;1.143217e+05&lt;/td&gt;
      &lt;td&gt;9.177653e+04&lt;/td&gt;
      &lt;td&gt;1.085457e+05&lt;/td&gt;
      &lt;td&gt;8.662578e+04&lt;/td&gt;
      &lt;td&gt;9.655062e+04&lt;/td&gt;
      &lt;td&gt;8.581038e+04&lt;/td&gt;
      &lt;td&gt;7.735988e+04&lt;/td&gt;
      &lt;td&gt;2.858041e+06&lt;/td&gt;
      &lt;td&gt;2.294413e+06&lt;/td&gt;
      &lt;td&gt;2.713641e+06&lt;/td&gt;
      &lt;td&gt;2.165645e+06&lt;/td&gt;
      &lt;td&gt;2.413765e+06&lt;/td&gt;
      &lt;td&gt;9.956405e+04&lt;/td&gt;
      &lt;td&gt;4.978202e+05&lt;/td&gt;
      &lt;td&gt;2.489101e+06&lt;/td&gt;
      &lt;td&gt;1.244551e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;THA&lt;/td&gt;
      &lt;td&gt;Thailand&lt;/td&gt;
      &lt;td&gt;1.393798e+06&lt;/td&gt;
      &lt;td&gt;1.780993e+06&lt;/td&gt;
      &lt;td&gt;1.164699e+06&lt;/td&gt;
      &lt;td&gt;9.166575e+05&lt;/td&gt;
      &lt;td&gt;1.305046e+06&lt;/td&gt;
      &lt;td&gt;1.520788e+06&lt;/td&gt;
      &lt;td&gt;8.528673e+05&lt;/td&gt;
      &lt;td&gt;3.484495e+07&lt;/td&gt;
      &lt;td&gt;4.452483e+07&lt;/td&gt;
      &lt;td&gt;2.911748e+07&lt;/td&gt;
      &lt;td&gt;2.291644e+07&lt;/td&gt;
      &lt;td&gt;3.262615e+07&lt;/td&gt;
      &lt;td&gt;1.312239e+06&lt;/td&gt;
      &lt;td&gt;6.561194e+06&lt;/td&gt;
      &lt;td&gt;3.280597e+07&lt;/td&gt;
      &lt;td&gt;1.640298e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;20&lt;/th&gt;
      &lt;td&gt;TWN&lt;/td&gt;
      &lt;td&gt;Taiwan (Province of China)&lt;/td&gt;
      &lt;td&gt;7.866956e+04&lt;/td&gt;
      &lt;td&gt;8.089149e+04&lt;/td&gt;
      &lt;td&gt;8.705634e+04&lt;/td&gt;
      &lt;td&gt;8.138151e+04&lt;/td&gt;
      &lt;td&gt;8.990870e+04&lt;/td&gt;
      &lt;td&gt;8.333327e+04&lt;/td&gt;
      &lt;td&gt;6.619861e+04&lt;/td&gt;
      &lt;td&gt;1.966739e+06&lt;/td&gt;
      &lt;td&gt;2.022287e+06&lt;/td&gt;
      &lt;td&gt;2.176408e+06&lt;/td&gt;
      &lt;td&gt;2.034538e+06&lt;/td&gt;
      &lt;td&gt;2.247717e+06&lt;/td&gt;
      &lt;td&gt;8.358152e+04&lt;/td&gt;
      &lt;td&gt;4.179076e+05&lt;/td&gt;
      &lt;td&gt;2.089538e+06&lt;/td&gt;
      &lt;td&gt;1.044769e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;21&lt;/th&gt;
      &lt;td&gt;USA&lt;/td&gt;
      &lt;td&gt;United States of America (the)&lt;/td&gt;
      &lt;td&gt;1.611324e+05&lt;/td&gt;
      &lt;td&gt;1.618576e+05&lt;/td&gt;
      &lt;td&gt;1.684799e+05&lt;/td&gt;
      &lt;td&gt;1.657254e+05&lt;/td&gt;
      &lt;td&gt;1.691351e+05&lt;/td&gt;
      &lt;td&gt;1.941455e+05&lt;/td&gt;
      &lt;td&gt;1.634842e+05&lt;/td&gt;
      &lt;td&gt;4.028310e+06&lt;/td&gt;
      &lt;td&gt;4.046440e+06&lt;/td&gt;
      &lt;td&gt;4.211999e+06&lt;/td&gt;
      &lt;td&gt;4.143136e+06&lt;/td&gt;
      &lt;td&gt;4.228377e+06&lt;/td&gt;
      &lt;td&gt;1.652661e+05&lt;/td&gt;
      &lt;td&gt;8.263305e+05&lt;/td&gt;
      &lt;td&gt;4.131652e+06&lt;/td&gt;
      &lt;td&gt;2.065826e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22&lt;/th&gt;
      &lt;td&gt;VNM&lt;/td&gt;
      &lt;td&gt;Viet Nam&lt;/td&gt;
      &lt;td&gt;1.346013e+06&lt;/td&gt;
      &lt;td&gt;1.483777e+06&lt;/td&gt;
      &lt;td&gt;1.406437e+06&lt;/td&gt;
      &lt;td&gt;1.317455e+06&lt;/td&gt;
      &lt;td&gt;1.269751e+06&lt;/td&gt;
      &lt;td&gt;1.374450e+06&lt;/td&gt;
      &lt;td&gt;1.502787e+06&lt;/td&gt;
      &lt;td&gt;3.365033e+07&lt;/td&gt;
      &lt;td&gt;3.709441e+07&lt;/td&gt;
      &lt;td&gt;3.516092e+07&lt;/td&gt;
      &lt;td&gt;3.293637e+07&lt;/td&gt;
      &lt;td&gt;3.174377e+07&lt;/td&gt;
      &lt;td&gt;1.364686e+06&lt;/td&gt;
      &lt;td&gt;6.823432e+06&lt;/td&gt;
      &lt;td&gt;3.411716e+07&lt;/td&gt;
      &lt;td&gt;1.705858e+08&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;merged_df &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; faostat_emissions_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;merge(malaysia_emissions_df,suffixes&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;_FAOSTAT&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;_TRACE&amp;#39;&lt;/span&gt;), on&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;iso3_country&amp;#39;&lt;/span&gt;, how&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;left&amp;#39;&lt;/span&gt;, sort&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;dropping-2020-and-2021-from-the-data-sets&#34; &gt;Dropping 2020 and 2021 from the data sets
&lt;span&gt;
    &lt;a href=&#34;#dropping-2020-and-2021-from-the-data-sets&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;p&gt;I will only compare data compiled from the same year.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;merged_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;drop([&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2021&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;tCH4_2020&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;tCH4_2021&amp;#34;&lt;/span&gt;], axis &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, inplace &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;merged_df
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div style=&#34;overflow-x:auto;&#34;&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;iso3_country&lt;/th&gt;
      &lt;th&gt;country_name_FAOSTAT&lt;/th&gt;
      &lt;th&gt;2015&lt;/th&gt;
      &lt;th&gt;2016&lt;/th&gt;
      &lt;th&gt;2017&lt;/th&gt;
      &lt;th&gt;2018&lt;/th&gt;
      &lt;th&gt;2019&lt;/th&gt;
      &lt;th&gt;tCO2_2015_FAOSTAT&lt;/th&gt;
      &lt;th&gt;tCO2_2016_FAOSTAT&lt;/th&gt;
      &lt;th&gt;tCO2_2017_FAOSTAT&lt;/th&gt;
      &lt;th&gt;...&lt;/th&gt;
      &lt;th&gt;tCH4_2019&lt;/th&gt;
      &lt;th&gt;tCO2_2015_TRACE&lt;/th&gt;
      &lt;th&gt;tCO2_2016_TRACE&lt;/th&gt;
      &lt;th&gt;tCO2_2017_TRACE&lt;/th&gt;
      &lt;th&gt;tCO2_2018_TRACE&lt;/th&gt;
      &lt;th&gt;tCO2_2019_TRACE&lt;/th&gt;
      &lt;th&gt;Mean_CH4_TRACE&lt;/th&gt;
      &lt;th&gt;Total_CH4_TRACE&lt;/th&gt;
      &lt;th&gt;Mean_CO2_TRACE&lt;/th&gt;
      &lt;th&gt;Total_CO2_TRACE&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;BGD&lt;/td&gt;
      &lt;td&gt;Bangladesh&lt;/td&gt;
      &lt;td&gt;1131293.4&lt;/td&gt;
      &lt;td&gt;1093480.4&lt;/td&gt;
      &lt;td&gt;1154531.0&lt;/td&gt;
      &lt;td&gt;1144591.0&lt;/td&gt;
      &lt;td&gt;1144745.4&lt;/td&gt;
      &lt;td&gt;28282335.0&lt;/td&gt;
      &lt;td&gt;27337010.0&lt;/td&gt;
      &lt;td&gt;28863275.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;2.070985e+06&lt;/td&gt;
      &lt;td&gt;5.861049e+07&lt;/td&gt;
      &lt;td&gt;5.695395e+07&lt;/td&gt;
      &lt;td&gt;5.247394e+07&lt;/td&gt;
      &lt;td&gt;5.353076e+07&lt;/td&gt;
      &lt;td&gt;5.177463e+07&lt;/td&gt;
      &lt;td&gt;2.186750e+06&lt;/td&gt;
      &lt;td&gt;1.093375e+07&lt;/td&gt;
      &lt;td&gt;5.466875e+07&lt;/td&gt;
      &lt;td&gt;2.733438e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;BRA&lt;/td&gt;
      &lt;td&gt;Brazil&lt;/td&gt;
      &lt;td&gt;138910.3&lt;/td&gt;
      &lt;td&gt;126278.2&lt;/td&gt;
      &lt;td&gt;130322.9&lt;/td&gt;
      &lt;td&gt;121615.2&lt;/td&gt;
      &lt;td&gt;111084.8&lt;/td&gt;
      &lt;td&gt;3472757.5&lt;/td&gt;
      &lt;td&gt;3156955.0&lt;/td&gt;
      &lt;td&gt;3258072.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;3.294713e+05&lt;/td&gt;
      &lt;td&gt;8.525583e+06&lt;/td&gt;
      &lt;td&gt;7.760473e+06&lt;/td&gt;
      &lt;td&gt;9.312934e+06&lt;/td&gt;
      &lt;td&gt;9.292575e+06&lt;/td&gt;
      &lt;td&gt;8.236783e+06&lt;/td&gt;
      &lt;td&gt;3.450268e+05&lt;/td&gt;
      &lt;td&gt;1.725134e+06&lt;/td&gt;
      &lt;td&gt;8.625670e+06&lt;/td&gt;
      &lt;td&gt;4.312835e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;CHN&lt;/td&gt;
      &lt;td&gt;China&lt;/td&gt;
      &lt;td&gt;5406593.9&lt;/td&gt;
      &lt;td&gt;5399920.0&lt;/td&gt;
      &lt;td&gt;5400129.0&lt;/td&gt;
      &lt;td&gt;5302173.1&lt;/td&gt;
      &lt;td&gt;5214454.7&lt;/td&gt;
      &lt;td&gt;135164847.5&lt;/td&gt;
      &lt;td&gt;134998000.0&lt;/td&gt;
      &lt;td&gt;135003225.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;5.603352e+06&lt;/td&gt;
      &lt;td&gt;1.533412e+08&lt;/td&gt;
      &lt;td&gt;1.464883e+08&lt;/td&gt;
      &lt;td&gt;1.588768e+08&lt;/td&gt;
      &lt;td&gt;1.353491e+08&lt;/td&gt;
      &lt;td&gt;1.400838e+08&lt;/td&gt;
      &lt;td&gt;5.873113e+06&lt;/td&gt;
      &lt;td&gt;2.936556e+07&lt;/td&gt;
      &lt;td&gt;1.468278e+08&lt;/td&gt;
      &lt;td&gt;7.341391e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;ESP&lt;/td&gt;
      &lt;td&gt;Spain&lt;/td&gt;
      &lt;td&gt;55082.2&lt;/td&gt;
      &lt;td&gt;55073.1&lt;/td&gt;
      &lt;td&gt;54232.4&lt;/td&gt;
      &lt;td&gt;52925.0&lt;/td&gt;
      &lt;td&gt;52098.5&lt;/td&gt;
      &lt;td&gt;1377055.0&lt;/td&gt;
      &lt;td&gt;1376827.5&lt;/td&gt;
      &lt;td&gt;1355810.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;1.148324e+04&lt;/td&gt;
      &lt;td&gt;2.853661e+05&lt;/td&gt;
      &lt;td&gt;3.337007e+05&lt;/td&gt;
      &lt;td&gt;3.043248e+05&lt;/td&gt;
      &lt;td&gt;3.513524e+05&lt;/td&gt;
      &lt;td&gt;2.870810e+05&lt;/td&gt;
      &lt;td&gt;1.249460e+04&lt;/td&gt;
      &lt;td&gt;6.247300e+04&lt;/td&gt;
      &lt;td&gt;3.123650e+05&lt;/td&gt;
      &lt;td&gt;1.561825e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;IDN&lt;/td&gt;
      &lt;td&gt;Indonesia&lt;/td&gt;
      &lt;td&gt;2407953.5&lt;/td&gt;
      &lt;td&gt;2387656.4&lt;/td&gt;
      &lt;td&gt;2425290.6&lt;/td&gt;
      &lt;td&gt;2405613.8&lt;/td&gt;
      &lt;td&gt;2257604.3&lt;/td&gt;
      &lt;td&gt;60198837.5&lt;/td&gt;
      &lt;td&gt;59691410.0&lt;/td&gt;
      &lt;td&gt;60632265.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;1.266668e+06&lt;/td&gt;
      &lt;td&gt;3.209122e+07&lt;/td&gt;
      &lt;td&gt;2.557824e+07&lt;/td&gt;
      &lt;td&gt;2.403832e+07&lt;/td&gt;
      &lt;td&gt;2.942454e+07&lt;/td&gt;
      &lt;td&gt;3.166670e+07&lt;/td&gt;
      &lt;td&gt;1.142392e+06&lt;/td&gt;
      &lt;td&gt;5.711960e+06&lt;/td&gt;
      &lt;td&gt;2.855980e+07&lt;/td&gt;
      &lt;td&gt;1.427990e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;IND&lt;/td&gt;
      &lt;td&gt;India&lt;/td&gt;
      &lt;td&gt;4580248.4&lt;/td&gt;
      &lt;td&gt;4559136.4&lt;/td&gt;
      &lt;td&gt;4620790.8&lt;/td&gt;
      &lt;td&gt;4661154.9&lt;/td&gt;
      &lt;td&gt;4621416.8&lt;/td&gt;
      &lt;td&gt;114506210.0&lt;/td&gt;
      &lt;td&gt;113978410.0&lt;/td&gt;
      &lt;td&gt;115519770.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;7.501556e+06&lt;/td&gt;
      &lt;td&gt;1.554972e+08&lt;/td&gt;
      &lt;td&gt;1.327353e+08&lt;/td&gt;
      &lt;td&gt;1.557113e+08&lt;/td&gt;
      &lt;td&gt;1.647450e+08&lt;/td&gt;
      &lt;td&gt;1.875389e+08&lt;/td&gt;
      &lt;td&gt;6.369821e+06&lt;/td&gt;
      &lt;td&gt;3.184910e+07&lt;/td&gt;
      &lt;td&gt;1.592455e+08&lt;/td&gt;
      &lt;td&gt;7.962276e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;IRN&lt;/td&gt;
      &lt;td&gt;Iran (Islamic Republic of)&lt;/td&gt;
      &lt;td&gt;116486.7&lt;/td&gt;
      &lt;td&gt;131008.5&lt;/td&gt;
      &lt;td&gt;87233.6&lt;/td&gt;
      &lt;td&gt;93936.6&lt;/td&gt;
      &lt;td&gt;96103.4&lt;/td&gt;
      &lt;td&gt;2912167.5&lt;/td&gt;
      &lt;td&gt;3275212.5&lt;/td&gt;
      &lt;td&gt;2180840.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;9.500199e+04&lt;/td&gt;
      &lt;td&gt;2.193602e+06&lt;/td&gt;
      &lt;td&gt;2.295030e+06&lt;/td&gt;
      &lt;td&gt;2.405054e+06&lt;/td&gt;
      &lt;td&gt;2.218936e+06&lt;/td&gt;
      &lt;td&gt;2.375050e+06&lt;/td&gt;
      &lt;td&gt;9.190138e+04&lt;/td&gt;
      &lt;td&gt;4.595069e+05&lt;/td&gt;
      &lt;td&gt;2.297534e+06&lt;/td&gt;
      &lt;td&gt;1.148767e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;ITA&lt;/td&gt;
      &lt;td&gt;Italy&lt;/td&gt;
      &lt;td&gt;114574.8&lt;/td&gt;
      &lt;td&gt;118003.0&lt;/td&gt;
      &lt;td&gt;118003.0&lt;/td&gt;
      &lt;td&gt;109463.8&lt;/td&gt;
      &lt;td&gt;110895.1&lt;/td&gt;
      &lt;td&gt;2864370.0&lt;/td&gt;
      &lt;td&gt;2950075.0&lt;/td&gt;
      &lt;td&gt;2950075.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;4.566914e+04&lt;/td&gt;
      &lt;td&gt;1.248992e+06&lt;/td&gt;
      &lt;td&gt;1.234446e+06&lt;/td&gt;
      &lt;td&gt;1.360920e+06&lt;/td&gt;
      &lt;td&gt;1.117475e+06&lt;/td&gt;
      &lt;td&gt;1.141729e+06&lt;/td&gt;
      &lt;td&gt;4.882850e+04&lt;/td&gt;
      &lt;td&gt;2.441425e+05&lt;/td&gt;
      &lt;td&gt;1.220712e+06&lt;/td&gt;
      &lt;td&gt;6.103562e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;JPN&lt;/td&gt;
      &lt;td&gt;Japan&lt;/td&gt;
      &lt;td&gt;330353.1&lt;/td&gt;
      &lt;td&gt;326403.0&lt;/td&gt;
      &lt;td&gt;323700.3&lt;/td&gt;
      &lt;td&gt;322245.0&lt;/td&gt;
      &lt;td&gt;320581.8&lt;/td&gt;
      &lt;td&gt;8258827.5&lt;/td&gt;
      &lt;td&gt;8160075.0&lt;/td&gt;
      &lt;td&gt;8092507.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;2.332056e+05&lt;/td&gt;
      &lt;td&gt;5.763662e+06&lt;/td&gt;
      &lt;td&gt;5.710333e+06&lt;/td&gt;
      &lt;td&gt;6.772337e+06&lt;/td&gt;
      &lt;td&gt;3.870631e+06&lt;/td&gt;
      &lt;td&gt;5.830141e+06&lt;/td&gt;
      &lt;td&gt;2.235768e+05&lt;/td&gt;
      &lt;td&gt;1.117884e+06&lt;/td&gt;
      &lt;td&gt;5.589421e+06&lt;/td&gt;
      &lt;td&gt;2.794710e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;KHM&lt;/td&gt;
      &lt;td&gt;Cambodia&lt;/td&gt;
      &lt;td&gt;436826.0&lt;/td&gt;
      &lt;td&gt;459003.1&lt;/td&gt;
      &lt;td&gt;473745.3&lt;/td&gt;
      &lt;td&gt;479362.7&lt;/td&gt;
      &lt;td&gt;468378.9&lt;/td&gt;
      &lt;td&gt;10920650.0&lt;/td&gt;
      &lt;td&gt;11475077.5&lt;/td&gt;
      &lt;td&gt;11843632.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;5.947277e+05&lt;/td&gt;
      &lt;td&gt;1.238675e+07&lt;/td&gt;
      &lt;td&gt;1.432925e+07&lt;/td&gt;
      &lt;td&gt;1.129261e+07&lt;/td&gt;
      &lt;td&gt;1.398153e+07&lt;/td&gt;
      &lt;td&gt;1.486819e+07&lt;/td&gt;
      &lt;td&gt;5.348666e+05&lt;/td&gt;
      &lt;td&gt;2.674333e+06&lt;/td&gt;
      &lt;td&gt;1.337166e+07&lt;/td&gt;
      &lt;td&gt;6.685832e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;KOR&lt;/td&gt;
      &lt;td&gt;Korea (the Republic of)&lt;/td&gt;
      &lt;td&gt;167862.2&lt;/td&gt;
      &lt;td&gt;163534.1&lt;/td&gt;
      &lt;td&gt;158489.7&lt;/td&gt;
      &lt;td&gt;154911.3&lt;/td&gt;
      &lt;td&gt;153260.9&lt;/td&gt;
      &lt;td&gt;4196555.0&lt;/td&gt;
      &lt;td&gt;4088352.5&lt;/td&gt;
      &lt;td&gt;3962242.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;1.327782e+05&lt;/td&gt;
      &lt;td&gt;3.629695e+06&lt;/td&gt;
      &lt;td&gt;3.186493e+06&lt;/td&gt;
      &lt;td&gt;3.658056e+06&lt;/td&gt;
      &lt;td&gt;3.233858e+06&lt;/td&gt;
      &lt;td&gt;3.319455e+06&lt;/td&gt;
      &lt;td&gt;1.362205e+05&lt;/td&gt;
      &lt;td&gt;6.811023e+05&lt;/td&gt;
      &lt;td&gt;3.405512e+06&lt;/td&gt;
      &lt;td&gt;1.702756e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;LAO&lt;/td&gt;
      &lt;td&gt;Lao People&#39;s Democratic Republic (the)&lt;/td&gt;
      &lt;td&gt;94826.8&lt;/td&gt;
      &lt;td&gt;95630.0&lt;/td&gt;
      &lt;td&gt;93940.7&lt;/td&gt;
      &lt;td&gt;83333.6&lt;/td&gt;
      &lt;td&gt;77005.5&lt;/td&gt;
      &lt;td&gt;2370670.0&lt;/td&gt;
      &lt;td&gt;2390750.0&lt;/td&gt;
      &lt;td&gt;2348517.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;1.461058e+04&lt;/td&gt;
      &lt;td&gt;4.152924e+05&lt;/td&gt;
      &lt;td&gt;4.241102e+05&lt;/td&gt;
      &lt;td&gt;2.920158e+05&lt;/td&gt;
      &lt;td&gt;2.524186e+05&lt;/td&gt;
      &lt;td&gt;3.652645e+05&lt;/td&gt;
      &lt;td&gt;1.399281e+04&lt;/td&gt;
      &lt;td&gt;6.996406e+04&lt;/td&gt;
      &lt;td&gt;3.498203e+05&lt;/td&gt;
      &lt;td&gt;1.749102e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;LKA&lt;/td&gt;
      &lt;td&gt;Sri Lanka&lt;/td&gt;
      &lt;td&gt;132640.0&lt;/td&gt;
      &lt;td&gt;121756.3&lt;/td&gt;
      &lt;td&gt;84456.3&lt;/td&gt;
      &lt;td&gt;111049.0&lt;/td&gt;
      &lt;td&gt;102156.3&lt;/td&gt;
      &lt;td&gt;3316000.0&lt;/td&gt;
      &lt;td&gt;3043907.5&lt;/td&gt;
      &lt;td&gt;2111407.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;8.476088e+04&lt;/td&gt;
      &lt;td&gt;2.076407e+06&lt;/td&gt;
      &lt;td&gt;2.529358e+06&lt;/td&gt;
      &lt;td&gt;1.477960e+06&lt;/td&gt;
      &lt;td&gt;2.254728e+06&lt;/td&gt;
      &lt;td&gt;2.119022e+06&lt;/td&gt;
      &lt;td&gt;8.365981e+04&lt;/td&gt;
      &lt;td&gt;4.182990e+05&lt;/td&gt;
      &lt;td&gt;2.091495e+06&lt;/td&gt;
      &lt;td&gt;1.045748e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;MMR&lt;/td&gt;
      &lt;td&gt;Myanmar&lt;/td&gt;
      &lt;td&gt;1059409.6&lt;/td&gt;
      &lt;td&gt;1052287.7&lt;/td&gt;
      &lt;td&gt;1087029.5&lt;/td&gt;
      &lt;td&gt;1118850.0&lt;/td&gt;
      &lt;td&gt;1083100.3&lt;/td&gt;
      &lt;td&gt;26485240.0&lt;/td&gt;
      &lt;td&gt;26307192.5&lt;/td&gt;
      &lt;td&gt;27175737.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;1.256888e+06&lt;/td&gt;
      &lt;td&gt;2.830206e+07&lt;/td&gt;
      &lt;td&gt;3.227014e+07&lt;/td&gt;
      &lt;td&gt;3.012923e+07&lt;/td&gt;
      &lt;td&gt;3.431117e+07&lt;/td&gt;
      &lt;td&gt;3.142221e+07&lt;/td&gt;
      &lt;td&gt;1.251478e+06&lt;/td&gt;
      &lt;td&gt;6.257392e+06&lt;/td&gt;
      &lt;td&gt;3.128696e+07&lt;/td&gt;
      &lt;td&gt;1.564348e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;MYS&lt;/td&gt;
      &lt;td&gt;Malaysia&lt;/td&gt;
      &lt;td&gt;121942.6&lt;/td&gt;
      &lt;td&gt;123232.8&lt;/td&gt;
      &lt;td&gt;122656.3&lt;/td&gt;
      &lt;td&gt;125238.5&lt;/td&gt;
      &lt;td&gt;122453.8&lt;/td&gt;
      &lt;td&gt;3048565.0&lt;/td&gt;
      &lt;td&gt;3080820.0&lt;/td&gt;
      &lt;td&gt;3066407.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;1.056287e+05&lt;/td&gt;
      &lt;td&gt;2.643498e+06&lt;/td&gt;
      &lt;td&gt;2.775123e+06&lt;/td&gt;
      &lt;td&gt;2.778227e+06&lt;/td&gt;
      &lt;td&gt;2.666313e+06&lt;/td&gt;
      &lt;td&gt;2.640717e+06&lt;/td&gt;
      &lt;td&gt;1.080310e+05&lt;/td&gt;
      &lt;td&gt;5.401551e+05&lt;/td&gt;
      &lt;td&gt;2.700775e+06&lt;/td&gt;
      &lt;td&gt;1.350388e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;NPL&lt;/td&gt;
      &lt;td&gt;Nepal&lt;/td&gt;
      &lt;td&gt;149262.2&lt;/td&gt;
      &lt;td&gt;142723.7&lt;/td&gt;
      &lt;td&gt;162574.6&lt;/td&gt;
      &lt;td&gt;153890.8&lt;/td&gt;
      &lt;td&gt;156215.4&lt;/td&gt;
      &lt;td&gt;3731555.0&lt;/td&gt;
      &lt;td&gt;3568092.5&lt;/td&gt;
      &lt;td&gt;4064365.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;1.164235e+05&lt;/td&gt;
      &lt;td&gt;2.518697e+06&lt;/td&gt;
      &lt;td&gt;1.666790e+06&lt;/td&gt;
      &lt;td&gt;2.020325e+06&lt;/td&gt;
      &lt;td&gt;2.300188e+06&lt;/td&gt;
      &lt;td&gt;2.910588e+06&lt;/td&gt;
      &lt;td&gt;9.133271e+04&lt;/td&gt;
      &lt;td&gt;4.566635e+05&lt;/td&gt;
      &lt;td&gt;2.283318e+06&lt;/td&gt;
      &lt;td&gt;1.141659e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;PAK&lt;/td&gt;
      &lt;td&gt;Pakistan&lt;/td&gt;
      &lt;td&gt;383529.3&lt;/td&gt;
      &lt;td&gt;381361.8&lt;/td&gt;
      &lt;td&gt;406083.3&lt;/td&gt;
      &lt;td&gt;393404.2&lt;/td&gt;
      &lt;td&gt;424755.1&lt;/td&gt;
      &lt;td&gt;9588232.5&lt;/td&gt;
      &lt;td&gt;9534045.0&lt;/td&gt;
      &lt;td&gt;10152082.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;6.528548e+05&lt;/td&gt;
      &lt;td&gt;1.213108e+07&lt;/td&gt;
      &lt;td&gt;1.486480e+07&lt;/td&gt;
      &lt;td&gt;1.343160e+07&lt;/td&gt;
      &lt;td&gt;1.133074e+07&lt;/td&gt;
      &lt;td&gt;1.632137e+07&lt;/td&gt;
      &lt;td&gt;5.446368e+05&lt;/td&gt;
      &lt;td&gt;2.723184e+06&lt;/td&gt;
      &lt;td&gt;1.361592e+07&lt;/td&gt;
      &lt;td&gt;6.807960e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;PHL&lt;/td&gt;
      &lt;td&gt;Philippines (the)&lt;/td&gt;
      &lt;td&gt;1557810.6&lt;/td&gt;
      &lt;td&gt;1524292.5&lt;/td&gt;
      &lt;td&gt;1609862.5&lt;/td&gt;
      &lt;td&gt;1606047.8&lt;/td&gt;
      &lt;td&gt;1556225.8&lt;/td&gt;
      &lt;td&gt;38945265.0&lt;/td&gt;
      &lt;td&gt;38107312.5&lt;/td&gt;
      &lt;td&gt;40246562.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;3.584550e+05&lt;/td&gt;
      &lt;td&gt;8.580052e+06&lt;/td&gt;
      &lt;td&gt;1.018389e+07&lt;/td&gt;
      &lt;td&gt;9.592074e+06&lt;/td&gt;
      &lt;td&gt;1.043803e+07&lt;/td&gt;
      &lt;td&gt;8.961374e+06&lt;/td&gt;
      &lt;td&gt;3.820433e+05&lt;/td&gt;
      &lt;td&gt;1.910216e+06&lt;/td&gt;
      &lt;td&gt;9.551082e+06&lt;/td&gt;
      &lt;td&gt;4.775541e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;PRK&lt;/td&gt;
      &lt;td&gt;Korea (the Democratic People&#39;s Republic of)&lt;/td&gt;
      &lt;td&gt;82823.3&lt;/td&gt;
      &lt;td&gt;83442.3&lt;/td&gt;
      &lt;td&gt;84596.2&lt;/td&gt;
      &lt;td&gt;83943.3&lt;/td&gt;
      &lt;td&gt;82937.0&lt;/td&gt;
      &lt;td&gt;2070582.5&lt;/td&gt;
      &lt;td&gt;2086057.5&lt;/td&gt;
      &lt;td&gt;2114905.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;9.655062e+04&lt;/td&gt;
      &lt;td&gt;2.858041e+06&lt;/td&gt;
      &lt;td&gt;2.294413e+06&lt;/td&gt;
      &lt;td&gt;2.713641e+06&lt;/td&gt;
      &lt;td&gt;2.165645e+06&lt;/td&gt;
      &lt;td&gt;2.413765e+06&lt;/td&gt;
      &lt;td&gt;9.956405e+04&lt;/td&gt;
      &lt;td&gt;4.978202e+05&lt;/td&gt;
      &lt;td&gt;2.489101e+06&lt;/td&gt;
      &lt;td&gt;1.244551e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;THA&lt;/td&gt;
      &lt;td&gt;Thailand&lt;/td&gt;
      &lt;td&gt;1554254.0&lt;/td&gt;
      &lt;td&gt;1703327.7&lt;/td&gt;
      &lt;td&gt;1714465.6&lt;/td&gt;
      &lt;td&gt;1702989.1&lt;/td&gt;
      &lt;td&gt;1553835.5&lt;/td&gt;
      &lt;td&gt;38856350.0&lt;/td&gt;
      &lt;td&gt;42583192.5&lt;/td&gt;
      &lt;td&gt;42861640.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;1.305046e+06&lt;/td&gt;
      &lt;td&gt;3.484495e+07&lt;/td&gt;
      &lt;td&gt;4.452483e+07&lt;/td&gt;
      &lt;td&gt;2.911748e+07&lt;/td&gt;
      &lt;td&gt;2.291644e+07&lt;/td&gt;
      &lt;td&gt;3.262615e+07&lt;/td&gt;
      &lt;td&gt;1.312239e+06&lt;/td&gt;
      &lt;td&gt;6.561194e+06&lt;/td&gt;
      &lt;td&gt;3.280597e+07&lt;/td&gt;
      &lt;td&gt;1.640298e+08&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;20&lt;/th&gt;
      &lt;td&gt;TWN&lt;/td&gt;
      &lt;td&gt;Taiwan (Province of China)&lt;/td&gt;
      &lt;td&gt;45838.7&lt;/td&gt;
      &lt;td&gt;49838.3&lt;/td&gt;
      &lt;td&gt;49991.2&lt;/td&gt;
      &lt;td&gt;49414.1&lt;/td&gt;
      &lt;td&gt;49152.0&lt;/td&gt;
      &lt;td&gt;1145967.5&lt;/td&gt;
      &lt;td&gt;1245957.5&lt;/td&gt;
      &lt;td&gt;1249780.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;8.990870e+04&lt;/td&gt;
      &lt;td&gt;1.966739e+06&lt;/td&gt;
      &lt;td&gt;2.022287e+06&lt;/td&gt;
      &lt;td&gt;2.176408e+06&lt;/td&gt;
      &lt;td&gt;2.034538e+06&lt;/td&gt;
      &lt;td&gt;2.247717e+06&lt;/td&gt;
      &lt;td&gt;8.358152e+04&lt;/td&gt;
      &lt;td&gt;4.179076e+05&lt;/td&gt;
      &lt;td&gt;2.089538e+06&lt;/td&gt;
      &lt;td&gt;1.044769e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;21&lt;/th&gt;
      &lt;td&gt;USA&lt;/td&gt;
      &lt;td&gt;United States of America (the)&lt;/td&gt;
      &lt;td&gt;364728.0&lt;/td&gt;
      &lt;td&gt;438662.0&lt;/td&gt;
      &lt;td&gt;336255.5&lt;/td&gt;
      &lt;td&gt;412177.5&lt;/td&gt;
      &lt;td&gt;350136.5&lt;/td&gt;
      &lt;td&gt;9118200.0&lt;/td&gt;
      &lt;td&gt;10966550.0&lt;/td&gt;
      &lt;td&gt;8406387.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;1.691351e+05&lt;/td&gt;
      &lt;td&gt;4.028310e+06&lt;/td&gt;
      &lt;td&gt;4.046440e+06&lt;/td&gt;
      &lt;td&gt;4.211999e+06&lt;/td&gt;
      &lt;td&gt;4.143136e+06&lt;/td&gt;
      &lt;td&gt;4.228377e+06&lt;/td&gt;
      &lt;td&gt;1.652661e+05&lt;/td&gt;
      &lt;td&gt;8.263305e+05&lt;/td&gt;
      &lt;td&gt;4.131652e+06&lt;/td&gt;
      &lt;td&gt;2.065826e+07&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22&lt;/th&gt;
      &lt;td&gt;VNM&lt;/td&gt;
      &lt;td&gt;Viet Nam&lt;/td&gt;
      &lt;td&gt;1381744.4&lt;/td&gt;
      &lt;td&gt;1365173.8&lt;/td&gt;
      &lt;td&gt;1360551.6&lt;/td&gt;
      &lt;td&gt;1336231.2&lt;/td&gt;
      &lt;td&gt;1318431.1&lt;/td&gt;
      &lt;td&gt;34543610.0&lt;/td&gt;
      &lt;td&gt;34129345.0&lt;/td&gt;
      &lt;td&gt;34013790.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;1.269751e+06&lt;/td&gt;
      &lt;td&gt;3.365033e+07&lt;/td&gt;
      &lt;td&gt;3.709441e+07&lt;/td&gt;
      &lt;td&gt;3.516092e+07&lt;/td&gt;
      &lt;td&gt;3.293637e+07&lt;/td&gt;
      &lt;td&gt;3.174377e+07&lt;/td&gt;
      &lt;td&gt;1.364686e+06&lt;/td&gt;
      &lt;td&gt;6.823432e+06&lt;/td&gt;
      &lt;td&gt;3.411716e+07&lt;/td&gt;
      &lt;td&gt;1.705858e+08&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;23 rows  31 columns&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&#34;calculate-difference-in-ch4-tonnes-between-the-estimates&#34; &gt;Calculate difference in Ch4 Tonnes Between the Estimates
&lt;span&gt;
    &lt;a href=&#34;#calculate-difference-in-ch4-tonnes-between-the-estimates&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Calculate Difference in tons&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_diff_2015&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2015&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2015&amp;#39;&lt;/span&gt;]
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_diff_2016&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2016&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2016&amp;#39;&lt;/span&gt;]
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_diff_2017&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2017&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2017&amp;#39;&lt;/span&gt;]
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_diff_2018&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2018&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2018&amp;#39;&lt;/span&gt;]
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_diff_2019&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2019&amp;#39;&lt;/span&gt;]
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_diff_means&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Mean_CH4_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Mean_CH4_TRACE&amp;#39;&lt;/span&gt;]
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_diff_totals&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total_CH4_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total_CH4_TRACE&amp;#39;&lt;/span&gt;]


&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;merged_df
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div style=&#34;overflow-x:auto;&#34;&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;iso3_country&lt;/th&gt;
      &lt;th&gt;country_name_FAOSTAT&lt;/th&gt;
      &lt;th&gt;2015&lt;/th&gt;
      &lt;th&gt;2016&lt;/th&gt;
      &lt;th&gt;2017&lt;/th&gt;
      &lt;th&gt;2018&lt;/th&gt;
      &lt;th&gt;2019&lt;/th&gt;
      &lt;th&gt;tCO2_2015_FAOSTAT&lt;/th&gt;
      &lt;th&gt;tCO2_2016_FAOSTAT&lt;/th&gt;
      &lt;th&gt;tCO2_2017_FAOSTAT&lt;/th&gt;
      &lt;th&gt;...&lt;/th&gt;
      &lt;th&gt;Total_CH4_TRACE&lt;/th&gt;
      &lt;th&gt;Mean_CO2_TRACE&lt;/th&gt;
      &lt;th&gt;Total_CO2_TRACE&lt;/th&gt;
      &lt;th&gt;CH4_diff_2015&lt;/th&gt;
      &lt;th&gt;CH4_diff_2016&lt;/th&gt;
      &lt;th&gt;CH4_diff_2017&lt;/th&gt;
      &lt;th&gt;CH4_diff_2018&lt;/th&gt;
      &lt;th&gt;CH4_diff_2019&lt;/th&gt;
      &lt;th&gt;CH4_diff_means&lt;/th&gt;
      &lt;th&gt;CH4_diff_totals&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;BGD&lt;/td&gt;
      &lt;td&gt;Bangladesh&lt;/td&gt;
      &lt;td&gt;1131293.4&lt;/td&gt;
      &lt;td&gt;1093480.4&lt;/td&gt;
      &lt;td&gt;1154531.0&lt;/td&gt;
      &lt;td&gt;1144591.0&lt;/td&gt;
      &lt;td&gt;1144745.4&lt;/td&gt;
      &lt;td&gt;28282335.0&lt;/td&gt;
      &lt;td&gt;27337010.0&lt;/td&gt;
      &lt;td&gt;28863275.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;1.093375e+07&lt;/td&gt;
      &lt;td&gt;5.466875e+07&lt;/td&gt;
      &lt;td&gt;2.733438e+08&lt;/td&gt;
      &lt;td&gt;-1.213126e+06&lt;/td&gt;
      &lt;td&gt;-1.184678e+06&lt;/td&gt;
      &lt;td&gt;-9.444266e+05&lt;/td&gt;
      &lt;td&gt;-9.966395e+05&lt;/td&gt;
      &lt;td&gt;-9.262397e+05&lt;/td&gt;
      &lt;td&gt;-1.053022e+06&lt;/td&gt;
      &lt;td&gt;-5.265110e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;BRA&lt;/td&gt;
      &lt;td&gt;Brazil&lt;/td&gt;
      &lt;td&gt;138910.3&lt;/td&gt;
      &lt;td&gt;126278.2&lt;/td&gt;
      &lt;td&gt;130322.9&lt;/td&gt;
      &lt;td&gt;121615.2&lt;/td&gt;
      &lt;td&gt;111084.8&lt;/td&gt;
      &lt;td&gt;3472757.5&lt;/td&gt;
      &lt;td&gt;3156955.0&lt;/td&gt;
      &lt;td&gt;3258072.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;1.725134e+06&lt;/td&gt;
      &lt;td&gt;8.625670e+06&lt;/td&gt;
      &lt;td&gt;4.312835e+07&lt;/td&gt;
      &lt;td&gt;-2.021130e+05&lt;/td&gt;
      &lt;td&gt;-1.841407e+05&lt;/td&gt;
      &lt;td&gt;-2.421944e+05&lt;/td&gt;
      &lt;td&gt;-2.500878e+05&lt;/td&gt;
      &lt;td&gt;-2.183865e+05&lt;/td&gt;
      &lt;td&gt;-2.193845e+05&lt;/td&gt;
      &lt;td&gt;-1.096923e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;CHN&lt;/td&gt;
      &lt;td&gt;China&lt;/td&gt;
      &lt;td&gt;5406593.9&lt;/td&gt;
      &lt;td&gt;5399920.0&lt;/td&gt;
      &lt;td&gt;5400129.0&lt;/td&gt;
      &lt;td&gt;5302173.1&lt;/td&gt;
      &lt;td&gt;5214454.7&lt;/td&gt;
      &lt;td&gt;135164847.5&lt;/td&gt;
      &lt;td&gt;134998000.0&lt;/td&gt;
      &lt;td&gt;135003225.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;2.936556e+07&lt;/td&gt;
      &lt;td&gt;1.468278e+08&lt;/td&gt;
      &lt;td&gt;7.341391e+08&lt;/td&gt;
      &lt;td&gt;-7.270532e+05&lt;/td&gt;
      &lt;td&gt;-4.596111e+05&lt;/td&gt;
      &lt;td&gt;-9.549420e+05&lt;/td&gt;
      &lt;td&gt;-1.117892e+05&lt;/td&gt;
      &lt;td&gt;-3.888972e+05&lt;/td&gt;
      &lt;td&gt;-5.284585e+05&lt;/td&gt;
      &lt;td&gt;-2.642293e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;ESP&lt;/td&gt;
      &lt;td&gt;Spain&lt;/td&gt;
      &lt;td&gt;55082.2&lt;/td&gt;
      &lt;td&gt;55073.1&lt;/td&gt;
      &lt;td&gt;54232.4&lt;/td&gt;
      &lt;td&gt;52925.0&lt;/td&gt;
      &lt;td&gt;52098.5&lt;/td&gt;
      &lt;td&gt;1377055.0&lt;/td&gt;
      &lt;td&gt;1376827.5&lt;/td&gt;
      &lt;td&gt;1355810.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;6.247300e+04&lt;/td&gt;
      &lt;td&gt;3.123650e+05&lt;/td&gt;
      &lt;td&gt;1.561825e+06&lt;/td&gt;
      &lt;td&gt;4.366756e+04&lt;/td&gt;
      &lt;td&gt;4.172507e+04&lt;/td&gt;
      &lt;td&gt;4.205941e+04&lt;/td&gt;
      &lt;td&gt;3.887090e+04&lt;/td&gt;
      &lt;td&gt;4.061526e+04&lt;/td&gt;
      &lt;td&gt;4.138764e+04&lt;/td&gt;
      &lt;td&gt;2.069382e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;IDN&lt;/td&gt;
      &lt;td&gt;Indonesia&lt;/td&gt;
      &lt;td&gt;2407953.5&lt;/td&gt;
      &lt;td&gt;2387656.4&lt;/td&gt;
      &lt;td&gt;2425290.6&lt;/td&gt;
      &lt;td&gt;2405613.8&lt;/td&gt;
      &lt;td&gt;2257604.3&lt;/td&gt;
      &lt;td&gt;60198837.5&lt;/td&gt;
      &lt;td&gt;59691410.0&lt;/td&gt;
      &lt;td&gt;60632265.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;5.711960e+06&lt;/td&gt;
      &lt;td&gt;2.855980e+07&lt;/td&gt;
      &lt;td&gt;1.427990e+08&lt;/td&gt;
      &lt;td&gt;1.124305e+06&lt;/td&gt;
      &lt;td&gt;1.364527e+06&lt;/td&gt;
      &lt;td&gt;1.463758e+06&lt;/td&gt;
      &lt;td&gt;1.228632e+06&lt;/td&gt;
      &lt;td&gt;9.909364e+05&lt;/td&gt;
      &lt;td&gt;1.234432e+06&lt;/td&gt;
      &lt;td&gt;6.172158e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;IND&lt;/td&gt;
      &lt;td&gt;India&lt;/td&gt;
      &lt;td&gt;4580248.4&lt;/td&gt;
      &lt;td&gt;4559136.4&lt;/td&gt;
      &lt;td&gt;4620790.8&lt;/td&gt;
      &lt;td&gt;4661154.9&lt;/td&gt;
      &lt;td&gt;4621416.8&lt;/td&gt;
      &lt;td&gt;114506210.0&lt;/td&gt;
      &lt;td&gt;113978410.0&lt;/td&gt;
      &lt;td&gt;115519770.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;3.184910e+07&lt;/td&gt;
      &lt;td&gt;1.592455e+08&lt;/td&gt;
      &lt;td&gt;7.962276e+08&lt;/td&gt;
      &lt;td&gt;-1.639638e+06&lt;/td&gt;
      &lt;td&gt;-7.502765e+05&lt;/td&gt;
      &lt;td&gt;-1.607660e+06&lt;/td&gt;
      &lt;td&gt;-1.928643e+06&lt;/td&gt;
      &lt;td&gt;-2.880139e+06&lt;/td&gt;
      &lt;td&gt;-1.761271e+06&lt;/td&gt;
      &lt;td&gt;-8.806357e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;IRN&lt;/td&gt;
      &lt;td&gt;Iran (Islamic Republic of)&lt;/td&gt;
      &lt;td&gt;116486.7&lt;/td&gt;
      &lt;td&gt;131008.5&lt;/td&gt;
      &lt;td&gt;87233.6&lt;/td&gt;
      &lt;td&gt;93936.6&lt;/td&gt;
      &lt;td&gt;96103.4&lt;/td&gt;
      &lt;td&gt;2912167.5&lt;/td&gt;
      &lt;td&gt;3275212.5&lt;/td&gt;
      &lt;td&gt;2180840.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;4.595069e+05&lt;/td&gt;
      &lt;td&gt;2.297534e+06&lt;/td&gt;
      &lt;td&gt;1.148767e+07&lt;/td&gt;
      &lt;td&gt;2.874263e+04&lt;/td&gt;
      &lt;td&gt;3.920729e+04&lt;/td&gt;
      &lt;td&gt;-8.968572e+03&lt;/td&gt;
      &lt;td&gt;5.179159e+03&lt;/td&gt;
      &lt;td&gt;1.101412e+03&lt;/td&gt;
      &lt;td&gt;1.305238e+04&lt;/td&gt;
      &lt;td&gt;6.526191e+04&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;ITA&lt;/td&gt;
      &lt;td&gt;Italy&lt;/td&gt;
      &lt;td&gt;114574.8&lt;/td&gt;
      &lt;td&gt;118003.0&lt;/td&gt;
      &lt;td&gt;118003.0&lt;/td&gt;
      &lt;td&gt;109463.8&lt;/td&gt;
      &lt;td&gt;110895.1&lt;/td&gt;
      &lt;td&gt;2864370.0&lt;/td&gt;
      &lt;td&gt;2950075.0&lt;/td&gt;
      &lt;td&gt;2950075.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;2.441425e+05&lt;/td&gt;
      &lt;td&gt;1.220712e+06&lt;/td&gt;
      &lt;td&gt;6.103562e+06&lt;/td&gt;
      &lt;td&gt;6.461512e+04&lt;/td&gt;
      &lt;td&gt;6.862515e+04&lt;/td&gt;
      &lt;td&gt;6.356621e+04&lt;/td&gt;
      &lt;td&gt;6.476478e+04&lt;/td&gt;
      &lt;td&gt;6.522596e+04&lt;/td&gt;
      &lt;td&gt;6.535944e+04&lt;/td&gt;
      &lt;td&gt;3.267972e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;JPN&lt;/td&gt;
      &lt;td&gt;Japan&lt;/td&gt;
      &lt;td&gt;330353.1&lt;/td&gt;
      &lt;td&gt;326403.0&lt;/td&gt;
      &lt;td&gt;323700.3&lt;/td&gt;
      &lt;td&gt;322245.0&lt;/td&gt;
      &lt;td&gt;320581.8&lt;/td&gt;
      &lt;td&gt;8258827.5&lt;/td&gt;
      &lt;td&gt;8160075.0&lt;/td&gt;
      &lt;td&gt;8092507.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;1.117884e+06&lt;/td&gt;
      &lt;td&gt;5.589421e+06&lt;/td&gt;
      &lt;td&gt;2.794710e+07&lt;/td&gt;
      &lt;td&gt;9.980661e+04&lt;/td&gt;
      &lt;td&gt;9.798967e+04&lt;/td&gt;
      &lt;td&gt;5.280682e+04&lt;/td&gt;
      &lt;td&gt;1.674198e+05&lt;/td&gt;
      &lt;td&gt;8.737617e+04&lt;/td&gt;
      &lt;td&gt;1.010798e+05&lt;/td&gt;
      &lt;td&gt;5.053990e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;KHM&lt;/td&gt;
      &lt;td&gt;Cambodia&lt;/td&gt;
      &lt;td&gt;436826.0&lt;/td&gt;
      &lt;td&gt;459003.1&lt;/td&gt;
      &lt;td&gt;473745.3&lt;/td&gt;
      &lt;td&gt;479362.7&lt;/td&gt;
      &lt;td&gt;468378.9&lt;/td&gt;
      &lt;td&gt;10920650.0&lt;/td&gt;
      &lt;td&gt;11475077.5&lt;/td&gt;
      &lt;td&gt;11843632.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;2.674333e+06&lt;/td&gt;
      &lt;td&gt;1.337166e+07&lt;/td&gt;
      &lt;td&gt;6.685832e+07&lt;/td&gt;
      &lt;td&gt;-5.864384e+04&lt;/td&gt;
      &lt;td&gt;-1.141667e+05&lt;/td&gt;
      &lt;td&gt;2.204082e+04&lt;/td&gt;
      &lt;td&gt;-7.989830e+04&lt;/td&gt;
      &lt;td&gt;-1.263488e+05&lt;/td&gt;
      &lt;td&gt;-7.140337e+04&lt;/td&gt;
      &lt;td&gt;-3.570168e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;KOR&lt;/td&gt;
      &lt;td&gt;Korea (the Republic of)&lt;/td&gt;
      &lt;td&gt;167862.2&lt;/td&gt;
      &lt;td&gt;163534.1&lt;/td&gt;
      &lt;td&gt;158489.7&lt;/td&gt;
      &lt;td&gt;154911.3&lt;/td&gt;
      &lt;td&gt;153260.9&lt;/td&gt;
      &lt;td&gt;4196555.0&lt;/td&gt;
      &lt;td&gt;4088352.5&lt;/td&gt;
      &lt;td&gt;3962242.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;6.811023e+05&lt;/td&gt;
      &lt;td&gt;3.405512e+06&lt;/td&gt;
      &lt;td&gt;1.702756e+07&lt;/td&gt;
      &lt;td&gt;2.267438e+04&lt;/td&gt;
      &lt;td&gt;3.607436e+04&lt;/td&gt;
      &lt;td&gt;1.216747e+04&lt;/td&gt;
      &lt;td&gt;2.555698e+04&lt;/td&gt;
      &lt;td&gt;2.048269e+04&lt;/td&gt;
      &lt;td&gt;2.339118e+04&lt;/td&gt;
      &lt;td&gt;1.169559e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;LAO&lt;/td&gt;
      &lt;td&gt;Lao People&#39;s Democratic Republic (the)&lt;/td&gt;
      &lt;td&gt;94826.8&lt;/td&gt;
      &lt;td&gt;95630.0&lt;/td&gt;
      &lt;td&gt;93940.7&lt;/td&gt;
      &lt;td&gt;83333.6&lt;/td&gt;
      &lt;td&gt;77005.5&lt;/td&gt;
      &lt;td&gt;2370670.0&lt;/td&gt;
      &lt;td&gt;2390750.0&lt;/td&gt;
      &lt;td&gt;2348517.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;6.996406e+04&lt;/td&gt;
      &lt;td&gt;3.498203e+05&lt;/td&gt;
      &lt;td&gt;1.749102e+06&lt;/td&gt;
      &lt;td&gt;7.821511e+04&lt;/td&gt;
      &lt;td&gt;7.866559e+04&lt;/td&gt;
      &lt;td&gt;8.226007e+04&lt;/td&gt;
      &lt;td&gt;7.323685e+04&lt;/td&gt;
      &lt;td&gt;6.239492e+04&lt;/td&gt;
      &lt;td&gt;7.495451e+04&lt;/td&gt;
      &lt;td&gt;3.747725e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;LKA&lt;/td&gt;
      &lt;td&gt;Sri Lanka&lt;/td&gt;
      &lt;td&gt;132640.0&lt;/td&gt;
      &lt;td&gt;121756.3&lt;/td&gt;
      &lt;td&gt;84456.3&lt;/td&gt;
      &lt;td&gt;111049.0&lt;/td&gt;
      &lt;td&gt;102156.3&lt;/td&gt;
      &lt;td&gt;3316000.0&lt;/td&gt;
      &lt;td&gt;3043907.5&lt;/td&gt;
      &lt;td&gt;2111407.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;4.182990e+05&lt;/td&gt;
      &lt;td&gt;2.091495e+06&lt;/td&gt;
      &lt;td&gt;1.045748e+07&lt;/td&gt;
      &lt;td&gt;4.958374e+04&lt;/td&gt;
      &lt;td&gt;2.058196e+04&lt;/td&gt;
      &lt;td&gt;2.533789e+04&lt;/td&gt;
      &lt;td&gt;2.085986e+04&lt;/td&gt;
      &lt;td&gt;1.739542e+04&lt;/td&gt;
      &lt;td&gt;2.675177e+04&lt;/td&gt;
      &lt;td&gt;1.337589e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;MMR&lt;/td&gt;
      &lt;td&gt;Myanmar&lt;/td&gt;
      &lt;td&gt;1059409.6&lt;/td&gt;
      &lt;td&gt;1052287.7&lt;/td&gt;
      &lt;td&gt;1087029.5&lt;/td&gt;
      &lt;td&gt;1118850.0&lt;/td&gt;
      &lt;td&gt;1083100.3&lt;/td&gt;
      &lt;td&gt;26485240.0&lt;/td&gt;
      &lt;td&gt;26307192.5&lt;/td&gt;
      &lt;td&gt;27175737.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;6.257392e+06&lt;/td&gt;
      &lt;td&gt;3.128696e+07&lt;/td&gt;
      &lt;td&gt;1.564348e+08&lt;/td&gt;
      &lt;td&gt;-7.267265e+04&lt;/td&gt;
      &lt;td&gt;-2.385180e+05&lt;/td&gt;
      &lt;td&gt;-1.181398e+05&lt;/td&gt;
      &lt;td&gt;-2.535969e+05&lt;/td&gt;
      &lt;td&gt;-1.737880e+05&lt;/td&gt;
      &lt;td&gt;-1.713431e+05&lt;/td&gt;
      &lt;td&gt;-8.567154e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;MYS&lt;/td&gt;
      &lt;td&gt;Malaysia&lt;/td&gt;
      &lt;td&gt;121942.6&lt;/td&gt;
      &lt;td&gt;123232.8&lt;/td&gt;
      &lt;td&gt;122656.3&lt;/td&gt;
      &lt;td&gt;125238.5&lt;/td&gt;
      &lt;td&gt;122453.8&lt;/td&gt;
      &lt;td&gt;3048565.0&lt;/td&gt;
      &lt;td&gt;3080820.0&lt;/td&gt;
      &lt;td&gt;3066407.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;5.401551e+05&lt;/td&gt;
      &lt;td&gt;2.700775e+06&lt;/td&gt;
      &lt;td&gt;1.350388e+07&lt;/td&gt;
      &lt;td&gt;1.620268e+04&lt;/td&gt;
      &lt;td&gt;1.222789e+04&lt;/td&gt;
      &lt;td&gt;1.152724e+04&lt;/td&gt;
      &lt;td&gt;1.858597e+04&lt;/td&gt;
      &lt;td&gt;1.682512e+04&lt;/td&gt;
      &lt;td&gt;1.507378e+04&lt;/td&gt;
      &lt;td&gt;7.536891e+04&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;NPL&lt;/td&gt;
      &lt;td&gt;Nepal&lt;/td&gt;
      &lt;td&gt;149262.2&lt;/td&gt;
      &lt;td&gt;142723.7&lt;/td&gt;
      &lt;td&gt;162574.6&lt;/td&gt;
      &lt;td&gt;153890.8&lt;/td&gt;
      &lt;td&gt;156215.4&lt;/td&gt;
      &lt;td&gt;3731555.0&lt;/td&gt;
      &lt;td&gt;3568092.5&lt;/td&gt;
      &lt;td&gt;4064365.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;4.566635e+05&lt;/td&gt;
      &lt;td&gt;2.283318e+06&lt;/td&gt;
      &lt;td&gt;1.141659e+07&lt;/td&gt;
      &lt;td&gt;4.851434e+04&lt;/td&gt;
      &lt;td&gt;7.605209e+04&lt;/td&gt;
      &lt;td&gt;8.176160e+04&lt;/td&gt;
      &lt;td&gt;6.188328e+04&lt;/td&gt;
      &lt;td&gt;3.979186e+04&lt;/td&gt;
      &lt;td&gt;6.160063e+04&lt;/td&gt;
      &lt;td&gt;3.080032e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;PAK&lt;/td&gt;
      &lt;td&gt;Pakistan&lt;/td&gt;
      &lt;td&gt;383529.3&lt;/td&gt;
      &lt;td&gt;381361.8&lt;/td&gt;
      &lt;td&gt;406083.3&lt;/td&gt;
      &lt;td&gt;393404.2&lt;/td&gt;
      &lt;td&gt;424755.1&lt;/td&gt;
      &lt;td&gt;9588232.5&lt;/td&gt;
      &lt;td&gt;9534045.0&lt;/td&gt;
      &lt;td&gt;10152082.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;2.723184e+06&lt;/td&gt;
      &lt;td&gt;1.361592e+07&lt;/td&gt;
      &lt;td&gt;6.807960e+07&lt;/td&gt;
      &lt;td&gt;-1.017138e+05&lt;/td&gt;
      &lt;td&gt;-2.132304e+05&lt;/td&gt;
      &lt;td&gt;-1.311808e+05&lt;/td&gt;
      &lt;td&gt;-5.982552e+04&lt;/td&gt;
      &lt;td&gt;-2.280997e+05&lt;/td&gt;
      &lt;td&gt;-1.468100e+05&lt;/td&gt;
      &lt;td&gt;-7.340502e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;PHL&lt;/td&gt;
      &lt;td&gt;Philippines (the)&lt;/td&gt;
      &lt;td&gt;1557810.6&lt;/td&gt;
      &lt;td&gt;1524292.5&lt;/td&gt;
      &lt;td&gt;1609862.5&lt;/td&gt;
      &lt;td&gt;1606047.8&lt;/td&gt;
      &lt;td&gt;1556225.8&lt;/td&gt;
      &lt;td&gt;38945265.0&lt;/td&gt;
      &lt;td&gt;38107312.5&lt;/td&gt;
      &lt;td&gt;40246562.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;1.910216e+06&lt;/td&gt;
      &lt;td&gt;9.551082e+06&lt;/td&gt;
      &lt;td&gt;4.775541e+07&lt;/td&gt;
      &lt;td&gt;1.214609e+06&lt;/td&gt;
      &lt;td&gt;1.116937e+06&lt;/td&gt;
      &lt;td&gt;1.226180e+06&lt;/td&gt;
      &lt;td&gt;1.188527e+06&lt;/td&gt;
      &lt;td&gt;1.197771e+06&lt;/td&gt;
      &lt;td&gt;1.188805e+06&lt;/td&gt;
      &lt;td&gt;5.944023e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;PRK&lt;/td&gt;
      &lt;td&gt;Korea (the Democratic People&#39;s Republic of)&lt;/td&gt;
      &lt;td&gt;82823.3&lt;/td&gt;
      &lt;td&gt;83442.3&lt;/td&gt;
      &lt;td&gt;84596.2&lt;/td&gt;
      &lt;td&gt;83943.3&lt;/td&gt;
      &lt;td&gt;82937.0&lt;/td&gt;
      &lt;td&gt;2070582.5&lt;/td&gt;
      &lt;td&gt;2086057.5&lt;/td&gt;
      &lt;td&gt;2114905.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;4.978202e+05&lt;/td&gt;
      &lt;td&gt;2.489101e+06&lt;/td&gt;
      &lt;td&gt;1.244551e+07&lt;/td&gt;
      &lt;td&gt;-3.149836e+04&lt;/td&gt;
      &lt;td&gt;-8.334231e+03&lt;/td&gt;
      &lt;td&gt;-2.394946e+04&lt;/td&gt;
      &lt;td&gt;-2.682481e+03&lt;/td&gt;
      &lt;td&gt;-1.361362e+04&lt;/td&gt;
      &lt;td&gt;-1.601563e+04&lt;/td&gt;
      &lt;td&gt;-8.007815e+04&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;THA&lt;/td&gt;
      &lt;td&gt;Thailand&lt;/td&gt;
      &lt;td&gt;1554254.0&lt;/td&gt;
      &lt;td&gt;1703327.7&lt;/td&gt;
      &lt;td&gt;1714465.6&lt;/td&gt;
      &lt;td&gt;1702989.1&lt;/td&gt;
      &lt;td&gt;1553835.5&lt;/td&gt;
      &lt;td&gt;38856350.0&lt;/td&gt;
      &lt;td&gt;42583192.5&lt;/td&gt;
      &lt;td&gt;42861640.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;6.561194e+06&lt;/td&gt;
      &lt;td&gt;3.280597e+07&lt;/td&gt;
      &lt;td&gt;1.640298e+08&lt;/td&gt;
      &lt;td&gt;1.604559e+05&lt;/td&gt;
      &lt;td&gt;-7.766539e+04&lt;/td&gt;
      &lt;td&gt;5.497665e+05&lt;/td&gt;
      &lt;td&gt;7.863316e+05&lt;/td&gt;
      &lt;td&gt;2.487897e+05&lt;/td&gt;
      &lt;td&gt;3.335357e+05&lt;/td&gt;
      &lt;td&gt;1.667678e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;20&lt;/th&gt;
      &lt;td&gt;TWN&lt;/td&gt;
      &lt;td&gt;Taiwan (Province of China)&lt;/td&gt;
      &lt;td&gt;45838.7&lt;/td&gt;
      &lt;td&gt;49838.3&lt;/td&gt;
      &lt;td&gt;49991.2&lt;/td&gt;
      &lt;td&gt;49414.1&lt;/td&gt;
      &lt;td&gt;49152.0&lt;/td&gt;
      &lt;td&gt;1145967.5&lt;/td&gt;
      &lt;td&gt;1245957.5&lt;/td&gt;
      &lt;td&gt;1249780.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;4.179076e+05&lt;/td&gt;
      &lt;td&gt;2.089538e+06&lt;/td&gt;
      &lt;td&gt;1.044769e+07&lt;/td&gt;
      &lt;td&gt;-3.283086e+04&lt;/td&gt;
      &lt;td&gt;-3.105319e+04&lt;/td&gt;
      &lt;td&gt;-3.706514e+04&lt;/td&gt;
      &lt;td&gt;-3.196741e+04&lt;/td&gt;
      &lt;td&gt;-4.075670e+04&lt;/td&gt;
      &lt;td&gt;-3.473466e+04&lt;/td&gt;
      &lt;td&gt;-1.736733e+05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;21&lt;/th&gt;
      &lt;td&gt;USA&lt;/td&gt;
      &lt;td&gt;United States of America (the)&lt;/td&gt;
      &lt;td&gt;364728.0&lt;/td&gt;
      &lt;td&gt;438662.0&lt;/td&gt;
      &lt;td&gt;336255.5&lt;/td&gt;
      &lt;td&gt;412177.5&lt;/td&gt;
      &lt;td&gt;350136.5&lt;/td&gt;
      &lt;td&gt;9118200.0&lt;/td&gt;
      &lt;td&gt;10966550.0&lt;/td&gt;
      &lt;td&gt;8406387.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;8.263305e+05&lt;/td&gt;
      &lt;td&gt;4.131652e+06&lt;/td&gt;
      &lt;td&gt;2.065826e+07&lt;/td&gt;
      &lt;td&gt;2.035956e+05&lt;/td&gt;
      &lt;td&gt;2.768044e+05&lt;/td&gt;
      &lt;td&gt;1.677756e+05&lt;/td&gt;
      &lt;td&gt;2.464521e+05&lt;/td&gt;
      &lt;td&gt;1.810014e+05&lt;/td&gt;
      &lt;td&gt;2.151258e+05&lt;/td&gt;
      &lt;td&gt;1.075629e+06&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22&lt;/th&gt;
      &lt;td&gt;VNM&lt;/td&gt;
      &lt;td&gt;Viet Nam&lt;/td&gt;
      &lt;td&gt;1381744.4&lt;/td&gt;
      &lt;td&gt;1365173.8&lt;/td&gt;
      &lt;td&gt;1360551.6&lt;/td&gt;
      &lt;td&gt;1336231.2&lt;/td&gt;
      &lt;td&gt;1318431.1&lt;/td&gt;
      &lt;td&gt;34543610.0&lt;/td&gt;
      &lt;td&gt;34129345.0&lt;/td&gt;
      &lt;td&gt;34013790.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;6.823432e+06&lt;/td&gt;
      &lt;td&gt;3.411716e+07&lt;/td&gt;
      &lt;td&gt;1.705858e+08&lt;/td&gt;
      &lt;td&gt;3.573139e+04&lt;/td&gt;
      &lt;td&gt;-1.186027e+05&lt;/td&gt;
      &lt;td&gt;-4.588520e+04&lt;/td&gt;
      &lt;td&gt;1.877621e+04&lt;/td&gt;
      &lt;td&gt;4.868034e+04&lt;/td&gt;
      &lt;td&gt;-1.226000e+04&lt;/td&gt;
      &lt;td&gt;-6.129998e+04&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;23 rows  38 columns&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&#34;calculate-difference-in-c02-tonnes-between-the-estimates&#34; &gt;Calculate difference in C02 Tonnes Between the Estimates
&lt;span&gt;
    &lt;a href=&#34;#calculate-difference-in-c02-tonnes-between-the-estimates&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Calculate Difference in tons&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_diff_2015&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2015_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2015_TRACE&amp;#39;&lt;/span&gt;]
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_diff_2016&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2016_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2016_TRACE&amp;#39;&lt;/span&gt;]
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_diff_2017&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2017_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2017_TRACE&amp;#39;&lt;/span&gt;]
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_diff_2018&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2018_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2018_TRACE&amp;#39;&lt;/span&gt;]
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_diff_2019&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2019_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2019_TRACE&amp;#39;&lt;/span&gt;]
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_diff_means&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Mean_CO2_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Mean_CO2_TRACE&amp;#39;&lt;/span&gt;]
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_diff_totals&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total_CO2_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total_CO2_TRACE&amp;#39;&lt;/span&gt;]


&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;calculating-the-ch4-percent-differences-between-the-estimates&#34; &gt;Calculating the CH4 Percent Differences Between the Estimates
&lt;span&gt;
    &lt;a href=&#34;#calculating-the-ch4-percent-differences-between-the-estimates&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;## Calculate Percent Differnces on this data set )*100&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# With raw data i could have accomplished this with a groupby.aggregate(lambda x ), however the pivot tables given are not easy to apply #vectorized functions across time series&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_abs_percent_diff_2015&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((abs(merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2015&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2015&amp;#39;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;((merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2015&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2015&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_abs_percent_diff_2016&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((abs((merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2016&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2016&amp;#39;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;((merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2016&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2016&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_abs_percent_diff_2017&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((abs(merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2017&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2017&amp;#39;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;((merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2017&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2017&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_abs_percent_diff_2018&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (abs((merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2018&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2018&amp;#39;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;((merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2018&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2018&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_abs_percent_diff_2019&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (abs((merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2019&amp;#39;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;((merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2019&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_abs_percent_diff_means&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (abs((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Mean_CH4_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Mean_CH4_TRACE&amp;#39;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Mean_CH4_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Mean_CH4_TRACE&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_abs_percent_diff_totals&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (abs((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total_CH4_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total_CH4_TRACE&amp;#39;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total_CH4_TRACE&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total_CH4_FAOSTAT&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;


merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_relative_percent_diff_2015&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2015&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2015&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2015&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_relative_percent_diff_2016&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2016&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2016&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2016&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_relative_percent_diff_2017&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2017&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2017&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2017&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_relative_percent_diff_2018&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2018&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2018&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2018&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_relative_percent_diff_2019&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCH4_2019&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(merged_df[&lt;span style=&#34;color:#ae81ff&#34;&gt;2019&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_relative_percent_diff_means&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Mean_CH4_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Mean_CH4_TRACE&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Mean_CH4_FAOSTAT&amp;#34;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CH4_relative_percent_diff_totals&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total_CH4_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total_CH4_TRACE&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Total_CH4_FAOSTAT&amp;#34;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;calculate-co2-differences&#34; &gt;Calculate CO2 Differences
&lt;span&gt;
    &lt;a href=&#34;#calculate-co2-differences&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;## Calculate Percent Differnces on this data set )*100&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;# With raw data i could have accomplished this with a groupby.aggregate(lambda x ), however the pivot tables given are not easy to apply #vectorized functions across time series&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_abs_percent_diff_2015&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (abs((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2015_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2015_TRACE&amp;#39;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2015_TRACE&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2015_FAOSTAT&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_abs_percent_diff_2016&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((abs(merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2016_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2016_TRACE&amp;#39;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2016_TRACE&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2016_FAOSTAT&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_abs_percent_diff_2017&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((abs(merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2017_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2017_TRACE&amp;#39;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2017_TRACE&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2017_FAOSTAT&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_abs_percent_diff_2018&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((abs(merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2018_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2018_TRACE&amp;#39;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2018_TRACE&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2018_FAOSTAT&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_abs_percent_diff_2019&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((abs(merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2019_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2019_TRACE&amp;#39;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2019_TRACE&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2019_FAOSTAT&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_abs_percent_diff_means&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((abs(merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Mean_CO2_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Mean_CO2_TRACE&amp;#39;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Mean_CO2_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Mean_CO2_TRACE&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_abs_percent_diff_totals&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((abs(merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total_CO2_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total_CO2_TRACE&amp;#39;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total_CO2_TRACE&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total_CO2_FAOSTAT&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;


merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_relative_percent_diff_2015&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2015_FAOSTAT&amp;#39;&lt;/span&gt;]  &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2015_TRACE&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2015_FAOSTAT&amp;#39;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_relative_percent_diff_2016&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2016_FAOSTAT&amp;#39;&lt;/span&gt;]  &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2016_TRACE&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2016_FAOSTAT&amp;#39;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_relative_percent_diff_2017&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2017_FAOSTAT&amp;#39;&lt;/span&gt;]  &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2017_TRACE&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2017_FAOSTAT&amp;#39;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_relative_percent_diff_2018&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2018_FAOSTAT&amp;#39;&lt;/span&gt;]  &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2018_TRACE&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2018_FAOSTAT&amp;#39;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_relative_percent_diff_2019&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2019_FAOSTAT&amp;#39;&lt;/span&gt;]  &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2019_TRACE&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;tCO2_2019_FAOSTAT&amp;#39;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_relative_percent_diff_means&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Mean_CO2_FAOSTAT&amp;#34;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Mean_CO2_TRACE&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Mean_CO2_FAOSTAT&amp;#34;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;CO2_relative_percent_diff_totals&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total_CO2_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Total_CO2_TRACE&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Total_CO2_FAOSTAT&amp;#34;&lt;/span&gt;]))&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;merged_df
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div style=&#34;overflow-x:auto;&#34;&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;iso3_country&lt;/th&gt;
      &lt;th&gt;country_name_FAOSTAT&lt;/th&gt;
      &lt;th&gt;2015&lt;/th&gt;
      &lt;th&gt;2016&lt;/th&gt;
      &lt;th&gt;2017&lt;/th&gt;
      &lt;th&gt;2018&lt;/th&gt;
      &lt;th&gt;2019&lt;/th&gt;
      &lt;th&gt;tCO2_2015_FAOSTAT&lt;/th&gt;
      &lt;th&gt;tCO2_2016_FAOSTAT&lt;/th&gt;
      &lt;th&gt;tCO2_2017_FAOSTAT&lt;/th&gt;
      &lt;th&gt;...&lt;/th&gt;
      &lt;th&gt;CO2_abs_percent_diff_2019&lt;/th&gt;
      &lt;th&gt;CO2_abs_percent_diff_means&lt;/th&gt;
      &lt;th&gt;CO2_abs_percent_diff_totals&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_2015&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_2016&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_2017&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_2018&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_2019&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_means&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_totals&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;BGD&lt;/td&gt;
      &lt;td&gt;Bangladesh&lt;/td&gt;
      &lt;td&gt;1131293.4&lt;/td&gt;
      &lt;td&gt;1093480.4&lt;/td&gt;
      &lt;td&gt;1154531.0&lt;/td&gt;
      &lt;td&gt;1144591.0&lt;/td&gt;
      &lt;td&gt;1144745.4&lt;/td&gt;
      &lt;td&gt;28282335.0&lt;/td&gt;
      &lt;td&gt;27337010.0&lt;/td&gt;
      &lt;td&gt;28863275.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;57.606797&lt;/td&gt;
      &lt;td&gt;63.425917&lt;/td&gt;
      &lt;td&gt;63.425917&lt;/td&gt;
      &lt;td&gt;-107.233570&lt;/td&gt;
      &lt;td&gt;-108.340089&lt;/td&gt;
      &lt;td&gt;-81.801753&lt;/td&gt;
      &lt;td&gt;-87.073857&lt;/td&gt;
      &lt;td&gt;-80.912284&lt;/td&gt;
      &lt;td&gt;-92.881337&lt;/td&gt;
      &lt;td&gt;-92.881337&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;BRA&lt;/td&gt;
      &lt;td&gt;Brazil&lt;/td&gt;
      &lt;td&gt;138910.3&lt;/td&gt;
      &lt;td&gt;126278.2&lt;/td&gt;
      &lt;td&gt;130322.9&lt;/td&gt;
      &lt;td&gt;121615.2&lt;/td&gt;
      &lt;td&gt;111084.8&lt;/td&gt;
      &lt;td&gt;3472757.5&lt;/td&gt;
      &lt;td&gt;3156955.0&lt;/td&gt;
      &lt;td&gt;3258072.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;99.141295&lt;/td&gt;
      &lt;td&gt;93.222402&lt;/td&gt;
      &lt;td&gt;93.222402&lt;/td&gt;
      &lt;td&gt;-145.498958&lt;/td&gt;
      &lt;td&gt;-145.821472&lt;/td&gt;
      &lt;td&gt;-185.841820&lt;/td&gt;
      &lt;td&gt;-205.638590&lt;/td&gt;
      &lt;td&gt;-196.594424&lt;/td&gt;
      &lt;td&gt;-174.610414&lt;/td&gt;
      &lt;td&gt;-174.610414&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;CHN&lt;/td&gt;
      &lt;td&gt;China&lt;/td&gt;
      &lt;td&gt;5406593.9&lt;/td&gt;
      &lt;td&gt;5399920.0&lt;/td&gt;
      &lt;td&gt;5400129.0&lt;/td&gt;
      &lt;td&gt;5302173.1&lt;/td&gt;
      &lt;td&gt;5214454.7&lt;/td&gt;
      &lt;td&gt;135164847.5&lt;/td&gt;
      &lt;td&gt;134998000.0&lt;/td&gt;
      &lt;td&gt;135003225.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;7.189945&lt;/td&gt;
      &lt;td&gt;9.421813&lt;/td&gt;
      &lt;td&gt;9.421813&lt;/td&gt;
      &lt;td&gt;-13.447527&lt;/td&gt;
      &lt;td&gt;-8.511442&lt;/td&gt;
      &lt;td&gt;-17.683689&lt;/td&gt;
      &lt;td&gt;-2.108366&lt;/td&gt;
      &lt;td&gt;-7.458060&lt;/td&gt;
      &lt;td&gt;-9.887609&lt;/td&gt;
      &lt;td&gt;-9.887609&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;ESP&lt;/td&gt;
      &lt;td&gt;Spain&lt;/td&gt;
      &lt;td&gt;55082.2&lt;/td&gt;
      &lt;td&gt;55073.1&lt;/td&gt;
      &lt;td&gt;54232.4&lt;/td&gt;
      &lt;td&gt;52925.0&lt;/td&gt;
      &lt;td&gt;52098.5&lt;/td&gt;
      &lt;td&gt;1377055.0&lt;/td&gt;
      &lt;td&gt;1376827.5&lt;/td&gt;
      &lt;td&gt;1355810.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;127.757634&lt;/td&gt;
      &lt;td&gt;124.705066&lt;/td&gt;
      &lt;td&gt;124.705066&lt;/td&gt;
      &lt;td&gt;79.277072&lt;/td&gt;
      &lt;td&gt;75.763074&lt;/td&gt;
      &lt;td&gt;77.554025&lt;/td&gt;
      &lt;td&gt;73.445258&lt;/td&gt;
      &lt;td&gt;77.958601&lt;/td&gt;
      &lt;td&gt;76.811284&lt;/td&gt;
      &lt;td&gt;76.811284&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;IDN&lt;/td&gt;
      &lt;td&gt;Indonesia&lt;/td&gt;
      &lt;td&gt;2407953.5&lt;/td&gt;
      &lt;td&gt;2387656.4&lt;/td&gt;
      &lt;td&gt;2425290.6&lt;/td&gt;
      &lt;td&gt;2405613.8&lt;/td&gt;
      &lt;td&gt;2257604.3&lt;/td&gt;
      &lt;td&gt;60198837.5&lt;/td&gt;
      &lt;td&gt;59691410.0&lt;/td&gt;
      &lt;td&gt;60632265.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;56.234955&lt;/td&gt;
      &lt;td&gt;70.153790&lt;/td&gt;
      &lt;td&gt;70.153790&lt;/td&gt;
      &lt;td&gt;46.691296&lt;/td&gt;
      &lt;td&gt;57.149216&lt;/td&gt;
      &lt;td&gt;60.353916&lt;/td&gt;
      &lt;td&gt;51.073546&lt;/td&gt;
      &lt;td&gt;43.893273&lt;/td&gt;
      &lt;td&gt;51.936188&lt;/td&gt;
      &lt;td&gt;51.936188&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;IND&lt;/td&gt;
      &lt;td&gt;India&lt;/td&gt;
      &lt;td&gt;4580248.4&lt;/td&gt;
      &lt;td&gt;4559136.4&lt;/td&gt;
      &lt;td&gt;4620790.8&lt;/td&gt;
      &lt;td&gt;4661154.9&lt;/td&gt;
      &lt;td&gt;4621416.8&lt;/td&gt;
      &lt;td&gt;114506210.0&lt;/td&gt;
      &lt;td&gt;113978410.0&lt;/td&gt;
      &lt;td&gt;115519770.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;47.515394&lt;/td&gt;
      &lt;td&gt;32.086209&lt;/td&gt;
      &lt;td&gt;32.086209&lt;/td&gt;
      &lt;td&gt;-35.798018&lt;/td&gt;
      &lt;td&gt;-16.456550&lt;/td&gt;
      &lt;td&gt;-34.791882&lt;/td&gt;
      &lt;td&gt;-41.376939&lt;/td&gt;
      &lt;td&gt;-62.321563&lt;/td&gt;
      &lt;td&gt;-38.217479&lt;/td&gt;
      &lt;td&gt;-38.217479&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;IRN&lt;/td&gt;
      &lt;td&gt;Iran (Islamic Republic of)&lt;/td&gt;
      &lt;td&gt;116486.7&lt;/td&gt;
      &lt;td&gt;131008.5&lt;/td&gt;
      &lt;td&gt;87233.6&lt;/td&gt;
      &lt;td&gt;93936.6&lt;/td&gt;
      &lt;td&gt;96103.4&lt;/td&gt;
      &lt;td&gt;2912167.5&lt;/td&gt;
      &lt;td&gt;3275212.5&lt;/td&gt;
      &lt;td&gt;2180840.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;1.152675&lt;/td&gt;
      &lt;td&gt;13.260902&lt;/td&gt;
      &lt;td&gt;13.260902&lt;/td&gt;
      &lt;td&gt;24.674600&lt;/td&gt;
      &lt;td&gt;29.927285&lt;/td&gt;
      &lt;td&gt;-10.281098&lt;/td&gt;
      &lt;td&gt;5.513463&lt;/td&gt;
      &lt;td&gt;1.146070&lt;/td&gt;
      &lt;td&gt;12.436318&lt;/td&gt;
      &lt;td&gt;12.436318&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;ITA&lt;/td&gt;
      &lt;td&gt;Italy&lt;/td&gt;
      &lt;td&gt;114574.8&lt;/td&gt;
      &lt;td&gt;118003.0&lt;/td&gt;
      &lt;td&gt;118003.0&lt;/td&gt;
      &lt;td&gt;109463.8&lt;/td&gt;
      &lt;td&gt;110895.1&lt;/td&gt;
      &lt;td&gt;2864370.0&lt;/td&gt;
      &lt;td&gt;2950075.0&lt;/td&gt;
      &lt;td&gt;2950075.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;83.321649&lt;/td&gt;
      &lt;td&gt;80.187551&lt;/td&gt;
      &lt;td&gt;80.187551&lt;/td&gt;
      &lt;td&gt;56.395576&lt;/td&gt;
      &lt;td&gt;58.155426&lt;/td&gt;
      &lt;td&gt;53.868303&lt;/td&gt;
      &lt;td&gt;59.165480&lt;/td&gt;
      &lt;td&gt;58.817707&lt;/td&gt;
      &lt;td&gt;57.238482&lt;/td&gt;
      &lt;td&gt;57.238482&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;JPN&lt;/td&gt;
      &lt;td&gt;Japan&lt;/td&gt;
      &lt;td&gt;330353.1&lt;/td&gt;
      &lt;td&gt;326403.0&lt;/td&gt;
      &lt;td&gt;323700.3&lt;/td&gt;
      &lt;td&gt;322245.0&lt;/td&gt;
      &lt;td&gt;320581.8&lt;/td&gt;
      &lt;td&gt;8258827.5&lt;/td&gt;
      &lt;td&gt;8160075.0&lt;/td&gt;
      &lt;td&gt;8092507.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;31.555853&lt;/td&gt;
      &lt;td&gt;36.874729&lt;/td&gt;
      &lt;td&gt;36.874729&lt;/td&gt;
      &lt;td&gt;30.212099&lt;/td&gt;
      &lt;td&gt;30.021068&lt;/td&gt;
      &lt;td&gt;16.313490&lt;/td&gt;
      &lt;td&gt;51.954183&lt;/td&gt;
      &lt;td&gt;27.255501&lt;/td&gt;
      &lt;td&gt;31.134372&lt;/td&gt;
      &lt;td&gt;31.134372&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;KHM&lt;/td&gt;
      &lt;td&gt;Cambodia&lt;/td&gt;
      &lt;td&gt;436826.0&lt;/td&gt;
      &lt;td&gt;459003.1&lt;/td&gt;
      &lt;td&gt;473745.3&lt;/td&gt;
      &lt;td&gt;479362.7&lt;/td&gt;
      &lt;td&gt;468378.9&lt;/td&gt;
      &lt;td&gt;10920650.0&lt;/td&gt;
      &lt;td&gt;11475077.5&lt;/td&gt;
      &lt;td&gt;11843632.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;23.769728&lt;/td&gt;
      &lt;td&gt;14.304565&lt;/td&gt;
      &lt;td&gt;14.304565&lt;/td&gt;
      &lt;td&gt;-13.424988&lt;/td&gt;
      &lt;td&gt;-24.872761&lt;/td&gt;
      &lt;td&gt;4.652461&lt;/td&gt;
      &lt;td&gt;-16.667610&lt;/td&gt;
      &lt;td&gt;-26.975760&lt;/td&gt;
      &lt;td&gt;-15.406481&lt;/td&gt;
      &lt;td&gt;-15.406481&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;KOR&lt;/td&gt;
      &lt;td&gt;Korea (the Republic of)&lt;/td&gt;
      &lt;td&gt;167862.2&lt;/td&gt;
      &lt;td&gt;163534.1&lt;/td&gt;
      &lt;td&gt;158489.7&lt;/td&gt;
      &lt;td&gt;154911.3&lt;/td&gt;
      &lt;td&gt;153260.9&lt;/td&gt;
      &lt;td&gt;4196555.0&lt;/td&gt;
      &lt;td&gt;4088352.5&lt;/td&gt;
      &lt;td&gt;3962242.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;14.321600&lt;/td&gt;
      &lt;td&gt;15.813819&lt;/td&gt;
      &lt;td&gt;15.813819&lt;/td&gt;
      &lt;td&gt;13.507737&lt;/td&gt;
      &lt;td&gt;22.059230&lt;/td&gt;
      &lt;td&gt;7.677136&lt;/td&gt;
      &lt;td&gt;16.497815&lt;/td&gt;
      &lt;td&gt;13.364589&lt;/td&gt;
      &lt;td&gt;14.655057&lt;/td&gt;
      &lt;td&gt;14.655057&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;LAO&lt;/td&gt;
      &lt;td&gt;Lao People&#39;s Democratic Republic (the)&lt;/td&gt;
      &lt;td&gt;94826.8&lt;/td&gt;
      &lt;td&gt;95630.0&lt;/td&gt;
      &lt;td&gt;93940.7&lt;/td&gt;
      &lt;td&gt;83333.6&lt;/td&gt;
      &lt;td&gt;77005.5&lt;/td&gt;
      &lt;td&gt;2370670.0&lt;/td&gt;
      &lt;td&gt;2390750.0&lt;/td&gt;
      &lt;td&gt;2348517.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;136.209544&lt;/td&gt;
      &lt;td&gt;145.627378&lt;/td&gt;
      &lt;td&gt;145.627378&lt;/td&gt;
      &lt;td&gt;82.482067&lt;/td&gt;
      &lt;td&gt;82.260369&lt;/td&gt;
      &lt;td&gt;87.565950&lt;/td&gt;
      &lt;td&gt;87.883944&lt;/td&gt;
      &lt;td&gt;81.026578&lt;/td&gt;
      &lt;td&gt;84.268427&lt;/td&gt;
      &lt;td&gt;84.268427&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;LKA&lt;/td&gt;
      &lt;td&gt;Sri Lanka&lt;/td&gt;
      &lt;td&gt;132640.0&lt;/td&gt;
      &lt;td&gt;121756.3&lt;/td&gt;
      &lt;td&gt;84456.3&lt;/td&gt;
      &lt;td&gt;111049.0&lt;/td&gt;
      &lt;td&gt;102156.3&lt;/td&gt;
      &lt;td&gt;3316000.0&lt;/td&gt;
      &lt;td&gt;3043907.5&lt;/td&gt;
      &lt;td&gt;2111407.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;18.612972&lt;/td&gt;
      &lt;td&gt;27.569003&lt;/td&gt;
      &lt;td&gt;27.569003&lt;/td&gt;
      &lt;td&gt;37.382189&lt;/td&gt;
      &lt;td&gt;16.904226&lt;/td&gt;
      &lt;td&gt;30.001182&lt;/td&gt;
      &lt;td&gt;18.784377&lt;/td&gt;
      &lt;td&gt;17.028241&lt;/td&gt;
      &lt;td&gt;24.229137&lt;/td&gt;
      &lt;td&gt;24.229137&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;MMR&lt;/td&gt;
      &lt;td&gt;Myanmar&lt;/td&gt;
      &lt;td&gt;1059409.6&lt;/td&gt;
      &lt;td&gt;1052287.7&lt;/td&gt;
      &lt;td&gt;1087029.5&lt;/td&gt;
      &lt;td&gt;1118850.0&lt;/td&gt;
      &lt;td&gt;1083100.3&lt;/td&gt;
      &lt;td&gt;26485240.0&lt;/td&gt;
      &lt;td&gt;26307192.5&lt;/td&gt;
      &lt;td&gt;27175737.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;14.853751&lt;/td&gt;
      &lt;td&gt;14.697380&lt;/td&gt;
      &lt;td&gt;14.697380&lt;/td&gt;
      &lt;td&gt;-6.859731&lt;/td&gt;
      &lt;td&gt;-22.666619&lt;/td&gt;
      &lt;td&gt;-10.868129&lt;/td&gt;
      &lt;td&gt;-22.665852&lt;/td&gt;
      &lt;td&gt;-16.045425&lt;/td&gt;
      &lt;td&gt;-15.863111&lt;/td&gt;
      &lt;td&gt;-15.863111&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;MYS&lt;/td&gt;
      &lt;td&gt;Malaysia&lt;/td&gt;
      &lt;td&gt;121942.6&lt;/td&gt;
      &lt;td&gt;123232.8&lt;/td&gt;
      &lt;td&gt;122656.3&lt;/td&gt;
      &lt;td&gt;125238.5&lt;/td&gt;
      &lt;td&gt;122453.8&lt;/td&gt;
      &lt;td&gt;3048565.0&lt;/td&gt;
      &lt;td&gt;3080820.0&lt;/td&gt;
      &lt;td&gt;3066407.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;14.753544&lt;/td&gt;
      &lt;td&gt;13.043224&lt;/td&gt;
      &lt;td&gt;13.043224&lt;/td&gt;
      &lt;td&gt;13.287137&lt;/td&gt;
      &lt;td&gt;9.922595&lt;/td&gt;
      &lt;td&gt;9.398001&lt;/td&gt;
      &lt;td&gt;14.840462&lt;/td&gt;
      &lt;td&gt;13.739977&lt;/td&gt;
      &lt;td&gt;12.244674&lt;/td&gt;
      &lt;td&gt;12.244674&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;NPL&lt;/td&gt;
      &lt;td&gt;Nepal&lt;/td&gt;
      &lt;td&gt;149262.2&lt;/td&gt;
      &lt;td&gt;142723.7&lt;/td&gt;
      &lt;td&gt;162574.6&lt;/td&gt;
      &lt;td&gt;153890.8&lt;/td&gt;
      &lt;td&gt;156215.4&lt;/td&gt;
      &lt;td&gt;3731555.0&lt;/td&gt;
      &lt;td&gt;3568092.5&lt;/td&gt;
      &lt;td&gt;4064365.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;29.190154&lt;/td&gt;
      &lt;td&gt;50.437328&lt;/td&gt;
      &lt;td&gt;50.437328&lt;/td&gt;
      &lt;td&gt;32.502761&lt;/td&gt;
      &lt;td&gt;53.286238&lt;/td&gt;
      &lt;td&gt;50.291743&lt;/td&gt;
      &lt;td&gt;40.212459&lt;/td&gt;
      &lt;td&gt;25.472433&lt;/td&gt;
      &lt;td&gt;40.279401&lt;/td&gt;
      &lt;td&gt;40.279401&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;PAK&lt;/td&gt;
      &lt;td&gt;Pakistan&lt;/td&gt;
      &lt;td&gt;383529.3&lt;/td&gt;
      &lt;td&gt;381361.8&lt;/td&gt;
      &lt;td&gt;406083.3&lt;/td&gt;
      &lt;td&gt;393404.2&lt;/td&gt;
      &lt;td&gt;424755.1&lt;/td&gt;
      &lt;td&gt;9588232.5&lt;/td&gt;
      &lt;td&gt;9534045.0&lt;/td&gt;
      &lt;td&gt;10152082.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;42.334367&lt;/td&gt;
      &lt;td&gt;31.154530&lt;/td&gt;
      &lt;td&gt;31.154530&lt;/td&gt;
      &lt;td&gt;-26.520489&lt;/td&gt;
      &lt;td&gt;-55.912882&lt;/td&gt;
      &lt;td&gt;-32.303912&lt;/td&gt;
      &lt;td&gt;-15.207139&lt;/td&gt;
      &lt;td&gt;-53.701452&lt;/td&gt;
      &lt;td&gt;-36.903009&lt;/td&gt;
      &lt;td&gt;-36.903009&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;PHL&lt;/td&gt;
      &lt;td&gt;Philippines (the)&lt;/td&gt;
      &lt;td&gt;1557810.6&lt;/td&gt;
      &lt;td&gt;1524292.5&lt;/td&gt;
      &lt;td&gt;1609862.5&lt;/td&gt;
      &lt;td&gt;1606047.8&lt;/td&gt;
      &lt;td&gt;1556225.8&lt;/td&gt;
      &lt;td&gt;38945265.0&lt;/td&gt;
      &lt;td&gt;38107312.5&lt;/td&gt;
      &lt;td&gt;40246562.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;125.114417&lt;/td&gt;
      &lt;td&gt;121.748165&lt;/td&gt;
      &lt;td&gt;121.748165&lt;/td&gt;
      &lt;td&gt;77.968948&lt;/td&gt;
      &lt;td&gt;73.275770&lt;/td&gt;
      &lt;td&gt;76.166725&lt;/td&gt;
      &lt;td&gt;74.003201&lt;/td&gt;
      &lt;td&gt;76.966391&lt;/td&gt;
      &lt;td&gt;75.679166&lt;/td&gt;
      &lt;td&gt;75.679166&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;PRK&lt;/td&gt;
      &lt;td&gt;Korea (the Democratic People&#39;s Republic of)&lt;/td&gt;
      &lt;td&gt;82823.3&lt;/td&gt;
      &lt;td&gt;83442.3&lt;/td&gt;
      &lt;td&gt;84596.2&lt;/td&gt;
      &lt;td&gt;83943.3&lt;/td&gt;
      &lt;td&gt;82937.0&lt;/td&gt;
      &lt;td&gt;2070582.5&lt;/td&gt;
      &lt;td&gt;2086057.5&lt;/td&gt;
      &lt;td&gt;2114905.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;15.169422&lt;/td&gt;
      &lt;td&gt;17.492669&lt;/td&gt;
      &lt;td&gt;17.492669&lt;/td&gt;
      &lt;td&gt;-38.030793&lt;/td&gt;
      &lt;td&gt;-9.988016&lt;/td&gt;
      &lt;td&gt;-28.310326&lt;/td&gt;
      &lt;td&gt;-3.195586&lt;/td&gt;
      &lt;td&gt;-16.414407&lt;/td&gt;
      &lt;td&gt;-19.169278&lt;/td&gt;
      &lt;td&gt;-19.169278&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;THA&lt;/td&gt;
      &lt;td&gt;Thailand&lt;/td&gt;
      &lt;td&gt;1554254.0&lt;/td&gt;
      &lt;td&gt;1703327.7&lt;/td&gt;
      &lt;td&gt;1714465.6&lt;/td&gt;
      &lt;td&gt;1702989.1&lt;/td&gt;
      &lt;td&gt;1553835.5&lt;/td&gt;
      &lt;td&gt;38856350.0&lt;/td&gt;
      &lt;td&gt;42583192.5&lt;/td&gt;
      &lt;td&gt;42861640.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;17.404685&lt;/td&gt;
      &lt;td&gt;22.551331&lt;/td&gt;
      &lt;td&gt;22.551331&lt;/td&gt;
      &lt;td&gt;10.323662&lt;/td&gt;
      &lt;td&gt;-4.559627&lt;/td&gt;
      &lt;td&gt;32.066348&lt;/td&gt;
      &lt;td&gt;46.173612&lt;/td&gt;
      &lt;td&gt;16.011325&lt;/td&gt;
      &lt;td&gt;20.266184&lt;/td&gt;
      &lt;td&gt;20.266184&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;20&lt;/th&gt;
      &lt;td&gt;TWN&lt;/td&gt;
      &lt;td&gt;Taiwan (Province of China)&lt;/td&gt;
      &lt;td&gt;45838.7&lt;/td&gt;
      &lt;td&gt;49838.3&lt;/td&gt;
      &lt;td&gt;49991.2&lt;/td&gt;
      &lt;td&gt;49414.1&lt;/td&gt;
      &lt;td&gt;49152.0&lt;/td&gt;
      &lt;td&gt;1145967.5&lt;/td&gt;
      &lt;td&gt;1245957.5&lt;/td&gt;
      &lt;td&gt;1249780.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;58.617135&lt;/td&gt;
      &lt;td&gt;52.458032&lt;/td&gt;
      &lt;td&gt;52.458032&lt;/td&gt;
      &lt;td&gt;-71.622589&lt;/td&gt;
      &lt;td&gt;-62.307893&lt;/td&gt;
      &lt;td&gt;-74.143329&lt;/td&gt;
      &lt;td&gt;-64.692890&lt;/td&gt;
      &lt;td&gt;-82.919716&lt;/td&gt;
      &lt;td&gt;-71.109302&lt;/td&gt;
      &lt;td&gt;-71.109302&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;21&lt;/th&gt;
      &lt;td&gt;USA&lt;/td&gt;
      &lt;td&gt;United States of America (the)&lt;/td&gt;
      &lt;td&gt;364728.0&lt;/td&gt;
      &lt;td&gt;438662.0&lt;/td&gt;
      &lt;td&gt;336255.5&lt;/td&gt;
      &lt;td&gt;412177.5&lt;/td&gt;
      &lt;td&gt;350136.5&lt;/td&gt;
      &lt;td&gt;9118200.0&lt;/td&gt;
      &lt;td&gt;10966550.0&lt;/td&gt;
      &lt;td&gt;8406387.5&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;69.713577&lt;/td&gt;
      &lt;td&gt;78.850049&lt;/td&gt;
      &lt;td&gt;78.850049&lt;/td&gt;
      &lt;td&gt;55.821215&lt;/td&gt;
      &lt;td&gt;63.101978&lt;/td&gt;
      &lt;td&gt;49.895259&lt;/td&gt;
      &lt;td&gt;59.792699&lt;/td&gt;
      &lt;td&gt;51.694526&lt;/td&gt;
      &lt;td&gt;56.553728&lt;/td&gt;
      &lt;td&gt;56.553728&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22&lt;/th&gt;
      &lt;td&gt;VNM&lt;/td&gt;
      &lt;td&gt;Viet Nam&lt;/td&gt;
      &lt;td&gt;1381744.4&lt;/td&gt;
      &lt;td&gt;1365173.8&lt;/td&gt;
      &lt;td&gt;1360551.6&lt;/td&gt;
      &lt;td&gt;1336231.2&lt;/td&gt;
      &lt;td&gt;1318431.1&lt;/td&gt;
      &lt;td&gt;34543610.0&lt;/td&gt;
      &lt;td&gt;34129345.0&lt;/td&gt;
      &lt;td&gt;34013790.0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;3.761740&lt;/td&gt;
      &lt;td&gt;0.902428&lt;/td&gt;
      &lt;td&gt;0.902428&lt;/td&gt;
      &lt;td&gt;2.585962&lt;/td&gt;
      &lt;td&gt;-8.687738&lt;/td&gt;
      &lt;td&gt;-3.372544&lt;/td&gt;
      &lt;td&gt;1.405162&lt;/td&gt;
      &lt;td&gt;3.692293&lt;/td&gt;
      &lt;td&gt;-0.906518&lt;/td&gt;
      &lt;td&gt;-0.906518&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;23 rows  73 columns&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&#34;recalculate-means&#34; &gt;Recalculate Means
&lt;span&gt;
    &lt;a href=&#34;#recalculate-means&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;merged_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;loc[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; merged_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;select_dtypes(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;number)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean()

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;merged_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;at[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_name_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;
merged_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;at[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_name_TRACE&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;merged_df
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div style=&#34;overflow-x:auto;&#34;&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;iso3_country&lt;/th&gt;
      &lt;th&gt;country_name_FAOSTAT&lt;/th&gt;
      &lt;th&gt;2015&lt;/th&gt;
      &lt;th&gt;2016&lt;/th&gt;
      &lt;th&gt;2017&lt;/th&gt;
      &lt;th&gt;2018&lt;/th&gt;
      &lt;th&gt;2019&lt;/th&gt;
      &lt;th&gt;tCO2_2015_FAOSTAT&lt;/th&gt;
      &lt;th&gt;tCO2_2016_FAOSTAT&lt;/th&gt;
      &lt;th&gt;tCO2_2017_FAOSTAT&lt;/th&gt;
      &lt;th&gt;...&lt;/th&gt;
      &lt;th&gt;CO2_abs_percent_diff_2019&lt;/th&gt;
      &lt;th&gt;CO2_abs_percent_diff_means&lt;/th&gt;
      &lt;th&gt;CO2_abs_percent_diff_totals&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_2015&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_2016&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_2017&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_2018&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_2019&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_means&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_totals&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;BGD&lt;/td&gt;
      &lt;td&gt;Bangladesh&lt;/td&gt;
      &lt;td&gt;1131293.4&lt;/td&gt;
      &lt;td&gt;1.093480e+06&lt;/td&gt;
      &lt;td&gt;1.154531e+06&lt;/td&gt;
      &lt;td&gt;1.144591e+06&lt;/td&gt;
      &lt;td&gt;1.144745e+06&lt;/td&gt;
      &lt;td&gt;28282335.0&lt;/td&gt;
      &lt;td&gt;2.733701e+07&lt;/td&gt;
      &lt;td&gt;2.886328e+07&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;57.606797&lt;/td&gt;
      &lt;td&gt;63.425917&lt;/td&gt;
      &lt;td&gt;63.425917&lt;/td&gt;
      &lt;td&gt;-107.233570&lt;/td&gt;
      &lt;td&gt;-108.340089&lt;/td&gt;
      &lt;td&gt;-81.801753&lt;/td&gt;
      &lt;td&gt;-87.073857&lt;/td&gt;
      &lt;td&gt;-80.912284&lt;/td&gt;
      &lt;td&gt;-92.881337&lt;/td&gt;
      &lt;td&gt;-92.881337&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;BRA&lt;/td&gt;
      &lt;td&gt;Brazil&lt;/td&gt;
      &lt;td&gt;138910.3&lt;/td&gt;
      &lt;td&gt;1.262782e+05&lt;/td&gt;
      &lt;td&gt;1.303229e+05&lt;/td&gt;
      &lt;td&gt;1.216152e+05&lt;/td&gt;
      &lt;td&gt;1.110848e+05&lt;/td&gt;
      &lt;td&gt;3472757.5&lt;/td&gt;
      &lt;td&gt;3.156955e+06&lt;/td&gt;
      &lt;td&gt;3.258072e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;99.141295&lt;/td&gt;
      &lt;td&gt;93.222402&lt;/td&gt;
      &lt;td&gt;93.222402&lt;/td&gt;
      &lt;td&gt;-145.498958&lt;/td&gt;
      &lt;td&gt;-145.821472&lt;/td&gt;
      &lt;td&gt;-185.841820&lt;/td&gt;
      &lt;td&gt;-205.638590&lt;/td&gt;
      &lt;td&gt;-196.594424&lt;/td&gt;
      &lt;td&gt;-174.610414&lt;/td&gt;
      &lt;td&gt;-174.610414&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;CHN&lt;/td&gt;
      &lt;td&gt;China&lt;/td&gt;
      &lt;td&gt;5406593.9&lt;/td&gt;
      &lt;td&gt;5.399920e+06&lt;/td&gt;
      &lt;td&gt;5.400129e+06&lt;/td&gt;
      &lt;td&gt;5.302173e+06&lt;/td&gt;
      &lt;td&gt;5.214455e+06&lt;/td&gt;
      &lt;td&gt;135164847.5&lt;/td&gt;
      &lt;td&gt;1.349980e+08&lt;/td&gt;
      &lt;td&gt;1.350032e+08&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;7.189945&lt;/td&gt;
      &lt;td&gt;9.421813&lt;/td&gt;
      &lt;td&gt;9.421813&lt;/td&gt;
      &lt;td&gt;-13.447527&lt;/td&gt;
      &lt;td&gt;-8.511442&lt;/td&gt;
      &lt;td&gt;-17.683689&lt;/td&gt;
      &lt;td&gt;-2.108366&lt;/td&gt;
      &lt;td&gt;-7.458060&lt;/td&gt;
      &lt;td&gt;-9.887609&lt;/td&gt;
      &lt;td&gt;-9.887609&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;ESP&lt;/td&gt;
      &lt;td&gt;Spain&lt;/td&gt;
      &lt;td&gt;55082.2&lt;/td&gt;
      &lt;td&gt;5.507310e+04&lt;/td&gt;
      &lt;td&gt;5.423240e+04&lt;/td&gt;
      &lt;td&gt;5.292500e+04&lt;/td&gt;
      &lt;td&gt;5.209850e+04&lt;/td&gt;
      &lt;td&gt;1377055.0&lt;/td&gt;
      &lt;td&gt;1.376828e+06&lt;/td&gt;
      &lt;td&gt;1.355810e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;127.757634&lt;/td&gt;
      &lt;td&gt;124.705066&lt;/td&gt;
      &lt;td&gt;124.705066&lt;/td&gt;
      &lt;td&gt;79.277072&lt;/td&gt;
      &lt;td&gt;75.763074&lt;/td&gt;
      &lt;td&gt;77.554025&lt;/td&gt;
      &lt;td&gt;73.445258&lt;/td&gt;
      &lt;td&gt;77.958601&lt;/td&gt;
      &lt;td&gt;76.811284&lt;/td&gt;
      &lt;td&gt;76.811284&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;IDN&lt;/td&gt;
      &lt;td&gt;Indonesia&lt;/td&gt;
      &lt;td&gt;2407953.5&lt;/td&gt;
      &lt;td&gt;2.387656e+06&lt;/td&gt;
      &lt;td&gt;2.425291e+06&lt;/td&gt;
      &lt;td&gt;2.405614e+06&lt;/td&gt;
      &lt;td&gt;2.257604e+06&lt;/td&gt;
      &lt;td&gt;60198837.5&lt;/td&gt;
      &lt;td&gt;5.969141e+07&lt;/td&gt;
      &lt;td&gt;6.063226e+07&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;56.234955&lt;/td&gt;
      &lt;td&gt;70.153790&lt;/td&gt;
      &lt;td&gt;70.153790&lt;/td&gt;
      &lt;td&gt;46.691296&lt;/td&gt;
      &lt;td&gt;57.149216&lt;/td&gt;
      &lt;td&gt;60.353916&lt;/td&gt;
      &lt;td&gt;51.073546&lt;/td&gt;
      &lt;td&gt;43.893273&lt;/td&gt;
      &lt;td&gt;51.936188&lt;/td&gt;
      &lt;td&gt;51.936188&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;IND&lt;/td&gt;
      &lt;td&gt;India&lt;/td&gt;
      &lt;td&gt;4580248.4&lt;/td&gt;
      &lt;td&gt;4.559136e+06&lt;/td&gt;
      &lt;td&gt;4.620791e+06&lt;/td&gt;
      &lt;td&gt;4.661155e+06&lt;/td&gt;
      &lt;td&gt;4.621417e+06&lt;/td&gt;
      &lt;td&gt;114506210.0&lt;/td&gt;
      &lt;td&gt;1.139784e+08&lt;/td&gt;
      &lt;td&gt;1.155198e+08&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;47.515394&lt;/td&gt;
      &lt;td&gt;32.086209&lt;/td&gt;
      &lt;td&gt;32.086209&lt;/td&gt;
      &lt;td&gt;-35.798018&lt;/td&gt;
      &lt;td&gt;-16.456550&lt;/td&gt;
      &lt;td&gt;-34.791882&lt;/td&gt;
      &lt;td&gt;-41.376939&lt;/td&gt;
      &lt;td&gt;-62.321563&lt;/td&gt;
      &lt;td&gt;-38.217479&lt;/td&gt;
      &lt;td&gt;-38.217479&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;IRN&lt;/td&gt;
      &lt;td&gt;Iran (Islamic Republic of)&lt;/td&gt;
      &lt;td&gt;116486.7&lt;/td&gt;
      &lt;td&gt;1.310085e+05&lt;/td&gt;
      &lt;td&gt;8.723360e+04&lt;/td&gt;
      &lt;td&gt;9.393660e+04&lt;/td&gt;
      &lt;td&gt;9.610340e+04&lt;/td&gt;
      &lt;td&gt;2912167.5&lt;/td&gt;
      &lt;td&gt;3.275212e+06&lt;/td&gt;
      &lt;td&gt;2.180840e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;1.152675&lt;/td&gt;
      &lt;td&gt;13.260902&lt;/td&gt;
      &lt;td&gt;13.260902&lt;/td&gt;
      &lt;td&gt;24.674600&lt;/td&gt;
      &lt;td&gt;29.927285&lt;/td&gt;
      &lt;td&gt;-10.281098&lt;/td&gt;
      &lt;td&gt;5.513463&lt;/td&gt;
      &lt;td&gt;1.146070&lt;/td&gt;
      &lt;td&gt;12.436318&lt;/td&gt;
      &lt;td&gt;12.436318&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;ITA&lt;/td&gt;
      &lt;td&gt;Italy&lt;/td&gt;
      &lt;td&gt;114574.8&lt;/td&gt;
      &lt;td&gt;1.180030e+05&lt;/td&gt;
      &lt;td&gt;1.180030e+05&lt;/td&gt;
      &lt;td&gt;1.094638e+05&lt;/td&gt;
      &lt;td&gt;1.108951e+05&lt;/td&gt;
      &lt;td&gt;2864370.0&lt;/td&gt;
      &lt;td&gt;2.950075e+06&lt;/td&gt;
      &lt;td&gt;2.950075e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;83.321649&lt;/td&gt;
      &lt;td&gt;80.187551&lt;/td&gt;
      &lt;td&gt;80.187551&lt;/td&gt;
      &lt;td&gt;56.395576&lt;/td&gt;
      &lt;td&gt;58.155426&lt;/td&gt;
      &lt;td&gt;53.868303&lt;/td&gt;
      &lt;td&gt;59.165480&lt;/td&gt;
      &lt;td&gt;58.817707&lt;/td&gt;
      &lt;td&gt;57.238482&lt;/td&gt;
      &lt;td&gt;57.238482&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;JPN&lt;/td&gt;
      &lt;td&gt;Japan&lt;/td&gt;
      &lt;td&gt;330353.1&lt;/td&gt;
      &lt;td&gt;3.264030e+05&lt;/td&gt;
      &lt;td&gt;3.237003e+05&lt;/td&gt;
      &lt;td&gt;3.222450e+05&lt;/td&gt;
      &lt;td&gt;3.205818e+05&lt;/td&gt;
      &lt;td&gt;8258827.5&lt;/td&gt;
      &lt;td&gt;8.160075e+06&lt;/td&gt;
      &lt;td&gt;8.092508e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;31.555853&lt;/td&gt;
      &lt;td&gt;36.874729&lt;/td&gt;
      &lt;td&gt;36.874729&lt;/td&gt;
      &lt;td&gt;30.212099&lt;/td&gt;
      &lt;td&gt;30.021068&lt;/td&gt;
      &lt;td&gt;16.313490&lt;/td&gt;
      &lt;td&gt;51.954183&lt;/td&gt;
      &lt;td&gt;27.255501&lt;/td&gt;
      &lt;td&gt;31.134372&lt;/td&gt;
      &lt;td&gt;31.134372&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;KHM&lt;/td&gt;
      &lt;td&gt;Cambodia&lt;/td&gt;
      &lt;td&gt;436826.0&lt;/td&gt;
      &lt;td&gt;4.590031e+05&lt;/td&gt;
      &lt;td&gt;4.737453e+05&lt;/td&gt;
      &lt;td&gt;4.793627e+05&lt;/td&gt;
      &lt;td&gt;4.683789e+05&lt;/td&gt;
      &lt;td&gt;10920650.0&lt;/td&gt;
      &lt;td&gt;1.147508e+07&lt;/td&gt;
      &lt;td&gt;1.184363e+07&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;23.769728&lt;/td&gt;
      &lt;td&gt;14.304565&lt;/td&gt;
      &lt;td&gt;14.304565&lt;/td&gt;
      &lt;td&gt;-13.424988&lt;/td&gt;
      &lt;td&gt;-24.872761&lt;/td&gt;
      &lt;td&gt;4.652461&lt;/td&gt;
      &lt;td&gt;-16.667610&lt;/td&gt;
      &lt;td&gt;-26.975760&lt;/td&gt;
      &lt;td&gt;-15.406481&lt;/td&gt;
      &lt;td&gt;-15.406481&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;KOR&lt;/td&gt;
      &lt;td&gt;Korea (the Republic of)&lt;/td&gt;
      &lt;td&gt;167862.2&lt;/td&gt;
      &lt;td&gt;1.635341e+05&lt;/td&gt;
      &lt;td&gt;1.584897e+05&lt;/td&gt;
      &lt;td&gt;1.549113e+05&lt;/td&gt;
      &lt;td&gt;1.532609e+05&lt;/td&gt;
      &lt;td&gt;4196555.0&lt;/td&gt;
      &lt;td&gt;4.088352e+06&lt;/td&gt;
      &lt;td&gt;3.962243e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;14.321600&lt;/td&gt;
      &lt;td&gt;15.813819&lt;/td&gt;
      &lt;td&gt;15.813819&lt;/td&gt;
      &lt;td&gt;13.507737&lt;/td&gt;
      &lt;td&gt;22.059230&lt;/td&gt;
      &lt;td&gt;7.677136&lt;/td&gt;
      &lt;td&gt;16.497815&lt;/td&gt;
      &lt;td&gt;13.364589&lt;/td&gt;
      &lt;td&gt;14.655057&lt;/td&gt;
      &lt;td&gt;14.655057&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;LAO&lt;/td&gt;
      &lt;td&gt;Lao People&#39;s Democratic Republic (the)&lt;/td&gt;
      &lt;td&gt;94826.8&lt;/td&gt;
      &lt;td&gt;9.563000e+04&lt;/td&gt;
      &lt;td&gt;9.394070e+04&lt;/td&gt;
      &lt;td&gt;8.333360e+04&lt;/td&gt;
      &lt;td&gt;7.700550e+04&lt;/td&gt;
      &lt;td&gt;2370670.0&lt;/td&gt;
      &lt;td&gt;2.390750e+06&lt;/td&gt;
      &lt;td&gt;2.348518e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;136.209544&lt;/td&gt;
      &lt;td&gt;145.627378&lt;/td&gt;
      &lt;td&gt;145.627378&lt;/td&gt;
      &lt;td&gt;82.482067&lt;/td&gt;
      &lt;td&gt;82.260369&lt;/td&gt;
      &lt;td&gt;87.565950&lt;/td&gt;
      &lt;td&gt;87.883944&lt;/td&gt;
      &lt;td&gt;81.026578&lt;/td&gt;
      &lt;td&gt;84.268427&lt;/td&gt;
      &lt;td&gt;84.268427&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;LKA&lt;/td&gt;
      &lt;td&gt;Sri Lanka&lt;/td&gt;
      &lt;td&gt;132640.0&lt;/td&gt;
      &lt;td&gt;1.217563e+05&lt;/td&gt;
      &lt;td&gt;8.445630e+04&lt;/td&gt;
      &lt;td&gt;1.110490e+05&lt;/td&gt;
      &lt;td&gt;1.021563e+05&lt;/td&gt;
      &lt;td&gt;3316000.0&lt;/td&gt;
      &lt;td&gt;3.043908e+06&lt;/td&gt;
      &lt;td&gt;2.111408e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;18.612972&lt;/td&gt;
      &lt;td&gt;27.569003&lt;/td&gt;
      &lt;td&gt;27.569003&lt;/td&gt;
      &lt;td&gt;37.382189&lt;/td&gt;
      &lt;td&gt;16.904226&lt;/td&gt;
      &lt;td&gt;30.001182&lt;/td&gt;
      &lt;td&gt;18.784377&lt;/td&gt;
      &lt;td&gt;17.028241&lt;/td&gt;
      &lt;td&gt;24.229137&lt;/td&gt;
      &lt;td&gt;24.229137&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;MMR&lt;/td&gt;
      &lt;td&gt;Myanmar&lt;/td&gt;
      &lt;td&gt;1059409.6&lt;/td&gt;
      &lt;td&gt;1.052288e+06&lt;/td&gt;
      &lt;td&gt;1.087030e+06&lt;/td&gt;
      &lt;td&gt;1.118850e+06&lt;/td&gt;
      &lt;td&gt;1.083100e+06&lt;/td&gt;
      &lt;td&gt;26485240.0&lt;/td&gt;
      &lt;td&gt;2.630719e+07&lt;/td&gt;
      &lt;td&gt;2.717574e+07&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;14.853751&lt;/td&gt;
      &lt;td&gt;14.697380&lt;/td&gt;
      &lt;td&gt;14.697380&lt;/td&gt;
      &lt;td&gt;-6.859731&lt;/td&gt;
      &lt;td&gt;-22.666619&lt;/td&gt;
      &lt;td&gt;-10.868129&lt;/td&gt;
      &lt;td&gt;-22.665852&lt;/td&gt;
      &lt;td&gt;-16.045425&lt;/td&gt;
      &lt;td&gt;-15.863111&lt;/td&gt;
      &lt;td&gt;-15.863111&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;MYS&lt;/td&gt;
      &lt;td&gt;Malaysia&lt;/td&gt;
      &lt;td&gt;121942.6&lt;/td&gt;
      &lt;td&gt;1.232328e+05&lt;/td&gt;
      &lt;td&gt;1.226563e+05&lt;/td&gt;
      &lt;td&gt;1.252385e+05&lt;/td&gt;
      &lt;td&gt;1.224538e+05&lt;/td&gt;
      &lt;td&gt;3048565.0&lt;/td&gt;
      &lt;td&gt;3.080820e+06&lt;/td&gt;
      &lt;td&gt;3.066408e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;14.753544&lt;/td&gt;
      &lt;td&gt;13.043224&lt;/td&gt;
      &lt;td&gt;13.043224&lt;/td&gt;
      &lt;td&gt;13.287137&lt;/td&gt;
      &lt;td&gt;9.922595&lt;/td&gt;
      &lt;td&gt;9.398001&lt;/td&gt;
      &lt;td&gt;14.840462&lt;/td&gt;
      &lt;td&gt;13.739977&lt;/td&gt;
      &lt;td&gt;12.244674&lt;/td&gt;
      &lt;td&gt;12.244674&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;NPL&lt;/td&gt;
      &lt;td&gt;Nepal&lt;/td&gt;
      &lt;td&gt;149262.2&lt;/td&gt;
      &lt;td&gt;1.427237e+05&lt;/td&gt;
      &lt;td&gt;1.625746e+05&lt;/td&gt;
      &lt;td&gt;1.538908e+05&lt;/td&gt;
      &lt;td&gt;1.562154e+05&lt;/td&gt;
      &lt;td&gt;3731555.0&lt;/td&gt;
      &lt;td&gt;3.568093e+06&lt;/td&gt;
      &lt;td&gt;4.064365e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;29.190154&lt;/td&gt;
      &lt;td&gt;50.437328&lt;/td&gt;
      &lt;td&gt;50.437328&lt;/td&gt;
      &lt;td&gt;32.502761&lt;/td&gt;
      &lt;td&gt;53.286238&lt;/td&gt;
      &lt;td&gt;50.291743&lt;/td&gt;
      &lt;td&gt;40.212459&lt;/td&gt;
      &lt;td&gt;25.472433&lt;/td&gt;
      &lt;td&gt;40.279401&lt;/td&gt;
      &lt;td&gt;40.279401&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;PAK&lt;/td&gt;
      &lt;td&gt;Pakistan&lt;/td&gt;
      &lt;td&gt;383529.3&lt;/td&gt;
      &lt;td&gt;3.813618e+05&lt;/td&gt;
      &lt;td&gt;4.060833e+05&lt;/td&gt;
      &lt;td&gt;3.934042e+05&lt;/td&gt;
      &lt;td&gt;4.247551e+05&lt;/td&gt;
      &lt;td&gt;9588232.5&lt;/td&gt;
      &lt;td&gt;9.534045e+06&lt;/td&gt;
      &lt;td&gt;1.015208e+07&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;42.334367&lt;/td&gt;
      &lt;td&gt;31.154530&lt;/td&gt;
      &lt;td&gt;31.154530&lt;/td&gt;
      &lt;td&gt;-26.520489&lt;/td&gt;
      &lt;td&gt;-55.912882&lt;/td&gt;
      &lt;td&gt;-32.303912&lt;/td&gt;
      &lt;td&gt;-15.207139&lt;/td&gt;
      &lt;td&gt;-53.701452&lt;/td&gt;
      &lt;td&gt;-36.903009&lt;/td&gt;
      &lt;td&gt;-36.903009&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;PHL&lt;/td&gt;
      &lt;td&gt;Philippines (the)&lt;/td&gt;
      &lt;td&gt;1557810.6&lt;/td&gt;
      &lt;td&gt;1.524292e+06&lt;/td&gt;
      &lt;td&gt;1.609862e+06&lt;/td&gt;
      &lt;td&gt;1.606048e+06&lt;/td&gt;
      &lt;td&gt;1.556226e+06&lt;/td&gt;
      &lt;td&gt;38945265.0&lt;/td&gt;
      &lt;td&gt;3.810731e+07&lt;/td&gt;
      &lt;td&gt;4.024656e+07&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;125.114417&lt;/td&gt;
      &lt;td&gt;121.748165&lt;/td&gt;
      &lt;td&gt;121.748165&lt;/td&gt;
      &lt;td&gt;77.968948&lt;/td&gt;
      &lt;td&gt;73.275770&lt;/td&gt;
      &lt;td&gt;76.166725&lt;/td&gt;
      &lt;td&gt;74.003201&lt;/td&gt;
      &lt;td&gt;76.966391&lt;/td&gt;
      &lt;td&gt;75.679166&lt;/td&gt;
      &lt;td&gt;75.679166&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;PRK&lt;/td&gt;
      &lt;td&gt;Korea (the Democratic People&#39;s Republic of)&lt;/td&gt;
      &lt;td&gt;82823.3&lt;/td&gt;
      &lt;td&gt;8.344230e+04&lt;/td&gt;
      &lt;td&gt;8.459620e+04&lt;/td&gt;
      &lt;td&gt;8.394330e+04&lt;/td&gt;
      &lt;td&gt;8.293700e+04&lt;/td&gt;
      &lt;td&gt;2070582.5&lt;/td&gt;
      &lt;td&gt;2.086058e+06&lt;/td&gt;
      &lt;td&gt;2.114905e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;15.169422&lt;/td&gt;
      &lt;td&gt;17.492669&lt;/td&gt;
      &lt;td&gt;17.492669&lt;/td&gt;
      &lt;td&gt;-38.030793&lt;/td&gt;
      &lt;td&gt;-9.988016&lt;/td&gt;
      &lt;td&gt;-28.310326&lt;/td&gt;
      &lt;td&gt;-3.195586&lt;/td&gt;
      &lt;td&gt;-16.414407&lt;/td&gt;
      &lt;td&gt;-19.169278&lt;/td&gt;
      &lt;td&gt;-19.169278&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;THA&lt;/td&gt;
      &lt;td&gt;Thailand&lt;/td&gt;
      &lt;td&gt;1554254.0&lt;/td&gt;
      &lt;td&gt;1.703328e+06&lt;/td&gt;
      &lt;td&gt;1.714466e+06&lt;/td&gt;
      &lt;td&gt;1.702989e+06&lt;/td&gt;
      &lt;td&gt;1.553836e+06&lt;/td&gt;
      &lt;td&gt;38856350.0&lt;/td&gt;
      &lt;td&gt;4.258319e+07&lt;/td&gt;
      &lt;td&gt;4.286164e+07&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;17.404685&lt;/td&gt;
      &lt;td&gt;22.551331&lt;/td&gt;
      &lt;td&gt;22.551331&lt;/td&gt;
      &lt;td&gt;10.323662&lt;/td&gt;
      &lt;td&gt;-4.559627&lt;/td&gt;
      &lt;td&gt;32.066348&lt;/td&gt;
      &lt;td&gt;46.173612&lt;/td&gt;
      &lt;td&gt;16.011325&lt;/td&gt;
      &lt;td&gt;20.266184&lt;/td&gt;
      &lt;td&gt;20.266184&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;20&lt;/th&gt;
      &lt;td&gt;TWN&lt;/td&gt;
      &lt;td&gt;Taiwan (Province of China)&lt;/td&gt;
      &lt;td&gt;45838.7&lt;/td&gt;
      &lt;td&gt;4.983830e+04&lt;/td&gt;
      &lt;td&gt;4.999120e+04&lt;/td&gt;
      &lt;td&gt;4.941410e+04&lt;/td&gt;
      &lt;td&gt;4.915200e+04&lt;/td&gt;
      &lt;td&gt;1145967.5&lt;/td&gt;
      &lt;td&gt;1.245958e+06&lt;/td&gt;
      &lt;td&gt;1.249780e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;58.617135&lt;/td&gt;
      &lt;td&gt;52.458032&lt;/td&gt;
      &lt;td&gt;52.458032&lt;/td&gt;
      &lt;td&gt;-71.622589&lt;/td&gt;
      &lt;td&gt;-62.307893&lt;/td&gt;
      &lt;td&gt;-74.143329&lt;/td&gt;
      &lt;td&gt;-64.692890&lt;/td&gt;
      &lt;td&gt;-82.919716&lt;/td&gt;
      &lt;td&gt;-71.109302&lt;/td&gt;
      &lt;td&gt;-71.109302&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;21&lt;/th&gt;
      &lt;td&gt;USA&lt;/td&gt;
      &lt;td&gt;United States of America (the)&lt;/td&gt;
      &lt;td&gt;364728.0&lt;/td&gt;
      &lt;td&gt;4.386620e+05&lt;/td&gt;
      &lt;td&gt;3.362555e+05&lt;/td&gt;
      &lt;td&gt;4.121775e+05&lt;/td&gt;
      &lt;td&gt;3.501365e+05&lt;/td&gt;
      &lt;td&gt;9118200.0&lt;/td&gt;
      &lt;td&gt;1.096655e+07&lt;/td&gt;
      &lt;td&gt;8.406388e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;69.713577&lt;/td&gt;
      &lt;td&gt;78.850049&lt;/td&gt;
      &lt;td&gt;78.850049&lt;/td&gt;
      &lt;td&gt;55.821215&lt;/td&gt;
      &lt;td&gt;63.101978&lt;/td&gt;
      &lt;td&gt;49.895259&lt;/td&gt;
      &lt;td&gt;59.792699&lt;/td&gt;
      &lt;td&gt;51.694526&lt;/td&gt;
      &lt;td&gt;56.553728&lt;/td&gt;
      &lt;td&gt;56.553728&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22&lt;/th&gt;
      &lt;td&gt;VNM&lt;/td&gt;
      &lt;td&gt;Viet Nam&lt;/td&gt;
      &lt;td&gt;1381744.4&lt;/td&gt;
      &lt;td&gt;1.365174e+06&lt;/td&gt;
      &lt;td&gt;1.360552e+06&lt;/td&gt;
      &lt;td&gt;1.336231e+06&lt;/td&gt;
      &lt;td&gt;1.318431e+06&lt;/td&gt;
      &lt;td&gt;34543610.0&lt;/td&gt;
      &lt;td&gt;3.412934e+07&lt;/td&gt;
      &lt;td&gt;3.401379e+07&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;3.761740&lt;/td&gt;
      &lt;td&gt;0.902428&lt;/td&gt;
      &lt;td&gt;0.902428&lt;/td&gt;
      &lt;td&gt;2.585962&lt;/td&gt;
      &lt;td&gt;-8.687738&lt;/td&gt;
      &lt;td&gt;-3.372544&lt;/td&gt;
      &lt;td&gt;1.405162&lt;/td&gt;
      &lt;td&gt;3.692293&lt;/td&gt;
      &lt;td&gt;-0.906518&lt;/td&gt;
      &lt;td&gt;-0.906518&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;mean&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;mean&lt;/td&gt;
      &lt;td&gt;948478.0&lt;/td&gt;
      &lt;td&gt;9.522272e+05&lt;/td&gt;
      &lt;td&gt;9.590840e+05&lt;/td&gt;
      &lt;td&gt;9.575896e+05&lt;/td&gt;
      &lt;td&gt;9.316100e+05&lt;/td&gt;
      &lt;td&gt;23711950.0&lt;/td&gt;
      &lt;td&gt;2.380568e+07&lt;/td&gt;
      &lt;td&gt;2.397710e+07&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;47.621862&lt;/td&gt;
      &lt;td&gt;49.129925&lt;/td&gt;
      &lt;td&gt;49.129925&lt;/td&gt;
      &lt;td&gt;4.551116&lt;/td&gt;
      &lt;td&gt;4.508756&lt;/td&gt;
      &lt;td&gt;3.322003&lt;/td&gt;
      &lt;td&gt;6.179080&lt;/td&gt;
      &lt;td&gt;-1.533721&lt;/td&gt;
      &lt;td&gt;3.599038&lt;/td&gt;
      &lt;td&gt;3.599038&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;24 rows  73 columns&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&#34;recalculate-totals&#34; &gt;Recalculate Totals
&lt;span&gt;
    &lt;a href=&#34;#recalculate-totals&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;merged_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;loc[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;total&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; merged_df[merged_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_name_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;select_dtypes(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;number)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sum()
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;merged_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;at[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;total&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_name_FAOSTAT&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;total&amp;#39;&lt;/span&gt;
merged_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;at[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;total&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_name_TRACE&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;total&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;merged_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;reset_index(inplace&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, drop &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;merged_df
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div style=&#34;overflow-x:auto;&#34;&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/style&gt;&lt;/p&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;iso3_country&lt;/th&gt;
      &lt;th&gt;country_name_FAOSTAT&lt;/th&gt;
      &lt;th&gt;2015&lt;/th&gt;
      &lt;th&gt;2016&lt;/th&gt;
      &lt;th&gt;2017&lt;/th&gt;
      &lt;th&gt;2018&lt;/th&gt;
      &lt;th&gt;2019&lt;/th&gt;
      &lt;th&gt;tCO2_2015_FAOSTAT&lt;/th&gt;
      &lt;th&gt;tCO2_2016_FAOSTAT&lt;/th&gt;
      &lt;th&gt;tCO2_2017_FAOSTAT&lt;/th&gt;
      &lt;th&gt;...&lt;/th&gt;
      &lt;th&gt;CO2_abs_percent_diff_2019&lt;/th&gt;
      &lt;th&gt;CO2_abs_percent_diff_means&lt;/th&gt;
      &lt;th&gt;CO2_abs_percent_diff_totals&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_2015&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_2016&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_2017&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_2018&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_2019&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_means&lt;/th&gt;
      &lt;th&gt;CO2_relative_percent_diff_totals&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;BGD&lt;/td&gt;
      &lt;td&gt;Bangladesh&lt;/td&gt;
      &lt;td&gt;1131293.4&lt;/td&gt;
      &lt;td&gt;1.093480e+06&lt;/td&gt;
      &lt;td&gt;1.154531e+06&lt;/td&gt;
      &lt;td&gt;1.144591e+06&lt;/td&gt;
      &lt;td&gt;1.144745e+06&lt;/td&gt;
      &lt;td&gt;28282335.0&lt;/td&gt;
      &lt;td&gt;2.733701e+07&lt;/td&gt;
      &lt;td&gt;2.886328e+07&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;57.606797&lt;/td&gt;
      &lt;td&gt;63.425917&lt;/td&gt;
      &lt;td&gt;63.425917&lt;/td&gt;
      &lt;td&gt;-107.233570&lt;/td&gt;
      &lt;td&gt;-108.340089&lt;/td&gt;
      &lt;td&gt;-81.801753&lt;/td&gt;
      &lt;td&gt;-87.073857&lt;/td&gt;
      &lt;td&gt;-80.912284&lt;/td&gt;
      &lt;td&gt;-92.881337&lt;/td&gt;
      &lt;td&gt;-92.881337&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;BRA&lt;/td&gt;
      &lt;td&gt;Brazil&lt;/td&gt;
      &lt;td&gt;138910.3&lt;/td&gt;
      &lt;td&gt;1.262782e+05&lt;/td&gt;
      &lt;td&gt;1.303229e+05&lt;/td&gt;
      &lt;td&gt;1.216152e+05&lt;/td&gt;
      &lt;td&gt;1.110848e+05&lt;/td&gt;
      &lt;td&gt;3472757.5&lt;/td&gt;
      &lt;td&gt;3.156955e+06&lt;/td&gt;
      &lt;td&gt;3.258072e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;99.141295&lt;/td&gt;
      &lt;td&gt;93.222402&lt;/td&gt;
      &lt;td&gt;93.222402&lt;/td&gt;
      &lt;td&gt;-145.498958&lt;/td&gt;
      &lt;td&gt;-145.821472&lt;/td&gt;
      &lt;td&gt;-185.841820&lt;/td&gt;
      &lt;td&gt;-205.638590&lt;/td&gt;
      &lt;td&gt;-196.594424&lt;/td&gt;
      &lt;td&gt;-174.610414&lt;/td&gt;
      &lt;td&gt;-174.610414&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;CHN&lt;/td&gt;
      &lt;td&gt;China&lt;/td&gt;
      &lt;td&gt;5406593.9&lt;/td&gt;
      &lt;td&gt;5.399920e+06&lt;/td&gt;
      &lt;td&gt;5.400129e+06&lt;/td&gt;
      &lt;td&gt;5.302173e+06&lt;/td&gt;
      &lt;td&gt;5.214455e+06&lt;/td&gt;
      &lt;td&gt;135164847.5&lt;/td&gt;
      &lt;td&gt;1.349980e+08&lt;/td&gt;
      &lt;td&gt;1.350032e+08&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;7.189945&lt;/td&gt;
      &lt;td&gt;9.421813&lt;/td&gt;
      &lt;td&gt;9.421813&lt;/td&gt;
      &lt;td&gt;-13.447527&lt;/td&gt;
      &lt;td&gt;-8.511442&lt;/td&gt;
      &lt;td&gt;-17.683689&lt;/td&gt;
      &lt;td&gt;-2.108366&lt;/td&gt;
      &lt;td&gt;-7.458060&lt;/td&gt;
      &lt;td&gt;-9.887609&lt;/td&gt;
      &lt;td&gt;-9.887609&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;ESP&lt;/td&gt;
      &lt;td&gt;Spain&lt;/td&gt;
      &lt;td&gt;55082.2&lt;/td&gt;
      &lt;td&gt;5.507310e+04&lt;/td&gt;
      &lt;td&gt;5.423240e+04&lt;/td&gt;
      &lt;td&gt;5.292500e+04&lt;/td&gt;
      &lt;td&gt;5.209850e+04&lt;/td&gt;
      &lt;td&gt;1377055.0&lt;/td&gt;
      &lt;td&gt;1.376828e+06&lt;/td&gt;
      &lt;td&gt;1.355810e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;127.757634&lt;/td&gt;
      &lt;td&gt;124.705066&lt;/td&gt;
      &lt;td&gt;124.705066&lt;/td&gt;
      &lt;td&gt;79.277072&lt;/td&gt;
      &lt;td&gt;75.763074&lt;/td&gt;
      &lt;td&gt;77.554025&lt;/td&gt;
      &lt;td&gt;73.445258&lt;/td&gt;
      &lt;td&gt;77.958601&lt;/td&gt;
      &lt;td&gt;76.811284&lt;/td&gt;
      &lt;td&gt;76.811284&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;IDN&lt;/td&gt;
      &lt;td&gt;Indonesia&lt;/td&gt;
      &lt;td&gt;2407953.5&lt;/td&gt;
      &lt;td&gt;2.387656e+06&lt;/td&gt;
      &lt;td&gt;2.425291e+06&lt;/td&gt;
      &lt;td&gt;2.405614e+06&lt;/td&gt;
      &lt;td&gt;2.257604e+06&lt;/td&gt;
      &lt;td&gt;60198837.5&lt;/td&gt;
      &lt;td&gt;5.969141e+07&lt;/td&gt;
      &lt;td&gt;6.063226e+07&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;56.234955&lt;/td&gt;
      &lt;td&gt;70.153790&lt;/td&gt;
      &lt;td&gt;70.153790&lt;/td&gt;
      &lt;td&gt;46.691296&lt;/td&gt;
      &lt;td&gt;57.149216&lt;/td&gt;
      &lt;td&gt;60.353916&lt;/td&gt;
      &lt;td&gt;51.073546&lt;/td&gt;
      &lt;td&gt;43.893273&lt;/td&gt;
      &lt;td&gt;51.936188&lt;/td&gt;
      &lt;td&gt;51.936188&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;IND&lt;/td&gt;
      &lt;td&gt;India&lt;/td&gt;
      &lt;td&gt;4580248.4&lt;/td&gt;
      &lt;td&gt;4.559136e+06&lt;/td&gt;
      &lt;td&gt;4.620791e+06&lt;/td&gt;
      &lt;td&gt;4.661155e+06&lt;/td&gt;
      &lt;td&gt;4.621417e+06&lt;/td&gt;
      &lt;td&gt;114506210.0&lt;/td&gt;
      &lt;td&gt;1.139784e+08&lt;/td&gt;
      &lt;td&gt;1.155198e+08&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;47.515394&lt;/td&gt;
      &lt;td&gt;32.086209&lt;/td&gt;
      &lt;td&gt;32.086209&lt;/td&gt;
      &lt;td&gt;-35.798018&lt;/td&gt;
      &lt;td&gt;-16.456550&lt;/td&gt;
      &lt;td&gt;-34.791882&lt;/td&gt;
      &lt;td&gt;-41.376939&lt;/td&gt;
      &lt;td&gt;-62.321563&lt;/td&gt;
      &lt;td&gt;-38.217479&lt;/td&gt;
      &lt;td&gt;-38.217479&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;IRN&lt;/td&gt;
      &lt;td&gt;Iran (Islamic Republic of)&lt;/td&gt;
      &lt;td&gt;116486.7&lt;/td&gt;
      &lt;td&gt;1.310085e+05&lt;/td&gt;
      &lt;td&gt;8.723360e+04&lt;/td&gt;
      &lt;td&gt;9.393660e+04&lt;/td&gt;
      &lt;td&gt;9.610340e+04&lt;/td&gt;
      &lt;td&gt;2912167.5&lt;/td&gt;
      &lt;td&gt;3.275212e+06&lt;/td&gt;
      &lt;td&gt;2.180840e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;1.152675&lt;/td&gt;
      &lt;td&gt;13.260902&lt;/td&gt;
      &lt;td&gt;13.260902&lt;/td&gt;
      &lt;td&gt;24.674600&lt;/td&gt;
      &lt;td&gt;29.927285&lt;/td&gt;
      &lt;td&gt;-10.281098&lt;/td&gt;
      &lt;td&gt;5.513463&lt;/td&gt;
      &lt;td&gt;1.146070&lt;/td&gt;
      &lt;td&gt;12.436318&lt;/td&gt;
      &lt;td&gt;12.436318&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;ITA&lt;/td&gt;
      &lt;td&gt;Italy&lt;/td&gt;
      &lt;td&gt;114574.8&lt;/td&gt;
      &lt;td&gt;1.180030e+05&lt;/td&gt;
      &lt;td&gt;1.180030e+05&lt;/td&gt;
      &lt;td&gt;1.094638e+05&lt;/td&gt;
      &lt;td&gt;1.108951e+05&lt;/td&gt;
      &lt;td&gt;2864370.0&lt;/td&gt;
      &lt;td&gt;2.950075e+06&lt;/td&gt;
      &lt;td&gt;2.950075e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;83.321649&lt;/td&gt;
      &lt;td&gt;80.187551&lt;/td&gt;
      &lt;td&gt;80.187551&lt;/td&gt;
      &lt;td&gt;56.395576&lt;/td&gt;
      &lt;td&gt;58.155426&lt;/td&gt;
      &lt;td&gt;53.868303&lt;/td&gt;
      &lt;td&gt;59.165480&lt;/td&gt;
      &lt;td&gt;58.817707&lt;/td&gt;
      &lt;td&gt;57.238482&lt;/td&gt;
      &lt;td&gt;57.238482&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;JPN&lt;/td&gt;
      &lt;td&gt;Japan&lt;/td&gt;
      &lt;td&gt;330353.1&lt;/td&gt;
      &lt;td&gt;3.264030e+05&lt;/td&gt;
      &lt;td&gt;3.237003e+05&lt;/td&gt;
      &lt;td&gt;3.222450e+05&lt;/td&gt;
      &lt;td&gt;3.205818e+05&lt;/td&gt;
      &lt;td&gt;8258827.5&lt;/td&gt;
      &lt;td&gt;8.160075e+06&lt;/td&gt;
      &lt;td&gt;8.092508e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;31.555853&lt;/td&gt;
      &lt;td&gt;36.874729&lt;/td&gt;
      &lt;td&gt;36.874729&lt;/td&gt;
      &lt;td&gt;30.212099&lt;/td&gt;
      &lt;td&gt;30.021068&lt;/td&gt;
      &lt;td&gt;16.313490&lt;/td&gt;
      &lt;td&gt;51.954183&lt;/td&gt;
      &lt;td&gt;27.255501&lt;/td&gt;
      &lt;td&gt;31.134372&lt;/td&gt;
      &lt;td&gt;31.134372&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;KHM&lt;/td&gt;
      &lt;td&gt;Cambodia&lt;/td&gt;
      &lt;td&gt;436826.0&lt;/td&gt;
      &lt;td&gt;4.590031e+05&lt;/td&gt;
      &lt;td&gt;4.737453e+05&lt;/td&gt;
      &lt;td&gt;4.793627e+05&lt;/td&gt;
      &lt;td&gt;4.683789e+05&lt;/td&gt;
      &lt;td&gt;10920650.0&lt;/td&gt;
      &lt;td&gt;1.147508e+07&lt;/td&gt;
      &lt;td&gt;1.184363e+07&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;23.769728&lt;/td&gt;
      &lt;td&gt;14.304565&lt;/td&gt;
      &lt;td&gt;14.304565&lt;/td&gt;
      &lt;td&gt;-13.424988&lt;/td&gt;
      &lt;td&gt;-24.872761&lt;/td&gt;
      &lt;td&gt;4.652461&lt;/td&gt;
      &lt;td&gt;-16.667610&lt;/td&gt;
      &lt;td&gt;-26.975760&lt;/td&gt;
      &lt;td&gt;-15.406481&lt;/td&gt;
      &lt;td&gt;-15.406481&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;KOR&lt;/td&gt;
      &lt;td&gt;Korea (the Republic of)&lt;/td&gt;
      &lt;td&gt;167862.2&lt;/td&gt;
      &lt;td&gt;1.635341e+05&lt;/td&gt;
      &lt;td&gt;1.584897e+05&lt;/td&gt;
      &lt;td&gt;1.549113e+05&lt;/td&gt;
      &lt;td&gt;1.532609e+05&lt;/td&gt;
      &lt;td&gt;4196555.0&lt;/td&gt;
      &lt;td&gt;4.088352e+06&lt;/td&gt;
      &lt;td&gt;3.962243e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;14.321600&lt;/td&gt;
      &lt;td&gt;15.813819&lt;/td&gt;
      &lt;td&gt;15.813819&lt;/td&gt;
      &lt;td&gt;13.507737&lt;/td&gt;
      &lt;td&gt;22.059230&lt;/td&gt;
      &lt;td&gt;7.677136&lt;/td&gt;
      &lt;td&gt;16.497815&lt;/td&gt;
      &lt;td&gt;13.364589&lt;/td&gt;
      &lt;td&gt;14.655057&lt;/td&gt;
      &lt;td&gt;14.655057&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;LAO&lt;/td&gt;
      &lt;td&gt;Lao People&#39;s Democratic Republic (the)&lt;/td&gt;
      &lt;td&gt;94826.8&lt;/td&gt;
      &lt;td&gt;9.563000e+04&lt;/td&gt;
      &lt;td&gt;9.394070e+04&lt;/td&gt;
      &lt;td&gt;8.333360e+04&lt;/td&gt;
      &lt;td&gt;7.700550e+04&lt;/td&gt;
      &lt;td&gt;2370670.0&lt;/td&gt;
      &lt;td&gt;2.390750e+06&lt;/td&gt;
      &lt;td&gt;2.348518e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;136.209544&lt;/td&gt;
      &lt;td&gt;145.627378&lt;/td&gt;
      &lt;td&gt;145.627378&lt;/td&gt;
      &lt;td&gt;82.482067&lt;/td&gt;
      &lt;td&gt;82.260369&lt;/td&gt;
      &lt;td&gt;87.565950&lt;/td&gt;
      &lt;td&gt;87.883944&lt;/td&gt;
      &lt;td&gt;81.026578&lt;/td&gt;
      &lt;td&gt;84.268427&lt;/td&gt;
      &lt;td&gt;84.268427&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;LKA&lt;/td&gt;
      &lt;td&gt;Sri Lanka&lt;/td&gt;
      &lt;td&gt;132640.0&lt;/td&gt;
      &lt;td&gt;1.217563e+05&lt;/td&gt;
      &lt;td&gt;8.445630e+04&lt;/td&gt;
      &lt;td&gt;1.110490e+05&lt;/td&gt;
      &lt;td&gt;1.021563e+05&lt;/td&gt;
      &lt;td&gt;3316000.0&lt;/td&gt;
      &lt;td&gt;3.043908e+06&lt;/td&gt;
      &lt;td&gt;2.111408e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;18.612972&lt;/td&gt;
      &lt;td&gt;27.569003&lt;/td&gt;
      &lt;td&gt;27.569003&lt;/td&gt;
      &lt;td&gt;37.382189&lt;/td&gt;
      &lt;td&gt;16.904226&lt;/td&gt;
      &lt;td&gt;30.001182&lt;/td&gt;
      &lt;td&gt;18.784377&lt;/td&gt;
      &lt;td&gt;17.028241&lt;/td&gt;
      &lt;td&gt;24.229137&lt;/td&gt;
      &lt;td&gt;24.229137&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;MMR&lt;/td&gt;
      &lt;td&gt;Myanmar&lt;/td&gt;
      &lt;td&gt;1059409.6&lt;/td&gt;
      &lt;td&gt;1.052288e+06&lt;/td&gt;
      &lt;td&gt;1.087030e+06&lt;/td&gt;
      &lt;td&gt;1.118850e+06&lt;/td&gt;
      &lt;td&gt;1.083100e+06&lt;/td&gt;
      &lt;td&gt;26485240.0&lt;/td&gt;
      &lt;td&gt;2.630719e+07&lt;/td&gt;
      &lt;td&gt;2.717574e+07&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;14.853751&lt;/td&gt;
      &lt;td&gt;14.697380&lt;/td&gt;
      &lt;td&gt;14.697380&lt;/td&gt;
      &lt;td&gt;-6.859731&lt;/td&gt;
      &lt;td&gt;-22.666619&lt;/td&gt;
      &lt;td&gt;-10.868129&lt;/td&gt;
      &lt;td&gt;-22.665852&lt;/td&gt;
      &lt;td&gt;-16.045425&lt;/td&gt;
      &lt;td&gt;-15.863111&lt;/td&gt;
      &lt;td&gt;-15.863111&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;MYS&lt;/td&gt;
      &lt;td&gt;Malaysia&lt;/td&gt;
      &lt;td&gt;121942.6&lt;/td&gt;
      &lt;td&gt;1.232328e+05&lt;/td&gt;
      &lt;td&gt;1.226563e+05&lt;/td&gt;
      &lt;td&gt;1.252385e+05&lt;/td&gt;
      &lt;td&gt;1.224538e+05&lt;/td&gt;
      &lt;td&gt;3048565.0&lt;/td&gt;
      &lt;td&gt;3.080820e+06&lt;/td&gt;
      &lt;td&gt;3.066408e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;14.753544&lt;/td&gt;
      &lt;td&gt;13.043224&lt;/td&gt;
      &lt;td&gt;13.043224&lt;/td&gt;
      &lt;td&gt;13.287137&lt;/td&gt;
      &lt;td&gt;9.922595&lt;/td&gt;
      &lt;td&gt;9.398001&lt;/td&gt;
      &lt;td&gt;14.840462&lt;/td&gt;
      &lt;td&gt;13.739977&lt;/td&gt;
      &lt;td&gt;12.244674&lt;/td&gt;
      &lt;td&gt;12.244674&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;NPL&lt;/td&gt;
      &lt;td&gt;Nepal&lt;/td&gt;
      &lt;td&gt;149262.2&lt;/td&gt;
      &lt;td&gt;1.427237e+05&lt;/td&gt;
      &lt;td&gt;1.625746e+05&lt;/td&gt;
      &lt;td&gt;1.538908e+05&lt;/td&gt;
      &lt;td&gt;1.562154e+05&lt;/td&gt;
      &lt;td&gt;3731555.0&lt;/td&gt;
      &lt;td&gt;3.568093e+06&lt;/td&gt;
      &lt;td&gt;4.064365e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;29.190154&lt;/td&gt;
      &lt;td&gt;50.437328&lt;/td&gt;
      &lt;td&gt;50.437328&lt;/td&gt;
      &lt;td&gt;32.502761&lt;/td&gt;
      &lt;td&gt;53.286238&lt;/td&gt;
      &lt;td&gt;50.291743&lt;/td&gt;
      &lt;td&gt;40.212459&lt;/td&gt;
      &lt;td&gt;25.472433&lt;/td&gt;
      &lt;td&gt;40.279401&lt;/td&gt;
      &lt;td&gt;40.279401&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;PAK&lt;/td&gt;
      &lt;td&gt;Pakistan&lt;/td&gt;
      &lt;td&gt;383529.3&lt;/td&gt;
      &lt;td&gt;3.813618e+05&lt;/td&gt;
      &lt;td&gt;4.060833e+05&lt;/td&gt;
      &lt;td&gt;3.934042e+05&lt;/td&gt;
      &lt;td&gt;4.247551e+05&lt;/td&gt;
      &lt;td&gt;9588232.5&lt;/td&gt;
      &lt;td&gt;9.534045e+06&lt;/td&gt;
      &lt;td&gt;1.015208e+07&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;42.334367&lt;/td&gt;
      &lt;td&gt;31.154530&lt;/td&gt;
      &lt;td&gt;31.154530&lt;/td&gt;
      &lt;td&gt;-26.520489&lt;/td&gt;
      &lt;td&gt;-55.912882&lt;/td&gt;
      &lt;td&gt;-32.303912&lt;/td&gt;
      &lt;td&gt;-15.207139&lt;/td&gt;
      &lt;td&gt;-53.701452&lt;/td&gt;
      &lt;td&gt;-36.903009&lt;/td&gt;
      &lt;td&gt;-36.903009&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;PHL&lt;/td&gt;
      &lt;td&gt;Philippines (the)&lt;/td&gt;
      &lt;td&gt;1557810.6&lt;/td&gt;
      &lt;td&gt;1.524292e+06&lt;/td&gt;
      &lt;td&gt;1.609862e+06&lt;/td&gt;
      &lt;td&gt;1.606048e+06&lt;/td&gt;
      &lt;td&gt;1.556226e+06&lt;/td&gt;
      &lt;td&gt;38945265.0&lt;/td&gt;
      &lt;td&gt;3.810731e+07&lt;/td&gt;
      &lt;td&gt;4.024656e+07&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;125.114417&lt;/td&gt;
      &lt;td&gt;121.748165&lt;/td&gt;
      &lt;td&gt;121.748165&lt;/td&gt;
      &lt;td&gt;77.968948&lt;/td&gt;
      &lt;td&gt;73.275770&lt;/td&gt;
      &lt;td&gt;76.166725&lt;/td&gt;
      &lt;td&gt;74.003201&lt;/td&gt;
      &lt;td&gt;76.966391&lt;/td&gt;
      &lt;td&gt;75.679166&lt;/td&gt;
      &lt;td&gt;75.679166&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;PRK&lt;/td&gt;
      &lt;td&gt;Korea (the Democratic People&#39;s Republic of)&lt;/td&gt;
      &lt;td&gt;82823.3&lt;/td&gt;
      &lt;td&gt;8.344230e+04&lt;/td&gt;
      &lt;td&gt;8.459620e+04&lt;/td&gt;
      &lt;td&gt;8.394330e+04&lt;/td&gt;
      &lt;td&gt;8.293700e+04&lt;/td&gt;
      &lt;td&gt;2070582.5&lt;/td&gt;
      &lt;td&gt;2.086058e+06&lt;/td&gt;
      &lt;td&gt;2.114905e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;15.169422&lt;/td&gt;
      &lt;td&gt;17.492669&lt;/td&gt;
      &lt;td&gt;17.492669&lt;/td&gt;
      &lt;td&gt;-38.030793&lt;/td&gt;
      &lt;td&gt;-9.988016&lt;/td&gt;
      &lt;td&gt;-28.310326&lt;/td&gt;
      &lt;td&gt;-3.195586&lt;/td&gt;
      &lt;td&gt;-16.414407&lt;/td&gt;
      &lt;td&gt;-19.169278&lt;/td&gt;
      &lt;td&gt;-19.169278&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;THA&lt;/td&gt;
      &lt;td&gt;Thailand&lt;/td&gt;
      &lt;td&gt;1554254.0&lt;/td&gt;
      &lt;td&gt;1.703328e+06&lt;/td&gt;
      &lt;td&gt;1.714466e+06&lt;/td&gt;
      &lt;td&gt;1.702989e+06&lt;/td&gt;
      &lt;td&gt;1.553836e+06&lt;/td&gt;
      &lt;td&gt;38856350.0&lt;/td&gt;
      &lt;td&gt;4.258319e+07&lt;/td&gt;
      &lt;td&gt;4.286164e+07&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;17.404685&lt;/td&gt;
      &lt;td&gt;22.551331&lt;/td&gt;
      &lt;td&gt;22.551331&lt;/td&gt;
      &lt;td&gt;10.323662&lt;/td&gt;
      &lt;td&gt;-4.559627&lt;/td&gt;
      &lt;td&gt;32.066348&lt;/td&gt;
      &lt;td&gt;46.173612&lt;/td&gt;
      &lt;td&gt;16.011325&lt;/td&gt;
      &lt;td&gt;20.266184&lt;/td&gt;
      &lt;td&gt;20.266184&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;20&lt;/th&gt;
      &lt;td&gt;TWN&lt;/td&gt;
      &lt;td&gt;Taiwan (Province of China)&lt;/td&gt;
      &lt;td&gt;45838.7&lt;/td&gt;
      &lt;td&gt;4.983830e+04&lt;/td&gt;
      &lt;td&gt;4.999120e+04&lt;/td&gt;
      &lt;td&gt;4.941410e+04&lt;/td&gt;
      &lt;td&gt;4.915200e+04&lt;/td&gt;
      &lt;td&gt;1145967.5&lt;/td&gt;
      &lt;td&gt;1.245958e+06&lt;/td&gt;
      &lt;td&gt;1.249780e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;58.617135&lt;/td&gt;
      &lt;td&gt;52.458032&lt;/td&gt;
      &lt;td&gt;52.458032&lt;/td&gt;
      &lt;td&gt;-71.622589&lt;/td&gt;
      &lt;td&gt;-62.307893&lt;/td&gt;
      &lt;td&gt;-74.143329&lt;/td&gt;
      &lt;td&gt;-64.692890&lt;/td&gt;
      &lt;td&gt;-82.919716&lt;/td&gt;
      &lt;td&gt;-71.109302&lt;/td&gt;
      &lt;td&gt;-71.109302&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;21&lt;/th&gt;
      &lt;td&gt;USA&lt;/td&gt;
      &lt;td&gt;United States of America (the)&lt;/td&gt;
      &lt;td&gt;364728.0&lt;/td&gt;
      &lt;td&gt;4.386620e+05&lt;/td&gt;
      &lt;td&gt;3.362555e+05&lt;/td&gt;
      &lt;td&gt;4.121775e+05&lt;/td&gt;
      &lt;td&gt;3.501365e+05&lt;/td&gt;
      &lt;td&gt;9118200.0&lt;/td&gt;
      &lt;td&gt;1.096655e+07&lt;/td&gt;
      &lt;td&gt;8.406388e+06&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;69.713577&lt;/td&gt;
      &lt;td&gt;78.850049&lt;/td&gt;
      &lt;td&gt;78.850049&lt;/td&gt;
      &lt;td&gt;55.821215&lt;/td&gt;
      &lt;td&gt;63.101978&lt;/td&gt;
      &lt;td&gt;49.895259&lt;/td&gt;
      &lt;td&gt;59.792699&lt;/td&gt;
      &lt;td&gt;51.694526&lt;/td&gt;
      &lt;td&gt;56.553728&lt;/td&gt;
      &lt;td&gt;56.553728&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22&lt;/th&gt;
      &lt;td&gt;VNM&lt;/td&gt;
      &lt;td&gt;Viet Nam&lt;/td&gt;
      &lt;td&gt;1381744.4&lt;/td&gt;
      &lt;td&gt;1.365174e+06&lt;/td&gt;
      &lt;td&gt;1.360552e+06&lt;/td&gt;
      &lt;td&gt;1.336231e+06&lt;/td&gt;
      &lt;td&gt;1.318431e+06&lt;/td&gt;
      &lt;td&gt;34543610.0&lt;/td&gt;
      &lt;td&gt;3.412934e+07&lt;/td&gt;
      &lt;td&gt;3.401379e+07&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;3.761740&lt;/td&gt;
      &lt;td&gt;0.902428&lt;/td&gt;
      &lt;td&gt;0.902428&lt;/td&gt;
      &lt;td&gt;2.585962&lt;/td&gt;
      &lt;td&gt;-8.687738&lt;/td&gt;
      &lt;td&gt;-3.372544&lt;/td&gt;
      &lt;td&gt;1.405162&lt;/td&gt;
      &lt;td&gt;3.692293&lt;/td&gt;
      &lt;td&gt;-0.906518&lt;/td&gt;
      &lt;td&gt;-0.906518&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;23&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;mean&lt;/td&gt;
      &lt;td&gt;948478.0&lt;/td&gt;
      &lt;td&gt;9.522272e+05&lt;/td&gt;
      &lt;td&gt;9.590840e+05&lt;/td&gt;
      &lt;td&gt;9.575896e+05&lt;/td&gt;
      &lt;td&gt;9.316100e+05&lt;/td&gt;
      &lt;td&gt;23711950.0&lt;/td&gt;
      &lt;td&gt;2.380568e+07&lt;/td&gt;
      &lt;td&gt;2.397710e+07&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;47.621862&lt;/td&gt;
      &lt;td&gt;49.129925&lt;/td&gt;
      &lt;td&gt;49.129925&lt;/td&gt;
      &lt;td&gt;4.551116&lt;/td&gt;
      &lt;td&gt;4.508756&lt;/td&gt;
      &lt;td&gt;3.322003&lt;/td&gt;
      &lt;td&gt;6.179080&lt;/td&gt;
      &lt;td&gt;-1.533721&lt;/td&gt;
      &lt;td&gt;3.599038&lt;/td&gt;
      &lt;td&gt;3.599038&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;24&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;total&lt;/td&gt;
      &lt;td&gt;21814994.0&lt;/td&gt;
      &lt;td&gt;2.190123e+07&lt;/td&gt;
      &lt;td&gt;2.205893e+07&lt;/td&gt;
      &lt;td&gt;2.202456e+07&lt;/td&gt;
      &lt;td&gt;2.142703e+07&lt;/td&gt;
      &lt;td&gt;545374850.0&lt;/td&gt;
      &lt;td&gt;5.475306e+08&lt;/td&gt;
      &lt;td&gt;5.514733e+08&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;1095.302835&lt;/td&gt;
      &lt;td&gt;1129.988279&lt;/td&gt;
      &lt;td&gt;1129.988279&lt;/td&gt;
      &lt;td&gt;104.675658&lt;/td&gt;
      &lt;td&gt;103.701389&lt;/td&gt;
      &lt;td&gt;76.406059&lt;/td&gt;
      &lt;td&gt;142.118831&lt;/td&gt;
      &lt;td&gt;-35.275585&lt;/td&gt;
      &lt;td&gt;82.777881&lt;/td&gt;
      &lt;td&gt;82.777881&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;25 rows  73 columns&lt;/p&gt;
&lt;/div&gt;
&lt;h3 id=&#34;merged-data-to-file&#34; &gt;Merged Data to File
&lt;span&gt;
    &lt;a href=&#34;#merged-data-to-file&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;outfile &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/Users/jnapolitano/Projects/wattime-takehome/wattime-takehome/data/MERGED_DATA.csv&amp;#34;&lt;/span&gt;

merged_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to_csv(outfile)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;co2-difference-plots&#34; &gt;CO2 Difference Plots
&lt;span&gt;
    &lt;a href=&#34;#co2-difference-plots&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;merged_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;plot(kind &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;barh&amp;#34;&lt;/span&gt;, x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_name_FAOSTAT&amp;#39;&lt;/span&gt;, y &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;CO2_diff_2015&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;CO2_diff_2016&amp;#34;&lt;/span&gt;,	&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;CO2_diff_2017&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;CO2_diff_2018&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;CO2_diff_2019&amp;#34;&lt;/span&gt;], xlabel &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Country Name&amp;#34;&lt;/span&gt;, ylabel &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Tonnes CH4&amp;#34;&lt;/span&gt;, figsize &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;AxesSubplot:ylabel=&#39;Country Name&#39;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;data_exploration_files/data_exploration_92_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;percent-difference-plot&#34; &gt;Percent Difference Plot
&lt;span&gt;
    &lt;a href=&#34;#percent-difference-plot&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;merged_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;plot(kind &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;barh&amp;#34;&lt;/span&gt;, x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_name_FAOSTAT&amp;#39;&lt;/span&gt;, y &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;CO2_relative_percent_diff_2015&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;CO2_relative_percent_diff_2016&amp;#34;&lt;/span&gt;,	&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;CO2_relative_percent_diff_2017&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;CO2_relative_percent_diff_2018&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;CO2_relative_percent_diff_2019&amp;#34;&lt;/span&gt;], xlabel &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Country Name&amp;#34;&lt;/span&gt;, ylabel &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Tonnes CH4&amp;#34;&lt;/span&gt;, figsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;AxesSubplot:ylabel=&#39;Country Name&#39;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;data_exploration_files/data_exploration_94_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Conduct Legal Research with AI: Part 1</title>
      <link>https://blog.jnapolitano.io/posts/neo4j_integration/</link>
      <pubDate>Mon, 16 May 2022 14:40:32 +0000</pubDate>
      
      <guid>https://blog.jnapolitano.io/posts/neo4j_integration/</guid>
      <description>&lt;h2 id=&#34;introduction&#34; &gt;Introduction
&lt;span&gt;
    &lt;a href=&#34;#introduction&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;p&gt;In a previous &lt;a href=&#34;https://blog.jnapolitano.io/loc_crawler/&#34;&gt;post&lt;/a&gt;, I detailed the process of crawling the Library of Congress API to generate json files that could be intergrated into you DB of choice.&lt;/p&gt;
&lt;p&gt;In this discussion, we will integrate JSON data into a Neo4j graph database.&lt;/p&gt;
&lt;h2 id=&#34;overview&#34; &gt;Overview
&lt;span&gt;
    &lt;a href=&#34;#overview&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;p&gt;The process is fairly straightforward.  The most difficult part is wrangling your json data into the right format for integration.&lt;/p&gt;
&lt;p&gt;The main function first instantiates the database config informormation.  It then gets the cwd from a context manager.  We then import the files to be integrated.  A master subject table is created to record only unique subjects to avoid duplicates.  Finally, a json pipeline extracts the data from json, transforms it to integrate into neo4j, and finally we upload using the neomodels api.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; __name__ &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;:
    neo_applified &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; instantiate_neo_model_api()
    cwd &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; get_cwd()
    file_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; get_files(cwd &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cwd)
    master_subject_table &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; create_master_subject_table()
    json_pipeline(file_list&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;file_list, master_subject_table&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;master_subject_table)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;instantiate-neo-model-api&#34; &gt;Instantiate Neo Model Api
&lt;span&gt;
    &lt;a href=&#34;#instantiate-neo-model-api&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;p&gt;I extended the neo model api with a few helper functions.  The repo is found at &lt;a href=&#34;https://github.com/justin-napolitano/neo4jAPI&#34;&gt;https://github.com/justin-napolitano/neo4jAPI&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;You can also review the snapshot below.&lt;/p&gt;
&lt;p&gt;We will be calling the initation function to set the config information, update, create Case, and Create Subject classes during this review.&lt;/p&gt;
&lt;p&gt;create subject calls the custom subject class and returns an object that can later be integrated into the db with the .save() function.&lt;/p&gt;
&lt;p&gt;Create case does exactly the same.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; dataclasses &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; dataclass
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; datetime &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; date
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; shelve &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; Shelf
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; neomodel &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; (config, StructuredNode, StringProperty, IntegerProperty,
    UniqueIdProperty, RelationshipTo, BooleanProperty, EmailProperty, Relationship, db)
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; pprint &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; pprint

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;neoAPI&lt;/span&gt;():

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __init__(self,uri,user,psw):
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;db_init &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;instantiate_neo_model_session(uri,user,psw)    
        
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;instantiate_neo_model_session&lt;/span&gt;(uri,user,psw):
        
        &lt;span style=&#34;color:#75715e&#34;&gt;#config.DATABASE_URL = &amp;#39;neo4j+s://{}:{}@{}&amp;#39;.format(user, psw, uri)&lt;/span&gt;
        config&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DATABASE_URL &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;bolt://neo4j:beautiful@localhost:7687&amp;#39;&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#config.DATABASE_URL = uri&lt;/span&gt;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;


    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;standard_query&lt;/span&gt;():
        results, meta &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; db&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cypher_query(query, params)
        people &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [Person&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;inflate(row[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]) &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; row &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; results]

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_case_node&lt;/span&gt;(date, dates, group,name, pdf, shelf_id, subject, title, url, subject_relationship &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Case(date&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;date, dates&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;dates, group&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;group,name&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;name, pdf&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pdf, shelf_id&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;shelf_id, subject&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;subject, title&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;title, url&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;url)


    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_city_node&lt;/span&gt;(name):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; City(name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; name)
        
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_country_node&lt;/span&gt;(code,name):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Country(code &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; code, name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; name)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_state_node&lt;/span&gt;(code,name):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; State(code &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; code, name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; name)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_realtor_search_url_node&lt;/span&gt;(url):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Realtor_Search_URL(url &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; url, is_root &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, is_sibling &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, is_parent&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;, is_child &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;, searched &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;)
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_root_node&lt;/span&gt;(url, name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;realtor.com&amp;#39;&lt;/span&gt;):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Root(is_root &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;,name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; name,is_parent &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;, is_sibling &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;, is_child &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;, url &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; url)
        uid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; UniqueIdProperty()

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_child_node&lt;/span&gt;(url, name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;realtor.com&amp;#39;&lt;/span&gt;):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Child(is_root &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;,name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; name,is_parent &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;, is_sibling &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;, is_child &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;, url &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; url)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_parent_node&lt;/span&gt;(url, name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;realtor.com&amp;#39;&lt;/span&gt;):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Parent(is_root &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;,name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; name,is_parent &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;, is_sibling &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;, is_child &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;, url &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; url)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_sibling_node&lt;/span&gt;(url, name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;realtor.com&amp;#39;&lt;/span&gt;):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Sibling(is_root &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;,name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; name,is_parent &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;, is_sibling &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;, is_child &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;, url &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; url)
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_relationship&lt;/span&gt;(source,target):
      
        
        rel &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; source&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;connect(target)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; rel

        &lt;span style=&#34;color:#75715e&#34;&gt;#print(&amp;#34;{}&amp;#34;+&amp;#34;.connect&amp;#34; + &amp;#34;{}&amp;#34;.format(source,target))&lt;/span&gt;
        
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_subject_node&lt;/span&gt;(name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;,):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Subject(name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; name)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;update&lt;/span&gt;(obj):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;with&lt;/span&gt; db&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;transaction:
            &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; obj&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;save()

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Subject&lt;/span&gt;(StructuredNode):
    uuid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; UniqueIdProperty()
    name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)


&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Case&lt;/span&gt;(StructuredNode):
    uid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; UniqueIdProperty()
    date &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    dates &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    group &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    pdf &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;) 
    shelf_id &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    subject &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    &lt;span style=&#34;color:#75715e&#34;&gt;#primary_topic = StringProperty(unique_index=True, required=True)&lt;/span&gt;
    title &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    url &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    subject_relationship &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Subject&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_SUBJECT&amp;#34;&lt;/span&gt;)

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Processed&lt;/span&gt;(StructuredNode):
    uid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; UniqueIdProperty()

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;NotProcessed&lt;/span&gt;(StructuredNode):
    uid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; UniqueIdProperty()
    

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;City&lt;/span&gt;(StructuredNode):
    uid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; UniqueIdProperty()
    name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    state &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;State&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;IS_STATE_OF&amp;#39;&lt;/span&gt;)
    country &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Country&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;IS_COUNTRY_OF&amp;#39;&lt;/span&gt;)
    
    
&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Country&lt;/span&gt;(StructuredNode):
    uid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; UniqueIdProperty()
    code &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;(StructuredNode):
    uid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; UniqueIdProperty()
    code &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    country &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Country&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;IS_COUNTRY_OF&amp;#39;&lt;/span&gt;)

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Root&lt;/span&gt;(StructuredNode):
    uid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; UniqueIdProperty()
    is_root &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    is_parent &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    is_sibling &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    is_child &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;)
    url &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty()
    processed &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Processed&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_PROCESSED&amp;#34;&lt;/span&gt;)
    NotProcessed &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;NotProcessed&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;NOT_PROCESSED&amp;#34;&lt;/span&gt;)
    sibling &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Sibling&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_SIBLING&amp;#34;&lt;/span&gt;)
    child &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Child&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_CHILD&amp;#34;&lt;/span&gt;)
    parent &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Parent&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_PARENT&amp;#34;&lt;/span&gt;)
    root &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Root&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_ROOT&amp;#34;&lt;/span&gt;)

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Child&lt;/span&gt;(StructuredNode):
    uid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; UniqueIdProperty()
    is_root &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    is_parent &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    is_sibling &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    is_child &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty()
    processed &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Processed&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_PROCESSED&amp;#34;&lt;/span&gt;)
    NotProcessed &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;NotProcessed&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;NOT_PROCESSED&amp;#34;&lt;/span&gt;)
    sibling &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Sibling&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_SIBLING&amp;#34;&lt;/span&gt;)
    child &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Child&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_CHILD&amp;#34;&lt;/span&gt;)
    parent &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Parent&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_PARENT&amp;#34;&lt;/span&gt;)
    root &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Root&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_ROOT&amp;#34;&lt;/span&gt;)

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Parent&lt;/span&gt;(StructuredNode):
    uid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; UniqueIdProperty()
    name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty()
    is_root &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    is_parent &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    is_sibling &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    is_child &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    processed &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Processed&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_PROCESSED&amp;#34;&lt;/span&gt;)
    NotProcessed &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;NotProcessed&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;NOT_PROCESSED&amp;#34;&lt;/span&gt;)
    sibling &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Sibling&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_SIBLING&amp;#34;&lt;/span&gt;)
    child &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Child&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_CHILD&amp;#34;&lt;/span&gt;)
    parent &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Parent&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_PARENT&amp;#34;&lt;/span&gt;)
    root &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Root&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_ROOT&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Sibling&lt;/span&gt;(StructuredNode):
    uid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; UniqueIdProperty()
    is_root &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    is_parent &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    is_sibling &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    is_child &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty()
    processed &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Processed&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_PROCESSED&amp;#34;&lt;/span&gt;)
    NotProcessed &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;NotProcessed&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;NOT_PROCESSED&amp;#34;&lt;/span&gt;)
    sibling &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Sibling&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_SIBLING&amp;#34;&lt;/span&gt;)
    child &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Child&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_CHILD&amp;#34;&lt;/span&gt;)
    parent &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Parent&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_PARENT&amp;#34;&lt;/span&gt;)
    root &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Root&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_ROOT&amp;#34;&lt;/span&gt;)
    
&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Realtor_com&lt;/span&gt;(StructuredNode):
    uid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; UniqueIdProperty()
    is_realtor_com &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty()

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Realtor_Search_URL&lt;/span&gt;(StructuredNode):
    uid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; UniqueIdProperty()
    url &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    searched &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    is_root &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    is_child &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    is_parent &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    is_sibling &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; BooleanProperty(unique_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    &lt;span style=&#34;color:#75715e&#34;&gt;#state = Relationship(&amp;#39;State&amp;#39;, &amp;#39;OF&amp;#39;)&lt;/span&gt;
    state &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;State&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;IS_STATE_OF&amp;#39;&lt;/span&gt;)
    city &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;City&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;IS_CITY_OF&amp;#39;&lt;/span&gt;)
    root &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Root&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;IS_ROOT&amp;#39;&lt;/span&gt;)
    child &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Child&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_CHILD&amp;#34;&lt;/span&gt;)
    parent &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Parent&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_PARENT&amp;#34;&lt;/span&gt;)
    sibling &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Sibling&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_SIBLING&amp;#34;&lt;/span&gt;)
    realtor_com &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Realtor_com&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_REALTOR.COM_URL&amp;#34;&lt;/span&gt;)
    processed &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Processed&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_PROCESSED&amp;#34;&lt;/span&gt;)
    NotProcessed &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;NotProcessed&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;NOT_PROCESSED&amp;#34;&lt;/span&gt;)


&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Person&lt;/span&gt;(StructuredNode):
    uid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; UniqueIdProperty()
    full_name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(required &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    email &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; EmailProperty()
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;get-files&#34; &gt;Get Files
&lt;span&gt;
    &lt;a href=&#34;#get-files&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;p&gt;The get_files function returns a list of files within the input directory.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;get_files&lt;/span&gt;(cwd &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;getcwd(), input_directory &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;input&amp;#39;&lt;/span&gt;):
    
    path &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sep&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;join([cwd,input_directory])
    file_list&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [f &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; f &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; glob&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;glob(path &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;**/*.json&amp;#34;&lt;/span&gt;, recursive&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)]
  
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; file_list

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;create-master-subject-file&#34; &gt;Create Master Subject File
&lt;span&gt;
    &lt;a href=&#34;#create-master-subject-file&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;p&gt;Create maseter subject table generates an empty dataframe that will record every unique subject experienced in the data.&lt;/p&gt;
&lt;p&gt;I will improve upon this later, by uploading a master file that will be saved following each modification.  This would enable resuming the process following an error or fault.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_master_subject_table&lt;/span&gt;():
    table &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataFrame()
    table[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;subject&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;nan
    table[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;transaction&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;nan
    table[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;submitted&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;nan
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt;(table)

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;json-pipeline-function&#34; &gt;Json Pipeline function
&lt;span&gt;
    &lt;a href=&#34;#json-pipeline-function&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;p&gt;The json pipeline function is the runner for the etl job.  It loads each file into dataframe, manipulates the data accordingly, and updates the neo4j database.&lt;/p&gt;
&lt;p&gt;When I refactor the code, I will most likely create an object that calls static functions to generate then desired output.&lt;/p&gt;
&lt;p&gt;I may also seperate the case, subject, and relationship pipeline into seperate classes in order to avoid shadowing functions within functions.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;json_pipeline&lt;/span&gt;(file_list, master_subject_table):
    case_counter &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; file &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; file_list:
        
        data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; load_json_data(file&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;file)
        data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;results&amp;#39;&lt;/span&gt;]
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(data)&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(data[0])&lt;/span&gt;
        
        &lt;span style=&#34;color:#75715e&#34;&gt;#filtered_data = filter_json_data(json_data = data, filter = filter)&lt;/span&gt;

        &lt;span style=&#34;color:#75715e&#34;&gt;# Creating the case nodes transaction nodes and df&lt;/span&gt;
        data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; clean_json_data(data)
        case_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; stringify_json_values(data)
        case_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pandify_case_data(case_data)
        case_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nodify_case_data(case_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; case_data)
        
        &lt;span style=&#34;color:#75715e&#34;&gt;# Creating the subject nodes transaction nodes and df&lt;/span&gt;
        subject_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; slice_subject_data(data)
        subject_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; identify_unique_subjects(subject_list)
        subject_lookup_table &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; create_subject_lookup_table(subject_list)
        master_subject_table &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; integrate_to_master_table(subject_lookup_table,master_subject_table)
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(master_subject_table.duplicated())&lt;/span&gt;
        case_counter &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; case_counter &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; len(case_data)

        master_subject_table &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nodify_subjects(master_subject_table)

        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(case_data)&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(master_subject_table[&amp;#39;transaction&amp;#39;])&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#lets save data to the database&lt;/span&gt;

        master_subject_table &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; submit_subjects_to_db(master_subject_table)
        case_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; submit_cases_to_db(case_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; case_data)

        &lt;span style=&#34;color:#75715e&#34;&gt;# Create Relationships&lt;/span&gt;

        relationship_list&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; create_relationship_table(case_data&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;case_data, master_subject_table&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;master_subject_table)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;case-pipeline&#34; &gt;Case Pipeline
&lt;span&gt;
    &lt;a href=&#34;#case-pipeline&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Creating the case nodes transaction nodes and df&lt;/span&gt;
data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; clean_json_data(data)
case_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; stringify_json_values(data)
case_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pandify_case_data(case_data)
case_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nodify_case_data(case_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; case_data)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;To create the case nodes four functions are called.&lt;/p&gt;
&lt;h4 id=&#34;clean-json-data&#34; &gt;Clean Json Data
&lt;span&gt;
    &lt;a href=&#34;#clean-json-data&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;p&gt;The first is clean_json_data which is actually unnecessary.  The only operation that is required is moving the pdf froma list to a dicktionary key.  It should and will be refactored.  As it stands now, I am leaving iut as an artifact of a previous workflow.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;clean_json_data&lt;/span&gt;(filtered_data):
    &lt;span style=&#34;color:#75715e&#34;&gt;# Select the keys that I want from the dictionary&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# filter appropriatly into a df &lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# write df to file&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#print(type(filtered_data))&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(filtered_data)&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; data &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; filtered_data:
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(data)&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#creat a dictionary of columns and values for each row.  Combine them all into a df when we are done&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;# each dictionary must be a row.... which makes perfect sense, but they can not be nested... &lt;/span&gt;
        item &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;item&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        resources &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;resources&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;index&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        language &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;language&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        online_format&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;online_format&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        original_format &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;original_format&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        kind &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;type&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        image_url &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;image_url&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        hassegments &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;hassegments&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        extract_timestamp &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;extract_timestamp&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        timestampe &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;timestamp&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        mimetype&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mime_type&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt;:
            pdf &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; resources[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;pdf&amp;#39;&lt;/span&gt;]
        &lt;span style=&#34;color:#66d9ef&#34;&gt;except&lt;/span&gt;: 
            pdf &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;noPdf&amp;#34;&lt;/span&gt;
        data[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;pdf&amp;#34;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pdf
        data[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;search_index&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; index
    
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;stringify-json-data&#34; &gt;Stringify Json Data
&lt;span&gt;
    &lt;a href=&#34;#stringify-json-data&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;p&gt;The Second is Stringify_json_data.  The imporatance of this function is that it creates strings from lists in order to properly integrate into the neo4j databse.  Iterables are permitted, however they can not be searched.  For my use case, I decided to create csv strings instead that can later be parsed if necessary.&lt;/p&gt;
&lt;p&gt;This function also moves the subject list to a dedicated key in the dictionary.  This is important because it is used to generate the subject tables.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;stringify_json_values&lt;/span&gt;(data):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; dict &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; data:
        subject_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; dict[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;subject&amp;#39;&lt;/span&gt;]
        &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; key &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; dict:
            &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; type(dict[key]) &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; list:
                tmp_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; []
                &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; item &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; (dict[key]):
                    item &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; item&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;replace(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;-&amp;#34;&lt;/span&gt;)
                    tmp_list&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(item)
                dict[key] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tmp_list

                dict[key] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;,&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;join(dict[key])
        dict[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;subject_list&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; subject_list

                
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; data
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;pandify-case-data&#34; &gt;Pandify Case Data
&lt;span&gt;
    &lt;a href=&#34;#pandify-case-data&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;p&gt;The next function creates a pandas dataframe from a list of dictionaries.  Thankfully this is easy to accommplish.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;pandify_case_data&lt;/span&gt;(data):
    &lt;span style=&#34;color:#75715e&#34;&gt;#case_df = pd.concat(data, sort=False)&lt;/span&gt;
    df&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataFrame(data)
    df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;submitted&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;nan
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; df
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;nodify-case-data&#34; &gt;Nodify Case Data
&lt;span&gt;
    &lt;a href=&#34;#nodify-case-data&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;p&gt;Nodify creates transaction objects that can be saved to the neo4j databse.  I call the neomodel api to generate the results and save them into a dataframe that is used to apply the upload with a lambda function.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;nodify_case_data&lt;/span&gt;(case_data):
    &lt;span style=&#34;color:#75715e&#34;&gt;#non_submitted_nodes = case_data[case_data.notna()]&lt;/span&gt;
    non_submitted_nodes &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; case_data[case_data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;notna()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;any(axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)]
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(non_submitted_nodes)&lt;/span&gt;
    case_nodes &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; non_submitted_nodes&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x :neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_case_node(date &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;date&amp;#39;&lt;/span&gt;], dates&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;dates&amp;#39;&lt;/span&gt;],group &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;group&amp;#39;&lt;/span&gt;], name&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;x[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;id&amp;#39;&lt;/span&gt;], pdf&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;pdf&amp;#39;&lt;/span&gt;], shelf_id &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;shelf_id&amp;#39;&lt;/span&gt;], subject&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;subject&amp;#39;&lt;/span&gt;], title &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;title&amp;#39;&lt;/span&gt;], url &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;url&amp;#39;&lt;/span&gt;], subject_relationship&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;), axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)

    case_data[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;transaction&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; case_nodes
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; case_data

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;the-subject-pipeline&#34; &gt;The Subject Pipeline
&lt;span&gt;
    &lt;a href=&#34;#the-subject-pipeline&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;p&gt;The subject pipeline slices the subject data from the current search result page.&lt;/p&gt;
&lt;p&gt;It then identifies the unique subjects&lt;/p&gt;
&lt;p&gt;The subject_lookup_table is a dataframe containing the subjects returned by subject list.  They are unique only to the result page.&lt;/p&gt;
&lt;p&gt;The master_subject_table is then updated by the integrate_to_master_table function that identifes new subjects to integrate into the master table.&lt;/p&gt;
&lt;p&gt;finally, the nodify subject function creates transaction objects to be uploaded to the neo4j db.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;# Creating the subject nodes transaction nodes and df&lt;/span&gt;
    subject_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; slice_subject_data(data)
    subject_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; identify_unique_subjects(subject_list)
    subject_lookup_table &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; create_subject_lookup_table(subject_list)
    master_subject_table &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; integrate_to_master_table(subject_lookup_table,master_subject_table)
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(master_subject_table.duplicated())&lt;/span&gt;

    master_subject_table &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nodify_subjects(master_subject_table)
    
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;slice_subject_data&#34; &gt;slice_subject_data
&lt;span&gt;
    &lt;a href=&#34;#slice_subject_data&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;slice_subject_data&lt;/span&gt;(data):
    subject_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; []
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; case &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; data:
        subject_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; subject_list &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; case[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;subject_list&amp;#39;&lt;/span&gt;]
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(subject_list)&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; subject_list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;identify-unique-subjects&#34; &gt;Identify Unique Subjects
&lt;span&gt;
    &lt;a href=&#34;#identify-unique-subjects&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;identify_unique_subjects&lt;/span&gt;(subject_list):
    
    &lt;span style=&#34;color:#75715e&#34;&gt;# insert the list to the set&lt;/span&gt;
    list_set &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; set(subject_list)
    &lt;span style=&#34;color:#75715e&#34;&gt;# convert the set to the list&lt;/span&gt;
    unique_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (list(list_set))
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; unique_list

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;create-subject-lookup-table&#34; &gt;Create Subject Lookup Table
&lt;span&gt;
    &lt;a href=&#34;#create-subject-lookup-table&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_subject_lookup_table&lt;/span&gt;(subject_list):
    lookup_table &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataFrame(subject_list, columns&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;subject&amp;#39;&lt;/span&gt;])
    lookup_table[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;transaction&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;nan
    lookup_table[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;submitted&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;nan
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; lookup_table
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;nodify-subject&#34; &gt;Nodify Subject
&lt;span&gt;
    &lt;a href=&#34;#nodify-subject&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;nodify_subjects&lt;/span&gt;(master_subject_table):
    non_submitted_nodes &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; master_subject_table[master_subject_table&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;isna()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;any(axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;copy()
    &lt;span style=&#34;color:#75715e&#34;&gt;#df[df.isna().any(axis=1)]&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(non_submitted_nodes)&lt;/span&gt;
    non_submitted_nodes[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;transaction&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; non_submitted_nodes[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;subject&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x :neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_subject_node(name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x))
    master_subject_table&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;update(non_submitted_nodes)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; master_subject_table
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;uploading-case-and-subject-data&#34; &gt;Uploading Case and Subject data
&lt;span&gt;
    &lt;a href=&#34;#uploading-case-and-subject-data&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;p&gt;With the transaction object dataframes created, we can then update the data to the database.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;master_subject_table &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; submit_subjects_to_db(master_subject_table)
case_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; submit_cases_to_db(case_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; case_data)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;submit-subjects&#34; &gt;Submit Subjects
&lt;span&gt;
    &lt;a href=&#34;#submit-subjects&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;p&gt;This function selects the subject nodes from the master table that have not been uploaded to the neo4j database.&lt;/p&gt;
&lt;p&gt;It identifies na in the submitted collumn in order to slice non-submitted nodes.&lt;/p&gt;
&lt;p&gt;If that table can be created we upload all of the df with the update function from the neoapi.  It simply calls the db and calls save() on the object.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;submit_subjects_to_db&lt;/span&gt;(master_subject_table):
    &lt;span style=&#34;color:#75715e&#34;&gt;#unsubmitted = master_subject_table[master_subject_table.notna()]&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(master_subject_table)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#non_submitted_nodes=master_subject_table[[master_subject_table[&amp;#39;submitted&amp;#39;] == np.nan]]&lt;/span&gt;
    non_submitted_nodes &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; master_subject_table[master_subject_table[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;submitted&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;isna()]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;copy()
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(non_submitted_nodes)&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; non_submitted_nodes&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;empty:   
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; master_subject_table
    &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;:
         &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(non_submitted_nodes)&lt;/span&gt;
        non_submitted_nodes[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;transaction&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; non_submitted_nodes[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;transaction&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x: neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;update(x))
        non_submitted_nodes[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;submitted&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;
    
    &lt;span style=&#34;color:#75715e&#34;&gt;#test = non_submitted_nodes.iloc[32][&amp;#39;transaction&amp;#39;]&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#return_obj = neo.neoAPI.update(test)&lt;/span&gt;
        master_subject_table&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;update(non_submitted_nodes)
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(master_subject_table)&lt;/span&gt;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; master_subject_table
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;submit-cases&#34; &gt;Submit Cases
&lt;span&gt;
    &lt;a href=&#34;#submit-cases&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;p&gt;Initially i had copy and pasted the subject submission function. I realized that the checks were unnecessary.   I am assuming that each result is unique.  Therefore, every case is uploaded.  If it proves that there are duplicates in the database, the neo4j cypher language would permit me to prune those duplicate edges.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;submit_cases_to_db&lt;/span&gt;(case_data):
        &lt;span style=&#34;color:#75715e&#34;&gt;#unsubmitted = master_subject_table[master_subject_table.notna()]&lt;/span&gt;

        &lt;span style=&#34;color:#75715e&#34;&gt;### in theory none of the cases wouldhave been submitted becasue i am pulling them from file.  There is no need to check.. Just submit&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#non_submitted_nodes = case_data[case_data[&amp;#39;submitted&amp;#39;].isna()].copy()&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(non_submitted_nodes)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;##pprint(non_submitted_nodes)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#if non_submitted_nodes.empty:&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#    return case_data&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#else:&lt;/span&gt;
    case_data[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;transaction&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; case_data[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;transaction&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x: neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;update(x))
    &lt;span style=&#34;color:#75715e&#34;&gt;#Assume all are submitted..&lt;/span&gt;
    case_data[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;submitted&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#test = non_submitted_nodes.iloc[32][&amp;#39;transaction&amp;#39;]&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#return_obj = neo.neoAPI.update(test)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#case_data.update(non_submitted_nodes)&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; case_data
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;submit-the-relationships&#34; &gt;Submit the Relationships
&lt;span&gt;
    &lt;a href=&#34;#submit-the-relationships&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;&lt;p&gt;The final step is to relate the cases to the subject nodes.&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;relationship_list= create_relationship_table(case_data=case_data, master_subject_table=master_subject_table)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This is accomplished by calling the relationship function declared in the Case class declared in the neomodel api.&lt;/p&gt;
&lt;p&gt;View the reference below:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Case&lt;/span&gt;(StructuredNode):
    uid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; UniqueIdProperty()
    date &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    dates &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    group &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    pdf &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;) 
    shelf_id &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    subject &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    &lt;span style=&#34;color:#75715e&#34;&gt;#primary_topic = StringProperty(unique_index=True, required=True)&lt;/span&gt;
    title &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    url &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; StringProperty(unique_index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, required&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    subject_relationship &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Relationship(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Subject&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;IS_SUBJECT&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;create-relationship-table&#34; &gt;Create Relationship Table
&lt;span&gt;
    &lt;a href=&#34;#create-relationship-table&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;&lt;p&gt;To create the relationships the case_data and the master_subject_table are necessary.&lt;/p&gt;
&lt;p&gt;for every case a relationship is created to every subject within its subject list.&lt;/p&gt;
&lt;p&gt;It is important to note, that in order for this function to work correctly, the cases and subjects must first be submitted to the database.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_relationship_table&lt;/span&gt;(case_data, master_subject_table):
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(case_data[])&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#test = master_subject_table[&amp;#39;subject&amp;#39;]&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;# select &lt;/span&gt;
    relationship_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; []
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; row &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(len(case_data)):
        unique_dataframe &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (master_subject_table[master_subject_table[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;subject&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;isin(case_data[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;subject_list&amp;#39;&lt;/span&gt;][row])])
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(unique_dataframe)&lt;/span&gt;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; subject_row &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(len(unique_dataframe)):
            case &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; case_data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[row][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;transaction&amp;#39;&lt;/span&gt;]
            subject &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; unique_dataframe&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[subject_row][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;transaction&amp;#39;&lt;/span&gt;]
            &lt;span style=&#34;color:#75715e&#34;&gt;#create relationship&lt;/span&gt;
            &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(case)&lt;/span&gt;
            &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(subject)&lt;/span&gt;
            relationship &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_relationship(case&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;subject_relationship,subject)
            &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(relationship)&lt;/span&gt;
            relationship_list&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(relationship)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; relationship_list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;putting-everything-together&#34; &gt;Putting Everything Together
&lt;span&gt;
    &lt;a href=&#34;#putting-everything-together&#34;&gt;
        &lt;svg viewBox=&#34;0 0 28 23&#34; height=&#34;100%&#34; width=&#34;19&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34;&gt;&lt;path d=&#34;M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;path d=&#34;M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71&#34; fill=&#34;none&#34; stroke-linecap=&#34;round&#34; stroke-miterlimit=&#34;10&#34; stroke-width=&#34;2&#34;/&gt;&lt;/svg&gt;
    &lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#realtor_graph.py&lt;/span&gt;


&lt;span style=&#34;color:#75715e&#34;&gt;#from neo4j_connect_2 import NeoSandboxApp&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#import neo4j_connect_2 as neo&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#import GoogleServices as google&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#from pyspark.sql import SparkSession&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#from pyspark.sql.functions import struct&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; cgitb &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; lookup
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; code
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; dbm &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; dumb
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; doctest &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; master
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; hmac &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; trans_36
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; mimetypes
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; platform &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; node
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; pprint &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; pprint
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; pty &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; master_open
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; re &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; sub
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; unittest.util &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; unorderable_list_difference
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; urllib.parse &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; non_hierarchical
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; neomodel &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; (config, StructuredNode, StringProperty, IntegerProperty,
    UniqueIdProperty, RelationshipTo, BooleanProperty, EmailProperty, Relationship,db)
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; pandas &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; pd
&lt;span style=&#34;color:#75715e&#34;&gt;#import NeoNodes as nn&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#import GoogleServices&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; neo4jClasses
&lt;span style=&#34;color:#75715e&#34;&gt;#import sparkAPI as spark&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; neoModelAPI &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; neo
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; glob
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; os
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; json
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; numpy &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; np
&lt;span style=&#34;color:#75715e&#34;&gt;#from neoModelAPI import NeoNodes as nn&lt;/span&gt;


&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;DataUploadFunctions&lt;/span&gt;():
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;upload_df&lt;/span&gt;(self,df):
        &lt;span style=&#34;color:#75715e&#34;&gt;#df.apply(lambda x: pprint(str(x) + str(type(x))))&lt;/span&gt;
        
        node_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;  df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x: neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;update(x))
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(node_list)&lt;/span&gt;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt;  node_list
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;map_to_df&lt;/span&gt;(self,df1,df2,lookup_value :str, lookup_key: str):
        df1[lookup_value] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; df1[lookup_key]
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(df1.columns)&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(df1)&lt;/span&gt;
        
        val  &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; df1[lookup_value]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;replace(dict(zip(df2[lookup_key],  df2[lookup_value])))
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; val

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;set_relationships&lt;/span&gt;(self,source_node, target_node):
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(self.df.columns)&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(source_node)&lt;/span&gt;
        rel &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_relationship(source &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; source_node ,target &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; target_node)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; rel

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;DataPipelineFunctions&lt;/span&gt;():
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;write_df_to_csv&lt;/span&gt;(self,df,path: str):
        cwd &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;getcwd()
        path &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sep&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;join([cwd,path])

        &lt;span style=&#34;color:#66d9ef&#34;&gt;with&lt;/span&gt; open(path,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;w&amp;#39;&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; f:
            df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to_csv(path, index&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;)

        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; path

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_city_nodes&lt;/span&gt;(self,df):
        city_nodes &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;city_name&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x :neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_city_node(name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x))
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; city_nodes

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_url_nodes&lt;/span&gt;(self,df):
        url_nodes &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;root_realtor_url&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x :neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_realtor_search_url_node(url&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x))
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; url_nodes
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_root_nodes&lt;/span&gt;(self,df):
        root_nodes &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;root_realtor_url&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x :neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_root_node(url&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x))
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; root_nodes

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_country_nodes&lt;/span&gt;(self,df):
        country_nodes &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x :neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_country_node(code &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;country_code, name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;country_name),axis &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; country_nodes
        

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;return_unique_country_df&lt;/span&gt;(self,df):
        df &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;drop_duplicates(subset&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_name&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;copy()
        df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;drop(df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;columns&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;difference([&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_node&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;state_node&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_name&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_code&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;state_name&amp;#39;&lt;/span&gt;]), &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, inplace&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(df)&lt;/span&gt;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; df


    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_state_nodes&lt;/span&gt;(self,df):
        state_nodes &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x :neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_state_node(code &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;state_code, name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;state_name),axis &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; state_nodes    

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;return_unique_state_df&lt;/span&gt;(self,df):
        df &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;drop_duplicates(subset&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;state_name&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;copy()
        df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;drop(df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;columns&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;difference([&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;state_node&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_node&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_code&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;state_name&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_name&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;state_code&amp;#39;&lt;/span&gt;]), &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, inplace&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(df)&lt;/span&gt;

        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; df

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;rename_columns&lt;/span&gt;(self,df, mapper &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;city&amp;#39;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;city_name&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;state&amp;#39;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;state_code&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;realtor_url&amp;#39;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;root_realtor_url&amp;#39;&lt;/span&gt;}):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;rename(columns &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; mapper)


    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;add_country_code&lt;/span&gt;(self,country_code &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;USA&amp;#34;&lt;/span&gt;):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; country_code

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;add_country_name&lt;/span&gt;(self,country_name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;United States of America&amp;#34;&lt;/span&gt;):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; country_name

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;upload_df&lt;/span&gt;(self,df):
        &lt;span style=&#34;color:#75715e&#34;&gt;#df.apply(lambda x: pprint(str(x) + str(type(x))))&lt;/span&gt;
        
        node_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;  df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x: neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;update(x))
        pprint(node_list)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt;  node_list
        &lt;span style=&#34;color:#75715e&#34;&gt;#df[&amp;#39;server_node&amp;#39;] =  node_list&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(df)&lt;/span&gt;
        
        


    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;set_url_relationships&lt;/span&gt;(self):
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(self.df.columns)&lt;/span&gt;
        update_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x: neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_relationship(source &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;url_node&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;city,target &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;city_node), axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
        pprint(update_list)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; update_list
        &lt;span style=&#34;color:#75715e&#34;&gt;#rel = self.df.url.connect(self.df.city)&lt;/span&gt;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;set_city_relationships&lt;/span&gt;(self):
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(self.df.columns)&lt;/span&gt;
        update_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x: neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_relationship(source &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;city_node&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;country,target &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;country_node), axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
        update_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x: neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_relationship(source &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;city_node&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;state,target &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;state_node), axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
        pprint(update_list)
        &lt;span style=&#34;color:#75715e&#34;&gt;#rel = self.df.url.connect(self.df.city)&lt;/span&gt;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;set_state_relationships&lt;/span&gt;(self):
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(self.df.columns)&lt;/span&gt;
        neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_relationship(source &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;unique_state_nodes&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;state_node[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;country,target &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;unique_state_nodes&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;country_node[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;])
        &lt;span style=&#34;color:#75715e&#34;&gt;#update_list = self.unique_state_nodes.apply(lambda x: neo.neoAPI.create_relationship(source = x.state_node.country,target = x.country_node.name), axis=1)&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(update_list)&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#rel = self.df.url.connect(self.df.city)&lt;/span&gt;




    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;group_by_state&lt;/span&gt;(self):
        grouped &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;groupby(by &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;state_name&amp;#34;&lt;/span&gt;)
        
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;load_data_to_pandas_df&lt;/span&gt;(self,file_path &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; file_path &lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;:

            &lt;span style=&#34;color:#66d9ef&#34;&gt;with&lt;/span&gt; open (file_path) &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; file:
                df &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;read_json(file)
            &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; df
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;nodify_city_column&lt;/span&gt;(self):
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;city_node&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;city&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x : neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_city_node(name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x))
        
        
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(df.city_nodes)&lt;/span&gt;



    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;nodify_states_column&lt;/span&gt;(self):

        unique_states &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;drop_duplicates(subset&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;state&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;copy()
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(state_dict)&lt;/span&gt;

        unique_states[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;state_node&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; unique_states&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x: neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_state_node(name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;state_name, code &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;state), axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(unique_states)&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#self.df[&amp;#39;state_nodes&amp;#39;] = unique_states[&amp;#39;state_nodes&amp;#39;] where unique_states[state_name] = self.df_stateName&lt;/span&gt;
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;state_node&amp;#34;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;state_name&amp;#39;&lt;/span&gt;]
        &lt;span style=&#34;color:#75715e&#34;&gt;#self.df[&amp;#39;state_node&amp;#39;] =&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(self.df[&amp;#39;state_name&amp;#39;].map(unique_states))&lt;/span&gt;
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;state_node&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;state_node&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;replace(dict(zip(unique_states&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;state_name,  unique_states&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;state_node)))
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(self.df)&lt;/span&gt;

        
     
        &lt;span style=&#34;color:#75715e&#34;&gt;#mask = dfd[&amp;#39;a&amp;#39;].str.startswith(&amp;#39;o&amp;#39;)&lt;/span&gt;
        
        
        &lt;span style=&#34;color:#75715e&#34;&gt;#self.df[&amp;#39;state_nodes&amp;#39;] = self.df.apply(lambda x: neo.create_state_node(name = x.state_name, code = x.state) if x not in states_dict else states_dict[x], axis=1)&lt;/span&gt;
        
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;nodify_url_column&lt;/span&gt;(self):
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;url_node&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;realtor_url&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x : neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_url_node(url &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x, searched&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;False&lt;/span&gt;))


    

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;get_cwd&lt;/span&gt;():
    cwd &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;getcwd()
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; cwd

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;get_files&lt;/span&gt;(cwd &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;getcwd(), input_directory &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;input&amp;#39;&lt;/span&gt;):
    
    path &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sep&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;join([cwd,input_directory])
    file_list&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [f &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; f &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; glob&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;glob(path &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;**/*.json&amp;#34;&lt;/span&gt;, recursive&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)]
  
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; file_list

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;instantiate_neo_model_api&lt;/span&gt;():
    uri &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;7a92f171.databases.neo4j.io&amp;#34;&lt;/span&gt;
    user &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;neo4j&amp;#34;&lt;/span&gt;
    psw &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;RF4Gr2IJTNhHlW6HOrLDqz_I2E2Upyh7o8paTwfnCxg&amp;#39;&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;instantiate_neo_model_session(uri&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;uri,user&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;user,psw&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;psw)

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;prepare_data_pipeline&lt;/span&gt;():
    pipeline_functions &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; DataPipelineFunctions()
    master_df &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pipeline_functions&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;load_data_to_pandas_df()
    master_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_name&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pipeline_functions&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;add_country_name()
    master_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_code&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pipeline_functions&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;add_country_code()
    master_df &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pipeline_functions&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;rename_columns(master_df)
    master_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;city_node&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pipeline_functions&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_city_nodes(master_df)
    master_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;url_node&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pipeline_functions&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_url_nodes(master_df)
    master_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;root_node&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pipeline_functions&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_root_nodes(master_df)

    
    master_df_path &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pipeline_functions&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;write_df_to_csv(master_df,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;master_df.csv&amp;#39;&lt;/span&gt;)

    

    
    state_df &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pipeline_functions&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;return_unique_state_df(master_df)
    state_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;state_node&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pipeline_functions&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_state_nodes(state_df)
    state_df_path &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pipeline_functions&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;write_df_to_csv(state_df,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;state_df.csv&amp;#39;&lt;/span&gt;)
    

    country_df &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pipeline_functions&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;return_unique_country_df(master_df)
    country_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_node&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pipeline_functions&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_country_nodes(country_df)
    country_df_path &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pipeline_functions&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;write_df_to_csv(country_df,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country.csv&amp;#39;&lt;/span&gt;)


    



    &lt;span style=&#34;color:#75715e&#34;&gt;#upload nodes&lt;/span&gt;
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;master_df&amp;#34;&lt;/span&gt; : master_df, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;state_df&amp;#39;&lt;/span&gt; : state_df, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;country_df&amp;#39;&lt;/span&gt;: country_df}



&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;load_json_data&lt;/span&gt;(file):
    f &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; open (file, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;r&amp;#34;&lt;/span&gt;)
  
    &lt;span style=&#34;color:#75715e&#34;&gt;# Reading from file&lt;/span&gt;
    data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; json&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;loads(f&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;read())
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; data


&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;json_pipeline&lt;/span&gt;(file_list, master_subject_table):
    case_counter &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; file &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; file_list:
        
        data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; load_json_data(file&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;file)
        data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;results&amp;#39;&lt;/span&gt;]
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(data)&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(data[0])&lt;/span&gt;
        
        &lt;span style=&#34;color:#75715e&#34;&gt;#filtered_data = filter_json_data(json_data = data, filter = filter)&lt;/span&gt;

        &lt;span style=&#34;color:#75715e&#34;&gt;# Creating the case nodes transaction nodes and df&lt;/span&gt;
        data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; clean_json_data(data)
        case_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; stringify_json_values(data)
        case_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pandify_case_data(case_data)
        case_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nodify_case_data(case_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; case_data)
        
        &lt;span style=&#34;color:#75715e&#34;&gt;# Creating the subject nodes transaction nodes and df&lt;/span&gt;
        subject_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; slice_subject_data(data)
        subject_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; identify_unique_subjects(subject_list)
        subject_lookup_table &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; create_subject_lookup_table(subject_list)
        master_subject_table &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; integrate_to_master_table(subject_lookup_table,master_subject_table)
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(master_subject_table.duplicated())&lt;/span&gt;
        case_counter &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; case_counter &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; len(case_data)

        master_subject_table &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nodify_subjects(master_subject_table)

        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(case_data)&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(master_subject_table[&amp;#39;transaction&amp;#39;])&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#lets save data to the database&lt;/span&gt;

        master_subject_table &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; submit_subjects_to_db(master_subject_table)
        case_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; submit_cases_to_db(case_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; case_data)

        &lt;span style=&#34;color:#75715e&#34;&gt;# Create Relationships&lt;/span&gt;

        relationship_list&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; create_relationship_table(case_data&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;case_data, master_subject_table&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;master_subject_table)
    




&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;submit_cases_to_db&lt;/span&gt;(case_data):
        &lt;span style=&#34;color:#75715e&#34;&gt;#unsubmitted = master_subject_table[master_subject_table.notna()]&lt;/span&gt;

        &lt;span style=&#34;color:#75715e&#34;&gt;### in theory none of the cases wouldhave been submitted becasue i am pulling them from file.  There is no need to check.. Just submit&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#non_submitted_nodes = case_data[case_data[&amp;#39;submitted&amp;#39;].isna()].copy()&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(non_submitted_nodes)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;##pprint(non_submitted_nodes)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#if non_submitted_nodes.empty:&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#    return case_data&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#else:&lt;/span&gt;
    case_data[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;transaction&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; case_data[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;transaction&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x: neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;update(x))
    &lt;span style=&#34;color:#75715e&#34;&gt;#Assume all are submitted..&lt;/span&gt;
    case_data[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;submitted&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#test = non_submitted_nodes.iloc[32][&amp;#39;transaction&amp;#39;]&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#return_obj = neo.neoAPI.update(test)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#case_data.update(non_submitted_nodes)&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; case_data

    &lt;span style=&#34;color:#75715e&#34;&gt;#Relationships must need to be created following saving to the df&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#relationships = create_relationship_table(case_data, master_subject_table)&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;submit_subjects_to_db&lt;/span&gt;(master_subject_table):
    &lt;span style=&#34;color:#75715e&#34;&gt;#unsubmitted = master_subject_table[master_subject_table.notna()]&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(master_subject_table)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#non_submitted_nodes=master_subject_table[[master_subject_table[&amp;#39;submitted&amp;#39;] == np.nan]]&lt;/span&gt;
    non_submitted_nodes &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; master_subject_table[master_subject_table[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;submitted&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;isna()]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;copy()
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(non_submitted_nodes)&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; non_submitted_nodes&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;empty:   
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; master_subject_table
    &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;:
         &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(non_submitted_nodes)&lt;/span&gt;
        non_submitted_nodes[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;transaction&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; non_submitted_nodes[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;transaction&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x: neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;update(x))
        non_submitted_nodes[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;submitted&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;
    
    &lt;span style=&#34;color:#75715e&#34;&gt;#test = non_submitted_nodes.iloc[32][&amp;#39;transaction&amp;#39;]&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#return_obj = neo.neoAPI.update(test)&lt;/span&gt;
        master_subject_table&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;update(non_submitted_nodes)
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(master_subject_table)&lt;/span&gt;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; master_subject_table

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;tester&lt;/span&gt;():
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Hello Dolly&amp;#34;&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_relationship_table&lt;/span&gt;(case_data, master_subject_table):
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(case_data[])&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#test = master_subject_table[&amp;#39;subject&amp;#39;]&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;# select &lt;/span&gt;
    relationship_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; []
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; row &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(len(case_data)):
        unique_dataframe &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (master_subject_table[master_subject_table[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;subject&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;isin(case_data[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;subject_list&amp;#39;&lt;/span&gt;][row])])
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(unique_dataframe)&lt;/span&gt;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; subject_row &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(len(unique_dataframe)):
            case &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; case_data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[row][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;transaction&amp;#39;&lt;/span&gt;]
            subject &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; unique_dataframe&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iloc[subject_row][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;transaction&amp;#39;&lt;/span&gt;]
            &lt;span style=&#34;color:#75715e&#34;&gt;#create relationship&lt;/span&gt;
            &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(case)&lt;/span&gt;
            &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(subject)&lt;/span&gt;
            relationship &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_relationship(case&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;subject_relationship,subject)
            &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(relationship)&lt;/span&gt;
            relationship_list&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(relationship)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; relationship_list




        
    &lt;span style=&#34;color:#75715e&#34;&gt;#create relationship between the case and each uid in the unique_data_frame_transaction_list &lt;/span&gt;
    pprint(unique_dataframe)


    &lt;span style=&#34;color:#75715e&#34;&gt;## Creating the realation table&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;# Thoughts&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# pass subject and case table&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# case_subject list collumn&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# where that list is in the master table&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#return  the subjects &lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# make a connection to between each subject and the case in the returned tableuid in the table&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# return a transaction list &lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# with the list commit a transaction for eachn &lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;#case_data= filter_case_data(data)&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;nodify_case_data&lt;/span&gt;(case_data):
    &lt;span style=&#34;color:#75715e&#34;&gt;#non_submitted_nodes = case_data[case_data.notna()]&lt;/span&gt;
    non_submitted_nodes &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; case_data[case_data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;notna()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;any(axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)]
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(non_submitted_nodes)&lt;/span&gt;
    case_nodes &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; non_submitted_nodes&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x :neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_case_node(date &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;date&amp;#39;&lt;/span&gt;], dates&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;dates&amp;#39;&lt;/span&gt;],group &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;group&amp;#39;&lt;/span&gt;], name&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;x[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;id&amp;#39;&lt;/span&gt;], pdf&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;pdf&amp;#39;&lt;/span&gt;], shelf_id &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;shelf_id&amp;#39;&lt;/span&gt;], subject&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;subject&amp;#39;&lt;/span&gt;], title &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;title&amp;#39;&lt;/span&gt;], url &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;url&amp;#39;&lt;/span&gt;], subject_relationship&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;), axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)

    case_data[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;transaction&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; case_nodes
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; case_data




&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;filter_case_data&lt;/span&gt;(data):
    pprint(data[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;])



&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;nodify_subjects&lt;/span&gt;(master_subject_table):
    non_submitted_nodes &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; master_subject_table[master_subject_table&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;isna()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;any(axis&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;copy()
    &lt;span style=&#34;color:#75715e&#34;&gt;#df[df.isna().any(axis=1)]&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(non_submitted_nodes)&lt;/span&gt;
    non_submitted_nodes[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;transaction&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; non_submitted_nodes[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;subject&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;apply(&lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; x :neo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;neoAPI&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;create_subject_node(name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x))
    master_subject_table&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;update(non_submitted_nodes)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; master_subject_table

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;integrate_to_master_table&lt;/span&gt;(subject_lookup_table, master_subject_table):
    &lt;span style=&#34;color:#75715e&#34;&gt;#check_if subject in list is in subject of the table&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# if so drop it from the temp table&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# append what is left to the master table &lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(subject_lookup_table)&lt;/span&gt;
    test &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; master_subject_table[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;subject&amp;#39;&lt;/span&gt;]
    unique_dataframe &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (subject_lookup_table[&lt;span style=&#34;color:#f92672&#34;&gt;~&lt;/span&gt;subject_lookup_table[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;subject&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;isin(test)])
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(unique_dataframe)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#duplicate_list = (master_subject_table[~master_subject_table[&amp;#39;subject&amp;#39;].isin(subject_lookup_table[&amp;#39;subject&amp;#39;])])&lt;/span&gt;
    master_subject_table &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;concat([master_subject_table,unique_dataframe])
    &lt;span style=&#34;color:#75715e&#34;&gt;#master_subject_table.update(unique_dataframe)&lt;/span&gt;
    master_subject_table&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;reset_index(inplace&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;, drop&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(master_subject_table)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(master_subject_table.duplicated())&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; master_subject_table

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_subject_lookup_table&lt;/span&gt;(subject_list):
    lookup_table &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataFrame(subject_list, columns&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;subject&amp;#39;&lt;/span&gt;])
    lookup_table[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;transaction&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;nan
    lookup_table[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;submitted&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;nan
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; lookup_table

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;identify_unique_subjects&lt;/span&gt;(subject_list):
    
    &lt;span style=&#34;color:#75715e&#34;&gt;# insert the list to the set&lt;/span&gt;
    list_set &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; set(subject_list)
    &lt;span style=&#34;color:#75715e&#34;&gt;# convert the set to the list&lt;/span&gt;
    unique_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (list(list_set))
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; unique_list

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;slice_subject_data&lt;/span&gt;(data):
    subject_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; []
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; case &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; data:
        subject_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; subject_list &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; case[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;subject_list&amp;#39;&lt;/span&gt;]
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(subject_list)&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; subject_list

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;pandify_case_data&lt;/span&gt;(data):
    &lt;span style=&#34;color:#75715e&#34;&gt;#case_df = pd.concat(data, sort=False)&lt;/span&gt;
    df&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataFrame(data)
    df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;submitted&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;nan
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; df
        
&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;stringify_json_values&lt;/span&gt;(data):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; dict &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; data:
        subject_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; dict[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;subject&amp;#39;&lt;/span&gt;]
        &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; key &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; dict:
            &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; type(dict[key]) &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; list:
                tmp_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; []
                &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; item &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; (dict[key]):
                    item &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; item&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;replace(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;-&amp;#34;&lt;/span&gt;)
                    tmp_list&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(item)
                dict[key] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tmp_list

                dict[key] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;,&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;join(dict[key])
        dict[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;subject_list&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; subject_list

                
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; data
                

    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(data)&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;clean_json_data&lt;/span&gt;(filtered_data):
    &lt;span style=&#34;color:#75715e&#34;&gt;# Select the keys that I want from the dictionary&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# filter appropriatly into a df &lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# write df to file&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#print(type(filtered_data))&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(filtered_data)&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; data &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; filtered_data:
        &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(data)&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;#creat a dictionary of columns and values for each row.  Combine them all into a df when we are done&lt;/span&gt;
        &lt;span style=&#34;color:#75715e&#34;&gt;# each dictionary must be a row.... which makes perfect sense, but they can not be nested... &lt;/span&gt;
        item &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;item&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        resources &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;resources&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;index&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        language &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;language&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        online_format&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;online_format&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        original_format &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;original_format&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        kind &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;type&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        image_url &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;image_url&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        hassegments &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;hassegments&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        extract_timestamp &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;extract_timestamp&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        timestampe &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;timestamp&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        mimetype&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pop(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mime_type&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt;:
            pdf &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; resources[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;pdf&amp;#39;&lt;/span&gt;]
        &lt;span style=&#34;color:#66d9ef&#34;&gt;except&lt;/span&gt;: 
            pdf &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;noPdf&amp;#34;&lt;/span&gt;
        data[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;pdf&amp;#34;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pdf
        data[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;search_index&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; index
    


    &lt;span style=&#34;color:#75715e&#34;&gt;# convert to strings maybe move into another function to be called.  Actually will definitely move to a nother function &lt;/span&gt;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; filtered_data
    &lt;span style=&#34;color:#75715e&#34;&gt;#uid = UniqueIdProperty()&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;##date = date&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#dates = dates&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#group = group&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#id = id &lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#pdf = pdf &lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#shelf_id = shelf_id&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#subject = subject&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#primary_topic = primary_topic&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#title = title&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#url = url&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#description = description&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#source_collection = source_collection&lt;/span&gt;




&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;filter_json_data&lt;/span&gt;(json_data, filter):
    &lt;span style=&#34;color:#75715e&#34;&gt;# Using dict()&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;# Extracting specific keys from dictionary&lt;/span&gt;

    filter &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;contributor&amp;#39;&lt;/span&gt;,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;date&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;dates&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;digitized&amp;#39;&lt;/span&gt;]
    res &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; dict((k, json_data[k]) &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; k &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; filter &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; k &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; json_data)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; res

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;create_master_subject_table&lt;/span&gt;():
    table &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataFrame()
    table[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;subject&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;nan
    table[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;transaction&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;nan
    table[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;submitted&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;nan
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt;(table)

&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; __name__ &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;:
    neo_applified &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; instantiate_neo_model_api()
    cwd &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; get_cwd()
    file_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; get_files(cwd &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cwd)
    master_subject_table &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; create_master_subject_table()
    json_pipeline(file_list&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;file_list, master_subject_table&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;master_subject_table)
    
    &lt;span style=&#34;color:#75715e&#34;&gt;#neo_sandbox_app = instantiate_neo_sandbox_app()&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#google_creds = load_google_creds()&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#sheets_app = instantiate_sheets_app(google_creds.credentials)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#drive_app = instantiate_drive_app(google_creds.credentials)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#googleAPI = instantiate_google_API()&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#sparkAPI = instantiate_spark_API()&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#neoAPI = NeoAPI()&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#nodified_df = pandas_functions.nodify_dataframe()&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#test()&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#google_api = googleServices.GoogleAPI()&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;###neo_model_api = instantiate_neo_model_api()&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;###df_pipeline_dictionary = prepare_data_pipeline()&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#final_df_dictionary = upload_data_pipeline_to_neo(df_pipeline_dictionary)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#for k,v in final_df_dictionary.items():&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#    cwd = os.getcwd()&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#    path = str(k) +&amp;#34;Final&amp;#34;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#    path = os.sep.join([cwd,path])&lt;/span&gt;

     &lt;span style=&#34;color:#75715e&#34;&gt;#   with open(path, &amp;#34;w&amp;#34;) as file:&lt;/span&gt;
     &lt;span style=&#34;color:#75715e&#34;&gt;#       v.to_csv(path, index=False)&lt;/span&gt;

    &lt;span style=&#34;color:#75715e&#34;&gt;#prepared_dfs = prepare_pandas_df()&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#pprint(prepared_df)&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;#upload_df_to_db(df = prepared_df, neo_model_api = neo_model_api)&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
  </channel>
</rss>
